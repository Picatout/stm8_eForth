ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 1.
Hexadecimal [24-Bits]



                                      1 ;-------------------------------------------------------------
                                      2 ;  eForth for STM8S adapted from C. H. Ting source file to 
                                      3 ;  assemble using sdasstm8
                                      4 ;  implemented on NUCLEO-8S208RB board
                                      5 ;  Adapted by picatout 2019/10/27
                                      6 ;  https://github.com/picatout/stm8_nucleo/eForth
                                      7 ;--------------------------------------------------------------
                                      8 	.module EFORTH
                                      9          .optsdcc -mstm8
                                        	.include "inc/nucleo_8s208.inc"
                                        ;;
                                        ; Copyright Jacques Deschênes 2019 
                                        ; This file is part of MONA 
                                        ;
                                        ;     MONA is free software: you can redistribute it and/or modify
                                        ;     it under the terms of the GNU General Public License as published by
                                        ;     the Free Software Foundation, either version 3 of the License, or
                                        ;     (at your option) any later version.
                                        ;
                                        ;     MONA is distributed in the hope that it will be useful,
                                        ;     but WITHOUT ANY WARRANTY; without even the implied warranty of
                                        ;     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
                                        ;     GNU General Public License for more details.
                                        ;
                                        ;     You should have received a copy of the GNU General Public License
                                        ;     along with MONA.  If not, see <http://www.gnu.org/licenses/>.
                                        ;;
                                        ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                        ; NUCLEO-8S208RB board specific definitions
                                        ; Date: 2019/10/29
                                        ; author: Jacques Deschênes, copyright 2018,2019
                                        ; licence: GPLv3
                                        ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                        
                                        ; mcu on board is stm8s208rbt6
                                        
                                        ; crystal on board is 8Mhz
                                 
                                        
                                        ; LED2 is user LED
                                        ; connected to PC5 via Q2 -> 2N7002 MOSFET
                                 
                                 
                                 
                                        
                                        ; B1 on schematic is user button
                                        ; connected to PE4
                                        ; external pullup resistor R6 4k7 and debounce capacitor C5 100nF
                                 
                                 
                                 
                                        
                                        
                                        	.include "inc/stm8s208.inc"
                                        ;;
                                        ; Copyright Jacques Deschênes 2019 
                                        ; This file is part of MONA 
                                        ;
                                        ;     MONA is free software: you can redistribute it and/or modify
                                        ;     it under the terms of the GNU General Public License as published by
                                        ;     the Free Software Foundation, either version 3 of the License, or
                                        ;     (at your option) any later version.
                                        ;
                                        ;     MONA is distributed in the hope that it will be useful,
                                        ;     but WITHOUT ANY WARRANTY; without even the implied warranty of
                                        ;     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
                                        ;     GNU General Public License for more details.
                                        ;
                                        ;     You should have received a copy of the GNU General Public License
                                        ;     along with MONA.  If not, see <http://www.gnu.org/licenses/>.
                                        ;;
                                        ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                        ; 2019/10/18
                                        ; STM8S208RB µC registers map
                                        ; sdas source file
                                        ; author: Jacques Deschênes, copyright 2018,2019
                                        ; licence: GPLv3
                                        ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                        	.module stm8s208rb
                                        
                                        ;;;;;;;;;;;;
                                        ; bits
                                        ;;;;;;;;;;;;
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                         	
                                        ;;;;;;;;;;;;
                                        ; bits masks
                                        ;;;;;;;;;;;;
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; HSI oscillator frequency 16Mhz
                                 
                                        ; LSI oscillator frequency 128Khz
                                 
                                        
                                        ; controller memory regions
                                 
                                 
                                        ; STM8S208RB have 128K flash
                                 
                                        ; erase block size 
                                 
                                        
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; options bytes
                                        ; this one can be programmed only from SWIM  (ICP)
                                 
                                        ; these can be programmed at runtime (IAP)
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        ; option registers usage
                                        ; read out protection, value 0xAA enable ROP
                                 
                                        ; user boot code, {0..0x3e} 512 bytes row
                                 
                                 
                                        ; alternate function register
                                 
                                 
                                        ; miscelinous options
                                 
                                 
                                        ; clock options
                                 
                                 
                                        ; HSE clock startup delay
                                 
                                 
                                        ; flash wait state
                                 
                                 
                                        
                                        ; watchdog options bits
                                 
                                 
                                 
                                 
                                        ; NWDGOPT bits
                                 
                                 
                                 
                                 
                                        
                                        ; CLKOPT bits
                                 
                                 
                                 
                                 
                                        
                                        ; AFR option, remapable functions
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; device ID = (read only)
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        
                                 
                                 
                                        ; PORTS SFR OFFSET
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; GPIO
                                        ; gpio register offset to base
                                 
                                 
                                 
                                 
                                 
                                 
                                         
                                        ; port A
                                 
                                 
                                 
                                 
                                 
                                 
                                        ; port B
                                 
                                 
                                 
                                 
                                 
                                 
                                        ; port C
                                 
                                 
                                 
                                 
                                 
                                 
                                        ; port D
                                 
                                 
                                 
                                 
                                 
                                 
                                        ; port E
                                 
                                 
                                 
                                 
                                 
                                 
                                        ; port F
                                 
                                 
                                 
                                 
                                 
                                 
                                        ; port G
                                 
                                 
                                 
                                 
                                 
                                 
                                        ; port H not present on LQFP48/LQFP64 package
                                 
                                 
                                 
                                 
                                 
                                 
                                        ; port I ; only bit 0 on LQFP64 package, not present on LQFP48
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; input modes CR1
                                 
                                 
                                        ; output mode CR1
                                 
                                 
                                        ; input modes CR2
                                 
                                 
                                        ; output speed CR2
                                 
                                 
                                        
                                        
                                        ; Flash memory
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        ; data memory unlock keys
                                 
                                 
                                        ; flash memory unlock keys
                                 
                                 
                                        ; FLASH_CR1 bits
                                 
                                 
                                 
                                 
                                        ; FLASH_CR2 bits
                                 
                                 
                                 
                                 
                                 
                                        ; FLASH_FPR bits
                                 
                                 
                                 
                                 
                                 
                                 
                                        ; FLASH_NFPR bits
                                 
                                 
                                 
                                 
                                 
                                 
                                        ; FLASH_IAPSR bits
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; Interrupt control
                                 
                                 
                                        
                                        ; Reset Status
                                 
                                        
                                        ; Clock Registers
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; Peripherals clock gating
                                        ; CLK_PCKENR1 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        ; CLK_PCKENR2
                                 
                                 
                                 
                                        
                                        ; Clock bits
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                 
                                 
                                        ; clock source
                                 
                                 
                                 
                                        
                                 
                                 
                                 
                                 
                                        
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; Watchdog
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; Beeper
                                        ; beeper output is alternate function AFR7 on PD4
                                        ; connected to CN9-6
                                 
                                 
                                 
                                 
                                        
                                        ; SPI
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; I2C
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                 
                                 
                                 
                                        
                                 
                                 
                                 
                                 
                                 
                                        
                                 
                                        
                                 
                                 
                                        
                                 
                                 
                                 
                                 
                                        
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                 
                                 
                                 
                                 
                                 
                                        
                                 
                                 
                                 
                                 
                                 
                                        
                                 
                                 
                                 
                                        
                                        ; Precalculated values, all in KHz
                                 
                                 
                                        ;
                                        ; Fast I2C mode max rise time = 300ns
                                        ; I2C_FREQR = 16 = (MHz) => tMASTER = 1/16 = 62.5 ns
                                        ; TRISER = = (300/62.5) + 1 = floor(4.8) + 1 = 5.
                                        
                                 
                                        
                                 
                                 
                                 
                                        
                                 
                                 
                                 
                                        
                                 
                                 
                                        ;
                                        ; Standard I2C mode max rise time = 1000ns
                                        ; I2C_FREQR = 16 = (MHz) => tMASTER = 1/16 = 62.5 ns
                                        ; TRISER = = (1000/62.5) + 1 = floor(16) + 1 = 17.
                                        
                                 
                                        
                                 
                                 
                                 
                                        
                                 
                                 
                                 
                                        
                                 
                                 
                                        
                                        ; baudrate constant for brr_value table access
                                        ; to be used by uart_init 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; UART registers offset from
                                        ; base address 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; uart identifier
                                        ; to be used by uart_init
                                 
                                 
                                        
                                        ; pins used by uart 
                                 
                                 
                                 
                                 
                                        ; uart port base address 
                                 
                                 
                                        
                                        ; UART1 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; UART3
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; UART Status Register bits
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; Uart Control Register bits
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                 
                                 
                                 
                                 
                                 
                                        ; LIN mode config register
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; TIMERS
                                        ; Timer 1 - 16-bit timer with complementary PWM outputs
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; Timer Control Register bits
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; Timer Slave Mode Control bits
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; Timer External Trigger Enable bits
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; Timer Interrupt Enable bits
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; Timer Status Register bits
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                 
                                 
                                 
                                 
                                        
                                        ; Timer Event Generation Register bits
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; Capture/Compare Mode Register 1 - channel configured in output
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; Capture/Compare Mode Register 1 - channel configured in input
                                 
                                 
                                 
                                 
                                 
                                 
                                        ;  TIM1_CCMR1_CC1S1 = (1)
                                 
                                        
                                        ; Capture/Compare Mode Register 2 - channel configured in output
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; Capture/Compare Mode Register 2 - channel configured in input
                                 
                                 
                                 
                                 
                                 
                                 
                                        ;  TIM1_CCMR2_CC2S1 = (1)
                                 
                                        
                                        ; Capture/Compare Mode Register 3 - channel configured in output
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; Capture/Compare Mode Register 3 - channel configured in input
                                 
                                 
                                 
                                 
                                 
                                 
                                        ;  TIM1_CCMR3_CC3S1 = (1)
                                 
                                        
                                        ; Capture/Compare Mode Register 4 - channel configured in output
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; Capture/Compare Mode Register 4 - channel configured in input
                                 
                                 
                                 
                                 
                                 
                                 
                                        ;  TIM1_CCMR4_CC4S1 = (1)
                                 
                                        
                                        ; Timer 2 - 16-bit timer
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; TIM2_CR1 bitfields
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; TIMER2_CCMR bitfields 
                                 
                                 
                                 
                                        
                                        ; TIMER2_CCER1 bitfields
                                 
                                 
                                 
                                 
                                        
                                        ; TIMER2_EGR bitfields
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; Timer 3
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; TIM3_CR1  fields
                                 
                                 
                                 
                                 
                                 
                                        ; TIM3_CCR2  fields
                                 
                                 
                                 
                                        ; TIM3_CCER1 fields
                                 
                                 
                                 
                                 
                                        ; TIM3_CCER2 fields
                                 
                                 
                                        
                                        ; Timer 4
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; Timer 4 bitmasks
                                        
                                 
                                 
                                 
                                 
                                 
                                        
                                 
                                        
                                 
                                        
                                 
                                        
                                 
                                 
                                 
                                        
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; ADC2
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                         
                                        ; ADC bitmasks
                                        
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                 
                                 
                                 
                                 
                                 
                                        
                                 
                                 
                                 
                                 
                                 
                                        
                                 
                                 
                                        
                                        ; beCAN
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        
                                        ; CPU
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; global configuration register
                                 
                                 
                                 
                                        
                                        ; interrupt control registers
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        ; interrupt priority
                                 
                                 
                                 
                                 
                                 
                                         
                                        ; SWIM, control and status register
                                 
                                        ; debug registers
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; Interrupt Numbers
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; Interrupt Vectors
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                        
                                        ; Condition code register bits
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                     13 	.list
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 2.
Hexadecimal [24-Bits]



                                     15 
                                     16 ;===============================================================
                                     17 ;  Adaption to NUCLEO-8S208RB by Picatout
                                     18 ;  Date: 2020-06-07 
                                     19 ;       Suite aux nombreux changement remplacé le numéro de version pour 3.0
                                     20 ;  Date: 2019-10-26
                                     21 ;  Changes to memory map:
                                     22 ;       0x16f0  Data Stack, growing downward
                                     23 ;       0x1700  Terminal input buffer TIB
                                     24 ;       0x17ff  Return Stack, growing downard
                                     25 ;================================================================
                                     26 ;       STM8EF, Version 2.1, 13 July
                                     27 ;               Implemented on STM8S-Discovery Board.
                                     28 ;               Assembled by ST VisualDevelop STVD 
                                     29 ;               Bootup on internal 2 MHz clock
                                     30 ;               Switch to external 16 MHz crystal clock
                                     31 ;
                                     32 ; FORTH Virtual Machine:
                                     33 ; Subroutine threaded model
                                     34 ; SP Return stack pointer
                                     35 ; X Data stack pointer
                                     36 ; A,Y Scratch pad registers
                                     37 ;
                                     38 ; Memory Map:
                                     39 ; 0x0 RAM memory, system variables
                                     40 ; 0x80 Start of user defined words, linked to ROM dictionary
                                     41 ; 0x780 Data stack, growing downward
                                     42 ; 0x790 Terminal input buffer TIB
                                     43 ; 0x7FF Return stack, growing downward
                                     44 ; 0x8000 Interrupt vector table
                                     45 ; 0x8080 FORTH startup code
                                     46 ; 0x80E7 Start of FORTH dictionary in ROM
                                     47 ; 0x9584 End of FORTH dictionary
                                     48 ;
                                     49 ;       2020-04-26 Addapted for NUCLEO-8S208RB by Picatout 
                                     50 ;                  use UART1 instead of UART3 for communication with user.
                                     51 ;                  UART1 is available as ttyACM* device via USB connection.
                                     52 ;                  Use TIMER4 for millisecond interrupt to support MS counter 
                                     53 ;                  and MSEC word that return MS value.
                                     54 ;
                                     55 ;       EF12, Version 2.1, 18apr00cht
                                     56 ;               move to 8000H replacing WHYP.
                                     57 ;               copy interrupt vectors from WHYPFLSH.S19
                                     58 ;               to EF12.S19 before flashing
                                     59 ;               add TICKS1 and DELAY1 for motor stepping
                                     60 ;
                                     61 ;       EF12, 02/18/00, C. H. Ting
                                     62 ;       Adapt 86eForth v2.02 to 68HC12.
                                     63 ;               Use WHYP to seed EF12.ASM
                                     64 ;               Use AS12 native 68HC12 assembler:
                                     65 ;               as12 ef12.asm >ef12.lst
                                     66 ;       EF12A, add ADC code, 02mar00cht
                                     67 ;       EF12B, 01mar00cht
                                     68 ;               stack to 0x78, return stack to 0xf8.
                                     69 ;               add all port definitions
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 3.
Hexadecimal [24-Bits]



                                     70 ;               add PWM registers
                                     71 ;               add SPI registers and code
                                     72 ;       EF12C, 12mar00cht
                                     73 ;               add MAX5250 D/A converter
                                     74 ;       EF12D, 15mar00cht
                                     75 ;               add all the Lexel interface words
                                     76 ;       EF12E, 18apr00cht, save for reference
                                     77 ;
                                     78 ;       Copyright (c) 2000
                                     79 ;       Dr. C. H. Ting
                                     80 ;       156 14th Avenue
                                     81 ;       San Mateo, CA 94402
                                     82 ;       (650) 571-7639
                                     83 ;
                                     84 
                                     85 
                                     86 ;*********************************************************
                                     87 ;	Assembler constants
                                     88 ;*********************************************************
                           000000    89 RAMBASE =	0x0000	   ;ram base
                           0017FF    90 STACK   =	0x17FF 	;system (return) stack empty 
                           001680    91 DATSTK  =	0x1680	;data stack  empty
                           001680    92 TBUFFBASE =     0x1680  ; flash read/write transaction buffer address  
                           001700    93 TIBBASE =       0X1700  ; transaction input buffer addr.
                                     94 
                                     95 
                                     96 
                                     97 ;; Memory allocation
                                     98 
                           000006    99 UPP     =     RAMBASE+6          ; systeme variables base address 
                           001680   100 SPP     =     RAMBASE+DATSTK     ; data stack bottom 
                           0017FF   101 RPP     =     RAMBASE+STACK      ;  return stack bottom
                           001680   102 ROWBUFF =     RAMBASE+TBUFFBASE ; flash write buffer 
                           001700   103 TIBB    =     RAMBASE+TIBBASE  ; transaction input buffer
                           000080   104 VAR_BASE =    RAMBASE+0x80  ; user variables start here .
                           0017BF   105 VAR_TOP =     STACK-32*CELLL  ; reserve 32 cells for data stack. 
                                    106 
                                    107 ; user variables constants 
                           000006   108 UBASE = UPP       ; numeric base 
                           000008   109 UTMP = UBASE+2    ; temporary storage
                           00000A   110 UINN = UTMP+2     ; >IN tib pointer 
                           00000C   111 UCTIB = UINN+2    ; tib count 
                           00000E   112 UTIB = UCTIB+2    ; tib address 
                           000010   113 UINTER = UTIB+2   ; interpreter vector 
                           000012   114 UHLD = UINTER+2   ; hold 
                           000014   115 UCNTXT = UHLD+2   ; context, dictionary first link 
                           000016   116 UVP = UCNTXT+2    ; variable pointer 
                           000018   117 UCP = UVP+2      ; code pointer
                           00001A   118 ULAST = UCP+2    ; last dictionary pointer 
                           00001C   119 UOFFSET = ULAST+2 ; distance between CP and VP to adjust jump address at compile time.
                           00001E   120 UTFLASH = UOFFSET+2 ; select where between FLASH and RAM for compilation destination. 
                           000020   121 URLAST = UTFLASH+2 ; context for dictionary in RAM memory 
                                    122 
                                    123 ;******  System Variables  ******
                           000022   124 XTEMP	=	URLAST +2;address called by CREATE
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 4.
Hexadecimal [24-Bits]



                           000024   125 YTEMP	=	XTEMP+2	;address called by CREATE
                           000022   126 PROD1 = XTEMP	;space for UM*
                           000024   127 PROD2 = PROD1+2
                           000026   128 PROD3 = PROD2+2
                           000028   129 CARRY = PROD3+2
                           00002A   130 SP0	= CARRY+2	;initial data stack pointer
                           00002C   131 RP0	= SP0+2		;initial return stack pointer
                           00002E   132 MS    =   RP0+2         ; millisecond counter 
                           000030   133 CNTDWN =  MS+2          ; count down timer 
                           000032   134 FPTR = CNTDWN+2         ; 24 bits farptr 
                           000033   135 PTR16 = FPTR+1          ; middle byte of farptr 
                           000034   136 PTR8 = FPTR+2           ; least byte of farptr 
                           000036   137 SEEDX = PTR8+2          ; PRNG seed X 
                           000038   138 SEEDY = SEEDX+2         ; PRNG seed Y 
                                    139 
                                    140 ; EEPROM persistant data  
                           004000   141 APP_LAST = EEPROM_BASE ; Application last word pointer  
                           004002   142 APP_RUN = APP_LAST+2   ; application autorun address 
                           004004   143 APP_CP = APP_RUN+2   ; free application space pointer 
                           004006   144 APP_VP = APP_CP+2  ; free data space pointer 
                                    145 
                                    146 
                                    147 ;***********************************************
                                    148 ;; Version control
                                    149 
                           000003   150 VER     =     3         ;major release version
                           000000   151 EXT     =     0         ;minor extension
                                    152 
                                    153 ;; Constants
                                    154 
                           00FFFF   155 TRUEE   =     0xFFFF      ;true flag
                                    156 
                           000040   157 COMPO   =     0x40     ;lexicon compile only bit
                           000080   158 IMEDD   =     0x80     ;lexicon immediate bit
                           001F7F   159 MASKK   =     0x1F7F  ;lexicon bit mask
                                    160 
                           000002   161 CELLL   =     2       ;size of a cell
                           00000A   162 BASEE   =     10      ;default radix
                           000008   163 BKSPP   =     8       ;back space
                           00000A   164 LF      =     10      ;line feed
                           00000D   165 CRR     =     13      ;carriage return
                           00001B   166 ERR     =     27      ;error escape
                           000027   167 TIC     =     39      ;tick
                           0000CD   168 CALLL   =     0xCD     ;CALL opcodes
                           000080   169 IRET_CODE =   0x80    ; IRET opcode 
                                    170 
                                    171         .macro _ledon
                                    172         bset PC_ODR,#LED2_BIT
                                    173         .endm
                                    174 
                                    175         .macro _ledoff
                                    176         bres PC_ODR,#LED2_BIT
                                    177         .endm
                                    178 
                                    179 ;**********************************************************
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 5.
Hexadecimal [24-Bits]



                                    180         .area DATA (ABS)
      000000                        181         .org RAMBASE 
                                    182 ;**********************************************************
                                    183 
                                    184 ;**********************************************************
                                    185         .area SSEG (ABS) ; STACK
      001700                        186         .org 0x1700
      001700                        187         .ds 256 
                                    188 ; space for DATSTK,TIB and STACK         
                                    189 ;**********************************************************
                                    190 
                                    191 ;**********************************************************
                                    192         .area HOME ; vectors table
                                    193 ;**********************************************************
      000000 82 00 00 16            194 	int main	        ; reset
      000004 82 00 00 00            195 	int NonHandledInterrupt	; trap
      000008 82 00 00 00            196 	int NonHandledInterrupt	; irq0
      00000C 82 00 00 00            197 	int NonHandledInterrupt	; irq1
      000010 82 00 00 00            198 	int NonHandledInterrupt	; irq2
      000014 82 00 00 00            199 	int NonHandledInterrupt	; irq3
      000018 82 00 00 00            200 	int NonHandledInterrupt	; irq4
      00001C 82 00 00 00            201 	int NonHandledInterrupt	; irq5
      000020 82 00 00 00            202 	int NonHandledInterrupt	; irq6
      000024 82 00 00 00            203 	int NonHandledInterrupt	; irq7
      000028 82 00 00 00            204 	int NonHandledInterrupt	; irq8
      00002C 82 00 00 00            205 	int NonHandledInterrupt	; irq9
      000030 82 00 00 00            206 	int NonHandledInterrupt	; irq10
      000034 82 00 00 00            207 	int NonHandledInterrupt	; irq11
      000038 82 00 00 00            208 	int NonHandledInterrupt	; irq12
      00003C 82 00 00 00            209 	int NonHandledInterrupt	; irq13
      000040 82 00 00 00            210 	int NonHandledInterrupt	; irq14
      000044 82 00 00 00            211 	int NonHandledInterrupt	; irq15
      000048 82 00 00 00            212 	int NonHandledInterrupt	; irq16
      00004C 82 00 00 00            213 	int NonHandledInterrupt	; irq17
      000050 82 00 00 00            214 	int NonHandledInterrupt	; irq18
      000054 82 00 00 00            215 	int NonHandledInterrupt	; irq19
      000058 82 00 00 00            216 	int NonHandledInterrupt	; irq20
      00005C 82 00 00 00            217 	int NonHandledInterrupt	; irq21
      000060 82 00 00 00            218 	int NonHandledInterrupt	; irq22
      000064 82 00 00 05            219 	int Timer4Handler	; irq23
      000068 82 00 00 00            220 	int NonHandledInterrupt	; irq24
      00006C 82 00 00 00            221 	int NonHandledInterrupt	; irq25
      000070 82 00 00 00            222 	int NonHandledInterrupt	; irq26
      000074 82 00 00 00            223 	int NonHandledInterrupt	; irq27
      000078 82 00 00 00            224 	int NonHandledInterrupt	; irq28
      00007C 82 00 00 00            225 	int NonHandledInterrupt	; irq29
                                    226 
                                    227 ;**********************************************************
                                    228         .area CODE
                                    229 ;**********************************************************
                                    230 
                                    231 ; non handled interrupt reset MCU
      000000                        232 NonHandledInterrupt:
      000000 A6 80            [ 1]  233         ld a, #0x80
      000002 C7 50 D1         [ 1]  234         ld WWDG_CR,a ; WWDG_CR used to reset mcu
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 6.
Hexadecimal [24-Bits]



                                    235 	;iret
                                    236 
                                    237 ; used for milliseconds counter 
                                    238 ; MS is 16 bits counter 
      000005                        239 Timer4Handler:
      000005 72 5F 53 42      [ 1]  240 	clr TIM4_SR 
      000009 BE 2E            [ 2]  241         ldw x,MS 
      00000B 5C               [ 2]  242         incw x 
      00000C BF 2E            [ 2]  243         ldw MS,x
      00000E BE 30            [ 2]  244         ldw x,CNTDWN 
      000010 27 03            [ 1]  245         jreq 1$
      000012 5A               [ 2]  246         decw x 
      000013 BF 30            [ 2]  247         ldw CNTDWN,x 
      000015                        248 1$:         
      000015 80               [11]  249         iret 
                                    250 
                                    251 
                                    252 ;; Main entry points and COLD start data
      000016                        253 main:
                                    254 ; clear all RAM
      000016 AE 00 00         [ 2]  255 	ldw X,#RAMBASE
      000019                        256 clear_ram0:
      000019 7F               [ 1]  257 	clr (X)
      00001A 5C               [ 2]  258 	incw X
      00001B A3 17 FF         [ 2]  259 	cpw X,#RAM_END
      00001E 23 F9            [ 2]  260 	jrule clear_ram0
      000020 AE 17 FF         [ 2]  261         ldw x,#RPP
      000023 94               [ 1]  262         ldw sp,x
                                    263 ; set SEEDX and SEEDY to 1 
      000024 3C 37            [ 1]  264         inc SEEDX+1 
      000026 3C 39            [ 1]  265         inc SEEDY+1          
      000028 CC 00 47         [ 2]  266 	jp ORIG
                                    267 
                                    268 ; COLD initialize these variables.
      00002B                        269 UZERO:
      00002B 00 0A                  270         .word      BASEE   ;BASE
      00002D 00 00                  271         .word      0       ;tmp
      00002F 00 00                  272         .word      0       ;>IN
      000031 00 00                  273         .word      0       ;#TIB
      000033 17 00                  274         .word      TIBB    ;TIB
      000035 12 F8                  275         .word      INTER   ;'EVAL
      000037 00 00                  276         .word      0       ;HLD
      000039 21 76                  277         .word      LASTN  ;CNTXT pointer
      00003B 00 80                  278         .word      VAR_BASE   ;variables free space pointer 
      00003D 22 00                  279         .word      app_space ; FLASH free space pointer 
      00003F 21 76                  280         .word      LASTN   ;LAST
      000041 00 00                  281         .word      0        ; OFFSET 
      000043 00 00                  282         .word      0       ; TFLASH
                                    283 ;       .word      0       ; URLAST   
      000045 00 00                  284 UEND:   .word      0
                                    285 
      000047                        286 ORIG:   
                                    287 ; initialize SP
      000047 AE 17 FF         [ 2]  288         LDW     X,#STACK  ;initialize return stack
      00004A 94               [ 1]  289         LDW     SP,X
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 7.
Hexadecimal [24-Bits]



      00004B BF 2C            [ 2]  290         LDW     RP0,X
      00004D AE 16 80         [ 2]  291         LDW     X,#DATSTK ;initialize data stack
      000050 BF 2A            [ 2]  292         LDW     SP0,X
                                    293 ; initialize PC_5 as output to control LED2
                                    294 ; added by Picatout 
      000052 72 1A 50 0D      [ 1]  295         bset PC_CR1,#LED2_BIT
      000056 72 1A 50 0E      [ 1]  296         bset PC_CR2,#LED2_BIT
      00005A 72 1A 50 0C      [ 1]  297         bset PC_DDR,#LED2_BIT
      00005E                        298         _ledoff
      00005E 72 1B 50 0A      [ 1]    1         bres PC_ODR,#LED2_BIT
                                    299 ; initialize clock to HSI
                                    300 ; no divisor 16Mhz 
                                    301 ; Added by Picatout 
      000062                        302 clock_init:
      000062 72 5F 50 C6      [ 1]  303         clr CLK_CKDIVR
      000066 72 12 50 C5      [ 1]  304 	bset CLK_SWCR,#CLK_SWCR_SWEN
      00006A A6 E1            [ 1]  305 	ld a,#CLK_SWR_HSI
      00006C C7 50 C4         [ 1]  306 	ld CLK_SWR,a
      00006F C1 50 C3         [ 1]  307 1$:	cp a,CLK_CMSR
      000072 26 FB            [ 1]  308 	jrne 1$
                                    309         
                                    310 ; initialize UART1, 115200 8N1
      000074                        311 uart1_init:
      000074 72 14 50 C7      [ 1]  312 	bset CLK_PCKENR1,#CLK_PCKENR1_UART1
                                    313 	; configure tx pin
      000078 72 1A 50 02      [ 1]  314 	bset PA_DDR,#UART1_TX_PIN ; tx pin
      00007C 72 1A 50 03      [ 1]  315 	bset PA_CR1,#UART1_TX_PIN ; push-pull output
      000080 72 1A 50 04      [ 1]  316 	bset PA_CR2,#UART1_TX_PIN ; fast output
                                    317 	; baud rate 115200 Fmaster=8Mhz  8000000/115200=69=0x45
      000084 35 0B 52 33      [ 1]  318 	mov UART1_BRR2,#0x0b ; must be loaded first
      000088 35 08 52 32      [ 1]  319 	mov UART1_BRR1,#0x8
      00008C 35 0C 52 35      [ 1]  320 	mov UART1_CR2,#((1<<UART_CR2_TEN)|(1<<UART_CR2_REN));|(1<<UART_CR2_RIEN))
                                    321 ; initialize timer4, used for millisecond interrupt  
      000090 35 07 53 45      [ 1]  322 	mov TIM4_PSCR,#7 ; prescale 128  
      000094 35 7D 53 46      [ 1]  323 	mov TIM4_ARR,#125 ; set for 1msec.
      000098 35 05 53 40      [ 1]  324 	mov TIM4_CR1,#((1<<TIM4_CR1_CEN)|(1<<TIM4_CR1_URS))
      00009C 72 10 53 41      [ 1]  325 	bset TIM4_IER,#TIM4_IER_UIE 
                                    326 ; set TIM4 interrupt priority to highest
      0000A0 A6 3F            [ 1]  327         ld a,#~(IPR_MASK<<6)
      0000A2 C4 7F 75         [ 1]  328         and a,ITC_SPR6
      0000A5 AA C0            [ 1]  329         or a,#(IPR3<<6)
      0000A7 C7 7F 75         [ 1]  330         ld ITC_SPR6,a 
      0000AA 9A               [ 1]  331         rim
      0000AB CC 19 E4         [ 2]  332         jp  COLD   ;default=MN1
                                    333 
                                    334 
                                    335 ;; place MCU in sleep mode with
                                    336 ;; halt opcode 
                                    337 ;; BYE ( -- )
      0000AE 00 00                  338         .word 0
                           0000B0   339         LINK=.
      0000B0 03                     340         .byte 3 
      0000B1 42 59 45               341         .ascii "BYE"
      0000B4                        342 BYE: 
      0000B4 8E               [10]  343         halt 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 8.
Hexadecimal [24-Bits]



      0000B5 81               [ 4]  344         ret 
                                    345 
                                    346 ; Enable interrupts 
                                    347 ; EI ( -- )
      0000B6 00 B0                  348         .word LINK 
                           0000B8   349         LINK=.
      0000B8 02                     350         .byte 2
      0000B9 45 49                  351         .ascii "EI"
      0000BB                        352 EI:
      0000BB 9A               [ 1]  353         rim 
      0000BC 81               [ 4]  354         ret 
                                    355 
                                    356 ; Disable interrupts
                                    357 ; DI ( -- )
      0000BD 00 B8                  358         .word LINK 
                           0000BF   359         LINK=.
      0000BF 02                     360         .byte 2 
      0000C0 44 49                  361         .ascii "DI"
      0000C2                        362 DI:
      0000C2 9B               [ 1]  363         sim 
      0000C3 81               [ 4]  364         ret 
                                    365 
                                    366 ; set interrupt priority level 
                                    367 ; SET-ISP ( n1 n2 -- )
                                    368 ; n1 level {1..3}
                                    369 ; n2 vector {0..29}
      0000C4 00 BF                  370         .word LINK 
                           0000C6   371         LINK=.
      0000C6 07                     372         .byte 7 
      0000C7 53 45 54 2D 49 53 50   373         .ascii "SET-ISP"
      0000CE                        374 SETISP:
      0000CE 90 93            [ 1]  375         ldw y,x 
      0000D0 90 FE            [ 2]  376         ldw y,(y)
      0000D2 A6 04            [ 1]  377         ld a,#4 ; 4 slot per register 
                                    378 ;  quotient select register, remainder select slot in register.        
      0000D4 90 62            [ 2]  379         div y,a ; register=ITC_SPR1[Y], lshift=2*A 
      0000D6 A4 03            [ 1]  380         and a,#3 
      0000D8 48               [ 1]  381         sll a ; 2*SLOT  lshift 
      0000D9 72 A9 7F 70      [ 2]  382         addw y,#ITC_SPR1 
      0000DD FF               [ 2]  383         ldw (x),y  ; ( level reg -- )
      0000DE 90 5F            [ 1]  384         clrw y 
      0000E0 90 97            [ 1]  385         ld yl,a 
      0000E2 1D 00 02         [ 2]  386         subw x,#CELLL 
      0000E5 FF               [ 2]  387         ldw (x),y  ; ( level reg lshift -- )
      0000E6 90 93            [ 1]  388         ldw y,x 
      0000E8 90 EE 02         [ 2]  389         ldw y,(2,y) 
      0000EB 90 F6            [ 1]  390         ld a,(y)   ; reg_value
      0000ED 1D 00 02         [ 2]  391         subw x,#CELLL 
      0000F0 FF               [ 2]  392         ldw (x),y ; ( level reg lshift rval -- )
      0000F1 CD 05 0D         [ 4]  393         call OVER ; ( level reg lshift rval lshift -- )
      0000F4 CD 03 B4         [ 4]  394         call DOLIT 
      0000F7 00 03                  395         .word 3
      0000F9 CD 04 F3         [ 4]  396         call SWAPP  ; ( level reg lshift rval 3 lshift )
      0000FC CD 09 F6         [ 4]  397         call LSHIFT ; creat slot mask 
      0000FF CD 06 F8         [ 4]  398         call INVER  ; ( level reg lshift rval mask )
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 9.
Hexadecimal [24-Bits]



      000102 CD 05 2F         [ 4]  399         call ANDD ; ( level reg lshift slot_masked )
      000105 CD 04 AC         [ 4]  400         call TOR  ; ( level reg lshift -- R: slot_masked )
      000108 CD 06 9E         [ 4]  401         call ROT  ; ( reg lshift level )
      00010B CD 04 F3         [ 4]  402         call SWAPP ; ( reg level lshift )
      00010E CD 09 F6         [ 4]  403         call LSHIFT  ; ( reg slot_level -- )
      000111 CD 04 8D         [ 4]  404         call RFROM ; ( reg slot_level masked_val )
      000114 CD 05 43         [ 4]  405         call ORR   ; ( reg updated_rval )
      000117 CD 04 F3         [ 4]  406         call SWAPP 
      00011A CD 04 49         [ 4]  407         call CSTOR
                                    408 
                                    409 ; sélectionne l'application 
                                    410 ; qui démarre automatique lors 
                                    411 ; d'un COLD start 
      00011D 00 C6                  412         .word LINK 
                           00011F   413         LINK=.
      00011F 07                     414         .byte 7
      000120 41 55 54 4F 52 55 4E   415         .ascii "AUTORUN"
      000127                        416 AUTORUN:
      000127 CD 10 BD         [ 4]  417         call TOKEN 
      00012A CD 04 E3         [ 4]  418         call DUPP 
      00012D CD 03 E7         [ 4]  419         call QBRAN 
      000130 02 0D                  420         .word FORGET2
      000132 CD 11 BA         [ 4]  421         call NAMEQ
      000135 CD 06 8D         [ 4]  422         call QDUP 
      000138 CD 03 E7         [ 4]  423         call QBRAN 
      00013B 02 0D                  424         .word FORGET2
      00013D CD 04 D9         [ 4]  425         call DROP 
      000140 1D 00 04         [ 2]  426         subw x,#2*CELLL 
      000143 90 5F            [ 1]  427         clrw y 
      000145 FF               [ 2]  428         ldw (x),y 
      000146 90 AE 40 02      [ 2]  429         ldw y,#APP_RUN 
      00014A EF 02            [ 2]  430         ldw (2,x),y 
      00014C CC 1D 14         [ 2]  431         jp ee_store 
                                    432 
                                    433 ;; Reset dictionary pointer before 
                                    434 ;; forgotten word. RAM space and 
                                    435 ;; interrupt vector defined after 
                                    436 ;; must be resetted also.
      00014F 01 1F                  437         .word LINK 
                           000151   438         LINK=.
      000151 06                     439         .byte 6
      000152 46 4F 52 47 45 54      440         .ascii "FORGET" 
      000158                        441 FORGET: 
      000158 CD 10 BD         [ 4]  442         call TOKEN
      00015B CD 04 E3         [ 4]  443         call DUPP 
      00015E CD 03 E7         [ 4]  444         call QBRAN 
      000161 02 0D                  445         .word FORGET2
      000163 CD 11 BA         [ 4]  446         call NAMEQ ; ( a -- ca na | a F )
      000166 CD 06 8D         [ 4]  447         call QDUP 
      000169 CD 03 E7         [ 4]  448         call QBRAN 
      00016C 02 0D                  449         .word FORGET2
                                    450 ; only forget users words 
      00016E CD 04 E3         [ 4]  451         call DUPP ; ( ca na na )
      000171 CD 03 B4         [ 4]  452         call DOLIT 
      000174 22 00                  453         .word app_space 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 10.
Hexadecimal [24-Bits]



      000176 CD 04 F3         [ 4]  454         call SWAPP 
      000179 CD 07 9E         [ 4]  455         call  ULESS 
      00017C CD 03 E7         [ 4]  456         call QBRAN 
      00017F 01 CF                  457         .word FORGET6 
                                    458 ; ( ca na -- )        
                                    459 ;reset ivec with address >= ca
      000181 CD 04 F3         [ 4]  460         call SWAPP ; ( na ca -- ) 
      000184 CD 1F 05         [ 4]  461         call CHKIVEC ; ( na -- ) 
                                    462 ; start at LAST and link back to na 
                                    463 ; if variable found reset VP at that point.
      000187                        464 FORGET1:
      000187 CD 06 4F         [ 4]  465         call LAST 
      00018A CD 04 3C         [ 4]  466         call AT 
      00018D CD 04 E3         [ 4]  467         call DUPP  ; ( -- na last last )
      000190 CD 02 23         [ 4]  468         call FREEVAR ; ( -- na last )
      000193 CD 04 E3         [ 4]  469         call DUPP 
      000196 CD 03 B4         [ 4]  470         call DOLIT 
      000199 00 02                  471         .word 2 
      00019B CD 07 57         [ 4]  472         call SUBB ; ( na last -- na last lfa ) link address 
      00019E CD 04 3C         [ 4]  473         call AT 
      0001A1 CD 04 E3         [ 4]  474         call DUPP ; ( -- na last a a )
      0001A4 CD 06 23         [ 4]  475         call CNTXT 
      0001A7 CD 04 25         [ 4]  476         call STORE
      0001AA CD 06 4F         [ 4]  477         call LAST  
      0001AD CD 04 25         [ 4]  478         call STORE ; ( --  na last )
      0001B0 CD 05 0D         [ 4]  479         call OVER 
      0001B3 CD 07 7F         [ 4]  480         call EQUAL ; ( na last na -- na T|F ) 
      0001B6 CD 03 E7         [ 4]  481         call QBRAN 
      0001B9 01 87                  482         .word FORGET1 
                                    483 ; ( na -- )
      0001BB CD 03 B4         [ 4]  484         call DOLIT 
      0001BE 00 02                  485         .word 2 
      0001C0 CD 07 57         [ 4]  486         call SUBB 
      0001C3 CD 06 3F         [ 4]  487         call CPP 
      0001C6 CD 04 25         [ 4]  488         call STORE  
      0001C9 CD 1B C1         [ 4]  489         call UPDATCP 
      0001CC CC 1B 98         [ 2]  490         jp UPDATLAST 
      0001CF                        491 FORGET6: ; tried to forget a RAM or system word 
                                    492 ; ( ca na -- )
      0001CF 1D 00 02         [ 2]  493         subw x,#CELLL 
      0001D2 90 BE 2A         [ 2]  494         ldw y,SP0 
      0001D5 FF               [ 2]  495         ldw (x),y  
      0001D6 CD 07 9E         [ 4]  496         call ULESS
      0001D9 CD 03 E7         [ 4]  497         call QBRAN 
      0001DC 01 FF                  498         .word PROTECTED 
      0001DE CD 12 C6         [ 4]  499         call ABORQ 
      0001E1 1D                     500         .byte 29
      0001E2 20 46 6F 72 20 52 41   501         .ascii " For RAM definition do REBOOT"
             4D 20 64 65 66 69 6E
             69 74 69 6F 6E 20 64
             6F 20 52 45 42 4F 4F
             54
      0001FF                        502 PROTECTED:
      0001FF CD 12 C6         [ 4]  503         call ABORQ
      000202 0A                     504         .byte 10
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 11.
Hexadecimal [24-Bits]



      000203 20 50 72 6F 74 65 63   505         .ascii " Protected"
             74 65 64
      00020D                        506 FORGET2: ; no name or not found in dictionary 
      00020D CD 12 C6         [ 4]  507         call ABORQ
      000210 05                     508         .byte 5
      000211 20 77 68 61 74         509         .ascii " what"
      000216                        510 FORGET4:
      000216 CC 04 D9         [ 2]  511         jp DROP 
                                    512 
                                    513 
                                    514 ;---------------------------------
                                    515 ; if na is variable 
                                    516 ; free variable data  
                                    517 ; FREEVAR ( na -- )
                                    518 ;---------------------------------
      000219 01 51                  519         .word LINK 
                           00021B   520         LINK=.
      00021B 07                     521         .byte 7 
      00021C 46 52 45 45 56 41 52   522         .ascii "FREEVAR"
      000223                        523 FREEVAR:
      000223 CD 04 E3         [ 4]  524         call DUPP ; ( na na -- )
      000226 CD 04 5A         [ 4]  525         CALL CAT  ; ( na c -- )
      000229 CD 09 D8         [ 4]  526         call ONEP ;
      00022C CD 06 DE         [ 4]  527         CALL PLUS ; ( na c+1 -- ca ) 
      00022F CD 09 D8         [ 4]  528         call ONEP ; ( ca+ -- ) to get routne address 
      000232 CD 04 E3         [ 4]  529         call DUPP ; ( ca+ ca+ -- )
      000235 CD 04 3C         [ 4]  530         CALL AT   ; ( ca+ fnaddr -- ) ; fnaddr is routine address 
      000238 CD 03 B4         [ 4]  531         call DOLIT 
      00023B 05 90                  532         .word DOVAR ; if routine address is DOVAR then variable 
      00023D CD 07 7F         [ 4]  533         call EQUAL  ; ( ca+ fnaddr DOVAR -- ca+ T|F ) 
      000240 CD 03 E7         [ 4]  534         call QBRAN 
      000243 02 59                  535         .word FREEVAR4 
      000245 CD 03 B4         [ 4]  536         call DOLIT 
      000248 00 02                  537         .word 2 
      00024A CD 06 DE         [ 4]  538         call PLUS  ; ( ca+ 2 -- da ) da is data address 
      00024D CD 04 3C         [ 4]  539         call AT 
      000250 CD 06 31         [ 4]  540         call VPP   
      000253 CD 04 25         [ 4]  541         call STORE 
      000256 CC 1B D8         [ 2]  542         jp UPDATVP 
      000259                        543 FREEVAR4: ; not variable
      000259 CC 04 D9         [ 2]  544         jp  DROP 
                                    545 
                                    546 ;    SEED ( n -- )
                                    547 ; Initialize PRNG seed with n 
      00025C 02 1B                  548         .word LINK 
                           00025E   549         LINK=. 
      00025E 04                     550         .byte 4 
      00025F 53 45 45 44            551         .ascii "SEED" 
      000263                        552 SEED:
      000263 90 93            [ 1]  553         ldw y,x 
      000265 1C 00 02         [ 2]  554         addw x,#CELLL
      000268 90 FE            [ 2]  555         ldw y,(y)
      00026A 90 9E            [ 1]  556         ld a,yh 
      00026C B7 36            [ 1]  557         ld SEEDX,a 
      00026E 90 9F            [ 1]  558         ld a,yl 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 12.
Hexadecimal [24-Bits]



      000270 B7 38            [ 1]  559         ld SEEDY,a 
      000272 81               [ 4]  560         ret 
                                    561 
                                    562 ;    RANDOM ( u1 -- u2 )
                                    563 ; Pseudo random number betwen 0 and u1-1
      000273 02 5E                  564         .word LINK 
                           000275   565         LINK=.
      000275 06                     566         .byte 6
      000276 52 41 4E 44 4F 4D      567         .ascii "RANDOM" 
      00027C                        568 RANDOM:
                                    569 ;local variable 
                           000001   570         SPSAVE=1
                           000002   571         VSIZE=2 
      00027C 52 02            [ 2]  572         sub sp,#VSIZE
      00027E 1F 01            [ 2]  573         ldw (SPSAVE,sp),x  
                                    574 ; XTEMP=(SEEDX<<5)^SEEDX 
      000280 90 93            [ 1]  575         ldw y,x 
      000282 90 FE            [ 2]  576         ldw y,(y)
      000284 90 BF 24         [ 2]  577         ldw YTEMP,y 
      000287 BE 36            [ 2]  578 	ldw x,SEEDX 
      000289 58               [ 2]  579 	sllw x 
      00028A 58               [ 2]  580 	sllw x 
      00028B 58               [ 2]  581 	sllw x 
      00028C 58               [ 2]  582 	sllw x 
      00028D 58               [ 2]  583 	sllw x 
      00028E 9E               [ 1]  584 	ld a,xh 
      00028F B8 36            [ 1]  585 	xor a,SEEDX 
      000291 B7 22            [ 1]  586 	ld XTEMP,a 
      000293 9F               [ 1]  587 	ld a,xl 
      000294 B8 37            [ 1]  588 	xor a,SEEDX+1 
      000296 B7 23            [ 1]  589 	ld XTEMP+1,a 
                                    590 ; SEEDX=SEEDY 
      000298 BE 38            [ 2]  591 	ldw x,SEEDY 
      00029A BF 36            [ 2]  592 	ldw SEEDX,x  
                                    593 ; SEEDY=SEEDY^(SEEDY>>1)
      00029C 54               [ 2]  594 	srlw x 
      00029D 9E               [ 1]  595 	ld a,xh 
      00029E B8 38            [ 1]  596 	xor a,SEEDY 
      0002A0 B7 38            [ 1]  597 	ld SEEDY,a  
      0002A2 9F               [ 1]  598 	ld a,xl 
      0002A3 B8 39            [ 1]  599 	xor a,SEEDY+1 
      0002A5 B7 39            [ 1]  600 	ld SEEDY+1,a 
                                    601 ; XTEMP>>3 
      0002A7 BE 22            [ 2]  602 	ldw x,XTEMP 
      0002A9 54               [ 2]  603 	srlw x 
      0002AA 54               [ 2]  604 	srlw x 
      0002AB 54               [ 2]  605 	srlw x 
                                    606 ; x=XTEMP^x 
      0002AC 9E               [ 1]  607 	ld a,xh 
      0002AD B8 22            [ 1]  608 	xor a,XTEMP 
      0002AF 95               [ 1]  609 	ld xh,a 
      0002B0 9F               [ 1]  610 	ld a,xl 
      0002B1 B8 23            [ 1]  611 	xor a,XTEMP+1  
      0002B3 97               [ 1]  612 	ld xl,a 
                                    613 ; SEEDY=x^SEEDY 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 13.
Hexadecimal [24-Bits]



      0002B4 B8 39            [ 1]  614 	xor a,SEEDY+1
      0002B6 97               [ 1]  615 	ld xl,a 
      0002B7 9E               [ 1]  616 	ld a,xh 
      0002B8 B8 38            [ 1]  617 	xor a,SEEDY
      0002BA 95               [ 1]  618 	ld xh,a 
      0002BB BF 38            [ 2]  619 	ldw SEEDY,x 
                                    620 ; return SEEDY modulo YTEMP  
      0002BD 90 BE 24         [ 2]  621 	ldw y,YTEMP  
      0002C0 65               [ 2]  622 	divw x,y 
      0002C1 1E 01            [ 2]  623 	ldw x,(SPSAVE,sp)
      0002C3 FF               [ 2]  624         ldw (x),y 
      0002C4 5B 02            [ 2]  625         addw sp,#VSIZE 
      0002C6 81               [ 4]  626 	ret 
                                    627 
                                    628 
                                    629 ;;
                                    630 ;; get millisecond counter 
                                    631 ;; msec ( -- u )
                                    632 ;; Added by Picatout 2020-04-26
      0002C7 02 75                  633         .word LINK  
                           0002C9   634         LINK = . 
      0002C9 04                     635         .byte 4
      0002CA 4D 53 45 43            636         .ascii "MSEC"
      0002CE                        637 MSEC: 
      0002CE 1D 00 02         [ 2]  638         subw x,#CELLL 
      0002D1 90 BE 2E         [ 2]  639         ldw y,MS 
      0002D4 FF               [ 2]  640         ldw (x),y 
      0002D5 81               [ 4]  641         ret 
                                    642 
                                    643 ; suspend execution for u msec 
                                    644 ;  pause ( u -- )
      0002D6 02 C9                  645         .word LINK 
                           0002D8   646         LINK=.
      0002D8 05                     647         .byte 5 
      0002D9 50 41 55 53 45         648         .ascii "PAUSE"
      0002DE                        649 PAUSE:
      0002DE 90 93            [ 1]  650         ldw y,x
      0002E0 90 FE            [ 2]  651         ldw y,(y)
      0002E2 72 B9 00 2E      [ 2]  652         addw y,MS 
      0002E6 8F               [10]  653 1$:     wfi  
      0002E7 90 B3 2E         [ 2]  654         cpw y,MS  
      0002EA 26 FA            [ 1]  655         jrne 1$        
      0002EC 1C 00 02         [ 2]  656         addw x,#CELLL 
      0002EF 81               [ 4]  657         ret 
                                    658 
                                    659 ; initialize count down timer 
                                    660 ;  TIMER ( u -- )  milliseconds 
      0002F0 02 D8                  661         .word LINK 
                           0002F2   662         LINK=.
      0002F2 05                     663         .byte 5 
      0002F3 54 49 4D 45 52         664         .ascii "TIMER" 
      0002F8                        665 TIMER:
      0002F8 90 93            [ 1]  666         ldw y,x
      0002FA 90 FE            [ 2]  667         ldw y,(y) 
      0002FC 90 BF 30         [ 2]  668         ldw CNTDWN,y
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 14.
Hexadecimal [24-Bits]



      0002FF 1C 00 02         [ 2]  669         addw x,#CELLL 
      000302 81               [ 4]  670         ret 
                                    671 
                                    672 ; check for TIMER exiparition 
                                    673 ;  TIMEOUT? ( -- 0|-1 )
      000303 02 F2                  674         .word LINK 
                           000305   675         LINK=. 
      000305 08                     676         .byte 8 
      000306 54 49 4D 45 4F 55 54   677         .ascii "TIMEOUT?"
             3F
      00030E                        678 TIMEOUTQ: 
      00030E 4F               [ 1]  679         clr a
      00030F 1D 00 02         [ 2]  680         subw x,#CELLL 
      000312 90 BE 30         [ 2]  681         ldw y,CNTDWN 
      000315 26 01            [ 1]  682         jrne 1$ 
      000317 43               [ 1]  683         cpl a 
      000318 E7 01            [ 1]  684 1$:     ld (1,x),a 
      00031A F7               [ 1]  685         ld (x),a 
      00031B 81               [ 4]  686         ret         
                                    687 
                                    688 ; reboot MCU 
                                    689 ; REBOOT ( -- )
      00031C 03 05                  690         .word LINK 
                           00031E   691         LINK=. 
      00031E 06                     692         .byte 6 
      00031F 52 45 42 4F 4F 54      693         .ascii "REBOOT"
      000325                        694 reboot:
      000325 CC 00 00         [ 2]  695         jp NonHandledInterrupt
                                    696 
                                    697 ; compile to flash memory 
                                    698 ; TO-FLASH ( -- )
      000328 03 1E                  699         .word LINK 
                           00032A   700         LINK=.
      00032A 08                     701         .byte 8
      00032B 54 4F 2D 46 4C 41 53   702         .ascii "TO-FLASH"
             48
      000333                        703 TOFLASH:
      000333 CD 06 62         [ 4]  704         call RAMLAST 
      000336 CD 04 3C         [ 4]  705         call AT 
      000339 CD 06 8D         [ 4]  706         call QDUP 
      00033C CD 03 E7         [ 4]  707         call QBRAN
      00033F 03 62                  708         .word 1$
      000341 CD 12 C6         [ 4]  709         call ABORQ 
      000344 1D                     710         .byte 29
      000345 20 4E 6F 74 20 77 68   711         .ascii " Not while definitions in RAM"   
             69 6C 65 20 64 65 66
             69 6E 69 74 69 6F 6E
             73 20 69 6E 20 52 41
             4D
      000362 90 AE FF FF      [ 2]  712 1$:     ldw y,#-1 
      000366 90 BF 1E         [ 2]  713         ldw UTFLASH,y
      000369 81               [ 4]  714         ret 
                                    715 
                                    716 ; compile to RAM 
                                    717 ; TO-RAM ( -- )
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 15.
Hexadecimal [24-Bits]



      00036A 03 2A                  718         .word LINK 
                           00036C   719         LINK=.
      00036C 06                     720         .byte 6 
      00036D 54 4F 2D 52 41 4D      721         .ascii "TO-RAM"
      000373                        722 TORAM:
      000373 90 5F            [ 1]  723         clrw y 
      000375 90 BF 1E         [ 2]  724         ldw UTFLASH,y 
      000378 81               [ 4]  725         ret 
                                    726         
                                    727 
                                    728 ;; Device dependent I/O
                                    729 ;       ?RX     ( -- c T | F )
                                    730 ;         Return input byte and true, or false.
      000379 03 6C                  731         .word      LINK 
                           00037B   732 LINK	= .
      00037B 04                     733         .byte      4
      00037C 3F 4B 45 59            734         .ascii     "?KEY"
      000380                        735 QKEY:
      000380 90 5F            [ 1]  736         CLRW Y 
      000382 72 0B 52 30 0B   [ 2]  737         BTJF UART1_SR,#UART_SR_RXNE,INCH   ;check status
      000387 C6 52 31         [ 1]  738         LD    A,UART1_DR   ;get char in A
      00038A 1D 00 02         [ 2]  739 	SUBW	X,#2
      00038D E7 01            [ 1]  740         LD     (1,X),A
      00038F 7F               [ 1]  741 	CLR	(X)
      000390 90 53            [ 2]  742         CPLW     Y
      000392                        743 INCH:
      000392 1D 00 02         [ 2]  744 	SUBW	X,#2
      000395 FF               [ 2]  745         LDW     (X),Y
      000396 81               [ 4]  746         RET
                                    747 
                                    748 ;       TX!     ( c -- )
                                    749 ;       Send character c to  output device.
      000397 03 7B                  750         .word      LINK
                           000399   751 LINK	= .
      000399 04                     752         .byte      4
      00039A 45 4D 49 54            753         .ascii     "EMIT"
      00039E                        754 EMIT:
      00039E E6 01            [ 1]  755         LD     A,(1,X)
      0003A0 1C 00 02         [ 2]  756 	ADDW	X,#2
      0003A3 72 0F 52 30 FB   [ 2]  757 OUTPUT: BTJF UART1_SR,#UART_SR_TXE,OUTPUT  ;loop until tdre
      0003A8 C7 52 31         [ 1]  758         LD    UART1_DR,A   ;send A
      0003AB 81               [ 4]  759         RET
                                    760 
                                    761 ;; The kernel
                                    762 
                                    763 ;       doLIT   ( -- w )
                                    764 ;       Push an inline literal.
      0003AC 03 99                  765         .word      LINK
                           0003AE   766 LINK	= 	.
      0003AE 45                     767 	.byte      COMPO+5
      0003AF 44 4F 4C 49 54         768         .ascii     "DOLIT"
      0003B4                        769 DOLIT:
      0003B4 1D 00 02         [ 2]  770 	SUBW X,#2
      0003B7 16 01            [ 2]  771         ldw y,(1,sp)
      0003B9 90 FE            [ 2]  772         ldw y,(y)
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 16.
Hexadecimal [24-Bits]



      0003BB FF               [ 2]  773         ldw (x),y
      0003BC 90 85            [ 2]  774         popw y 
      0003BE 90 EC 02         [ 2]  775         jp (2,y)
                                    776 
                                    777 ;       next    ( -- )
                                    778 ;       Code for  single index loop.
      0003C1 03 AE                  779         .word      LINK
                           0003C3   780 LINK	= 	.
      0003C3 44                     781 	.byte      COMPO+4
      0003C4 4E 45 58 54            782         .ascii     "NEXT"
      0003C8                        783 DONXT:
      0003C8 16 03            [ 2]  784 	LDW Y,(3,SP)
      0003CA 90 5A            [ 2]  785 	DECW Y
      0003CC 2A 07            [ 1]  786 	JRPL NEX1 ; jump if N=0
      0003CE 90 85            [ 2]  787 	POPW Y
      0003D0 5B 02            [ 2]  788         addw sp,#2
      0003D2 90 EC 02         [ 2]  789         JP (2,Y)
      0003D5                        790 NEX1:
      0003D5 17 03            [ 2]  791         LDW (3,SP),Y
      0003D7 90 85            [ 2]  792         POPW Y
      0003D9 90 FE            [ 2]  793 	LDW Y,(Y)
      0003DB 90 FC            [ 2]  794 	JP (Y)
                                    795 
                                    796 ;       ?branch ( f -- )
                                    797 ;       Branch if flag is zero.
      0003DD 03 C3                  798         .word      LINK
                           0003DF   799 LINK	= 	.
      0003DF 47                     800 	.byte      COMPO+7
      0003E0 3F 42 52 41 4E 43 48   801         .ascii     "?BRANCH"
      0003E7                        802 QBRAN:	
      0003E7 90 93            [ 1]  803         LDW Y,X
      0003E9 1C 00 02         [ 2]  804 	ADDW X,#2
      0003EC 90 FE            [ 2]  805 	LDW Y,(Y)
      0003EE 27 0E            [ 1]  806         JREQ     BRAN
      0003F0 90 85            [ 2]  807 	POPW Y
      0003F2 90 EC 02         [ 2]  808 	JP (2,Y)
                                    809         
                                    810 ;       branch  ( -- )
                                    811 ;       Branch to an inline address.
      0003F5 03 DF                  812         .word      LINK
                           0003F7   813 LINK	= 	.
      0003F7 46                     814 	.byte      COMPO+6
      0003F8 42 52 41 4E 43 48      815         .ascii     "BRANCH"
      0003FE                        816 BRAN:
      0003FE 90 85            [ 2]  817         POPW Y
      000400 90 FE            [ 2]  818 	LDW Y,(Y)
      000402 90 FC            [ 2]  819         JP     (Y)
                                    820 
                                    821 ;       EXECUTE ( ca -- )
                                    822 ;       Execute  word at ca.
      000404 03 F7                  823         .word      LINK
                           000406   824 LINK	= 	.
      000406 07                     825         .byte       7
      000407 45 58 45 43 55 54 45   826         .ascii     "EXECUTE"
      00040E                        827 EXECU:
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 17.
Hexadecimal [24-Bits]



      00040E 90 93            [ 1]  828         LDW Y,X
      000410 1C 00 02         [ 2]  829 	ADDW X,#2
      000413 90 FE            [ 2]  830 	LDW  Y,(Y)
      000415 90 FC            [ 2]  831         JP   (Y)
                                    832 
                           000001   833 OPTIMIZE = 1
                           000001   834 .if OPTIMIZE 
                                    835 ; remplacement de CALL EXIT par 
                                    836 ; le opcode de RET.
                                    837 ; Voir modification au code de ";"
                                    838 ;
                                    839 ;       EXIT    ( -- )
                                    840 ;       Terminate a colon definition.
      000417 04 06                  841         .word      LINK
                           000419   842 LINK = .
      000419 04                     843         .byte      4
      00041A 45 58 49 54            844         .ascii     "EXIT"
      00041E                        845 EXIT:
      00041E 90 85            [ 2]  846         POPW Y
      000420 81               [ 4]  847         RET
                                    848 .endif 
                                    849 
                                    850 ;       !       ( w a -- )
                                    851 ;       Pop  data stack to memory.
      000421 04 19                  852         .word      LINK
                           000423   853 LINK = .
      000423 01                     854         .byte      1
      000424 21                     855         .ascii     "!"
      000425                        856 STORE:
      000425 90 93            [ 1]  857         LDW Y,X
      000427 90 FE            [ 2]  858         LDW Y,(Y)    ;Y=a
      000429 90 BF 24         [ 2]  859         LDW YTEMP,Y
      00042C 90 93            [ 1]  860         LDW Y,X
      00042E 90 EE 02         [ 2]  861         LDW Y,(2,Y)
      000431 91 CF 24         [ 5]  862         LDW [YTEMP],Y ;store w at a
      000434 1C 00 04         [ 2]  863         ADDW X,#4 ; DDROP 
      000437 81               [ 4]  864         RET     
                                    865 
                                    866 ;       @       ( a -- w )
                                    867 ;       Push memory location to stack.
      000438 04 23                  868         .word      LINK
                           00043A   869 LINK	= 	.
      00043A 01                     870         .byte    1
      00043B 40                     871         .ascii	"@"
      00043C                        872 AT:
      00043C 90 93            [ 1]  873         LDW Y,X     ;Y = a
      00043E 90 FE            [ 2]  874         LDW Y,(Y)   ; address 
      000440 90 FE            [ 2]  875         LDW Y,(Y)   ; value 
      000442 FF               [ 2]  876         LDW (X),Y ;w = @Y
      000443 81               [ 4]  877         RET     
                                    878 
                                    879 ;       C!      ( c b -- )
                                    880 ;       Pop  data stack to byte memory.
      000444 04 3A                  881         .word      LINK
                           000446   882 LINK	= .
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 18.
Hexadecimal [24-Bits]



      000446 02                     883         .byte      2
      000447 43 21                  884         .ascii     "C!"
      000449                        885 CSTOR:
      000449 90 93            [ 1]  886         LDW Y,X
      00044B 90 FE            [ 2]  887 	LDW Y,(Y)    ;Y=b
      00044D E6 03            [ 1]  888         LD A,(3,X)    ;D = c
      00044F 90 F7            [ 1]  889         LD  (Y),A     ;store c at b
      000451 1C 00 04         [ 2]  890 	ADDW X,#4 ; DDROP 
      000454 81               [ 4]  891         RET     
                                    892 
                                    893 ;       C@      ( b -- c )
                                    894 ;       Push byte in memory to  stack.
      000455 04 46                  895         .word      LINK
                           000457   896 LINK	= 	.
      000457 02                     897         .byte      2
      000458 43 40                  898         .ascii     "C@"
      00045A                        899 CAT:
      00045A 90 93            [ 1]  900         LDW Y,X     ;Y=b
      00045C 90 FE            [ 2]  901         LDW Y,(Y)
      00045E 90 F6            [ 1]  902         LD A,(Y)
      000460 E7 01            [ 1]  903         LD (1,X),A
      000462 7F               [ 1]  904         CLR (X)
      000463 81               [ 4]  905         RET     
                                    906 
                                    907 ;       RP@     ( -- a )
                                    908 ;       Push current RP to data stack.
      000464 04 57                  909         .word      LINK
                           000466   910 LINK	= .
      000466 03                     911         .byte      3
      000467 52 50 40               912         .ascii     "RP@"
      00046A                        913 RPAT:
      00046A 90 96            [ 1]  914         LDW Y,SP    ;save return addr
      00046C 1D 00 02         [ 2]  915         SUBW X,#2
      00046F FF               [ 2]  916         LDW (X),Y
      000470 81               [ 4]  917         RET     
                                    918 
                                    919 ;       RP!     ( a -- )
                                    920 ;       Set  return stack pointer.
      000471 04 66                  921         .word      LINK
                           000473   922 LINK	= 	. 
      000473 43                     923 	.byte      COMPO+3
      000474 52 50 21               924         .ascii     "RP!"
      000477                        925 RPSTO:
      000477 90 85            [ 2]  926         POPW Y
      000479 90 BF 24         [ 2]  927         LDW YTEMP,Y
      00047C 90 93            [ 1]  928         LDW Y,X
      00047E 90 FE            [ 2]  929         LDW Y,(Y)
      000480 90 94            [ 1]  930         LDW SP,Y
      000482 1C 00 02         [ 2]  931         ADDW x,#CELLL ; a was not dropped, Picatout 2020-05-24
      000485 92 CC 24         [ 5]  932         JP [YTEMP]
                                    933 
                                    934 ;       R>      ( -- w )
                                    935 ;       Pop return stack to data stack.
      000488 04 73                  936         .word      LINK
                           00048A   937 LINK	= 	. 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 19.
Hexadecimal [24-Bits]



      00048A 42                     938 	.byte      COMPO+2
      00048B 52 3E                  939         .ascii     "R>"
      00048D                        940 RFROM:
      00048D 90 85            [ 2]  941         POPW Y    ;save return addr
      00048F 90 BF 24         [ 2]  942         LDW YTEMP,Y
      000492 90 85            [ 2]  943         POPW Y
      000494 1D 00 02         [ 2]  944         SUBW X,#2
      000497 FF               [ 2]  945         LDW (X),Y
      000498 92 CC 24         [ 5]  946         JP [YTEMP]
                                    947 
                                    948 ;       R@      ( -- w )
                                    949 ;       Copy top of return stack to stack.
      00049B 04 8A                  950         .word      LINK
                           00049D   951 LINK	= 	. 
      00049D 02                     952         .byte      2
      00049E 52 40                  953         .ascii     "R@"
      0004A0                        954 RAT:
      0004A0 16 03            [ 2]  955         ldw y,(3,sp)
      0004A2 1D 00 02         [ 2]  956         subw x,#CELLL 
      0004A5 FF               [ 2]  957         ldw (x),y 
      0004A6 81               [ 4]  958         ret 
                                    959 
                                    960 ;       >R      ( w -- )
                                    961 ;       Push data stack to return stack.
      0004A7 04 9D                  962         .word      LINK
                           0004A9   963 LINK	= 	. 
      0004A9 42                     964 	.byte      COMPO+2
      0004AA 3E 52                  965         .ascii     ">R"
      0004AC                        966 TOR:
      0004AC 90 85            [ 2]  967         POPW Y    ;save return addr
      0004AE 90 BF 24         [ 2]  968         LDW YTEMP,Y
      0004B1 90 93            [ 1]  969         LDW Y,X
      0004B3 90 FE            [ 2]  970         LDW Y,(Y)
      0004B5 90 89            [ 2]  971         PUSHW Y    ;restore return addr
      0004B7 1C 00 02         [ 2]  972         ADDW X,#2
      0004BA 92 CC 24         [ 5]  973         JP [YTEMP]
                                    974 
                                    975 ;       SP@     ( -- a )
                                    976 ;       Push current stack pointer.
      0004BD 04 A9                  977         .word      LINK
                           0004BF   978 LINK	= 	. 
      0004BF 03                     979         .byte      3
      0004C0 53 50 40               980         .ascii     "SP@"
      0004C3                        981 SPAT:
      0004C3 90 93            [ 1]  982 	LDW Y,X
      0004C5 1D 00 02         [ 2]  983         SUBW X,#2
      0004C8 FF               [ 2]  984 	LDW (X),Y
      0004C9 81               [ 4]  985         RET     
                                    986 
                                    987 ;       SP!     ( a -- )
                                    988 ;       Set  data stack pointer.
      0004CA 04 BF                  989         .word      LINK
                           0004CC   990 LINK	= 	. 
      0004CC 03                     991         .byte      3
      0004CD 53 50 21               992         .ascii     "SP!"
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 20.
Hexadecimal [24-Bits]



      0004D0                        993 SPSTO:
      0004D0 FE               [ 2]  994         LDW     X,(X)     ;X = a
      0004D1 81               [ 4]  995         RET     
                                    996 
                                    997 ;       DROP    ( w -- )
                                    998 ;       Discard top stack item.
      0004D2 04 CC                  999         .word      LINK
                           0004D4  1000 LINK	= 	. 
      0004D4 04                    1001         .byte      4
      0004D5 44 52 4F 50           1002         .ascii     "DROP"
      0004D9                       1003 DROP:
      0004D9 1C 00 02         [ 2] 1004         ADDW X,#2     
      0004DC 81               [ 4] 1005         RET     
                                   1006 
                                   1007 ;       DUP     ( w -- w w )
                                   1008 ;       Duplicate  top stack item.
      0004DD 04 D4                 1009         .word      LINK
                           0004DF  1010 LINK	= 	. 
      0004DF 03                    1011         .byte      3
      0004E0 44 55 50              1012         .ascii     "DUP"
      0004E3                       1013 DUPP:
      0004E3 90 93            [ 1] 1014 	LDW Y,X
      0004E5 1D 00 02         [ 2] 1015         SUBW X,#2
      0004E8 90 FE            [ 2] 1016 	LDW Y,(Y)
      0004EA FF               [ 2] 1017 	LDW (X),Y
      0004EB 81               [ 4] 1018         RET     
                                   1019 
                                   1020 ;       SWAP    ( w1 w2 -- w2 w1 )
                                   1021 ;       Exchange top two stack items.
      0004EC 04 DF                 1022         .word      LINK
                           0004EE  1023 LINK	= 	. 
      0004EE 04                    1024         .byte      4
      0004EF 53 57 41 50           1025         .ascii     "SWAP"
      0004F3                       1026 SWAPP:
      0004F3 90 93            [ 1] 1027         LDW Y,X
      0004F5 90 FE            [ 2] 1028         LDW Y,(Y)
      0004F7 90 BF 24         [ 2] 1029         LDW YTEMP,Y
      0004FA 90 93            [ 1] 1030         LDW Y,X
      0004FC 90 EE 02         [ 2] 1031         LDW Y,(2,Y)
      0004FF FF               [ 2] 1032         LDW (X),Y
      000500 90 BE 24         [ 2] 1033         LDW Y,YTEMP
      000503 EF 02            [ 2] 1034         LDW (2,X),Y
      000505 81               [ 4] 1035         RET     
                                   1036 
                                   1037 ;       OVER    ( w1 w2 -- w1 w2 w1 )
                                   1038 ;       Copy second stack item to top.
      000506 04 EE                 1039         .word      LINK
                           000508  1040 LINK	= . 
      000508 04                    1041         .byte      4
      000509 4F 56 45 52           1042         .ascii     "OVER"
      00050D                       1043 OVER:
      00050D 1D 00 02         [ 2] 1044         SUBW X,#2
      000510 90 93            [ 1] 1045         LDW Y,X
      000512 90 EE 04         [ 2] 1046         LDW Y,(4,Y)
      000515 FF               [ 2] 1047         LDW (X),Y
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 21.
Hexadecimal [24-Bits]



      000516 81               [ 4] 1048         RET     
                                   1049 
                                   1050 ;       0<      ( n -- t )
                                   1051 ;       Return true if n is negative.
      000517 05 08                 1052         .word      LINK
                           000519  1053 LINK	= . 
      000519 02                    1054         .byte      2
      00051A 30 3C                 1055         .ascii     "0<"
      00051C                       1056 ZLESS:
      00051C A6 FF            [ 1] 1057         LD A,#0xFF
      00051E 90 93            [ 1] 1058         LDW Y,X
      000520 90 FE            [ 2] 1059         LDW Y,(Y)
      000522 2B 01            [ 1] 1060         JRMI     ZL1
      000524 4F               [ 1] 1061         CLR A   ;false
      000525 F7               [ 1] 1062 ZL1:    LD     (X),A
      000526 E7 01            [ 1] 1063         LD (1,X),A
      000528 81               [ 4] 1064 	RET     
                                   1065 
                                   1066 ;       AND     ( w w -- w )
                                   1067 ;       Bitwise AND.
      000529 05 19                 1068         .word      LINK
                           00052B  1069 LINK	= . 
      00052B 03                    1070         .byte      3
      00052C 41 4E 44              1071         .ascii     "AND"
      00052F                       1072 ANDD:
      00052F F6               [ 1] 1073         LD  A,(X)    ;D=w
      000530 E4 02            [ 1] 1074         AND A,(2,X)
      000532 E7 02            [ 1] 1075         LD (2,X),A
      000534 E6 01            [ 1] 1076         LD A,(1,X)
      000536 E4 03            [ 1] 1077         AND A,(3,X)
      000538 E7 03            [ 1] 1078         LD (3,X),A
      00053A 1C 00 02         [ 2] 1079         ADDW X,#2
      00053D 81               [ 4] 1080         RET
                                   1081 
                                   1082 ;       OR      ( w w -- w )
                                   1083 ;       Bitwise inclusive OR.
      00053E 05 2B                 1084         .word      LINK
                           000540  1085 LINK = . 
      000540 02                    1086         .byte      2
      000541 4F 52                 1087         .ascii     "OR"
      000543                       1088 ORR:
      000543 F6               [ 1] 1089         LD A,(X)    ;D=w
      000544 EA 02            [ 1] 1090         OR A,(2,X)
      000546 E7 02            [ 1] 1091         LD (2,X),A
      000548 E6 01            [ 1] 1092         LD A,(1,X)
      00054A EA 03            [ 1] 1093         OR A,(3,X)
      00054C E7 03            [ 1] 1094         LD (3,X),A
      00054E 1C 00 02         [ 2] 1095         ADDW X,#2
      000551 81               [ 4] 1096         RET
                                   1097 
                                   1098 ;       XOR     ( w w -- w )
                                   1099 ;       Bitwise exclusive OR.
      000552 05 40                 1100         .word      LINK
                           000554  1101 LINK	= . 
      000554 03                    1102         .byte      3
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 22.
Hexadecimal [24-Bits]



      000555 58 4F 52              1103         .ascii     "XOR"
      000558                       1104 XORR:
      000558 F6               [ 1] 1105         LD A,(X)    ;D=w
      000559 E8 02            [ 1] 1106         XOR A,(2,X)
      00055B E7 02            [ 1] 1107         LD (2,X),A
      00055D E6 01            [ 1] 1108         LD A,(1,X)
      00055F E8 03            [ 1] 1109         XOR A,(3,X)
      000561 E7 03            [ 1] 1110         LD (3,X),A
      000563 1C 00 02         [ 2] 1111         ADDW X,#2
      000566 81               [ 4] 1112         RET
                                   1113 
                                   1114 ;       UM+     ( u u -- udsum )
                                   1115 ;       Add two unsigned single
                                   1116 ;       and return a double sum.
      000567 05 54                 1117         .word      LINK
                           000569  1118 LINK	= . 
      000569 03                    1119         .byte      3
      00056A 55 4D 2B              1120         .ascii     "UM+"
      00056D                       1121 UPLUS:
      00056D A6 01            [ 1] 1122         LD A,#1
      00056F 90 93            [ 1] 1123         LDW Y,X
      000571 90 EE 02         [ 2] 1124         LDW Y,(2,Y)
      000574 90 BF 24         [ 2] 1125         LDW YTEMP,Y
      000577 90 93            [ 1] 1126         LDW Y,X
      000579 90 FE            [ 2] 1127         LDW Y,(Y)
      00057B 72 B9 00 24      [ 2] 1128         ADDW Y,YTEMP
      00057F EF 02            [ 2] 1129         LDW (2,X),Y
      000581 25 01            [ 1] 1130         JRC     UPL1
      000583 4F               [ 1] 1131         CLR A
      000584 E7 01            [ 1] 1132 UPL1:   LD     (1,X),A
      000586 7F               [ 1] 1133         CLR (X)
      000587 81               [ 4] 1134         RET
                                   1135 
                                   1136 ;; System and user variables
                                   1137 
                                   1138 ;       doVAR   ( -- a )
                                   1139 ;       Code for VARIABLE and CREATE.
      000588 05 69                 1140         .word      LINK
                           00058A  1141 LINK	= . 
      00058A 45                    1142 	.byte      COMPO+5
      00058B 44 4F 56 41 52        1143         .ascii     "DOVAR"
      000590                       1144 DOVAR:
      000590 1D 00 02         [ 2] 1145 	SUBW X,#2
      000593 90 85            [ 2] 1146         POPW Y    ;get return addr (pfa)
      000595 90 FE            [ 2] 1147         LDW Y,(Y) ; indirect address 
      000597 FF               [ 2] 1148         LDW (X),Y    ;push on stack
      000598 81               [ 4] 1149         RET     ;go to RET of EXEC
                                   1150 
                                   1151 ;       BASE    ( -- a )
                                   1152 ;       Radix base for numeric I/O.
      000599 05 8A                 1153         .word      LINK        
                           00059B  1154 LINK = . 
      00059B 04                    1155         .byte      4
      00059C 42 41 53 45           1156         .ascii     "BASE"
      0005A0                       1157 BASE:
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 23.
Hexadecimal [24-Bits]



      0005A0 90 AE 00 06      [ 2] 1158 	LDW Y,#UBASE 
      0005A4 1D 00 02         [ 2] 1159 	SUBW X,#2
      0005A7 FF               [ 2] 1160         LDW (X),Y
      0005A8 81               [ 4] 1161         RET
                                   1162 
                                   1163 ;       tmp     ( -- a )
                                   1164 ;       A temporary storage.
      0005A9 05 9B                 1165         .word      LINK
                                   1166         
                           0005AB  1167 LINK = . 
      0005AB 03                    1168 	.byte      3
      0005AC 54 4D 50              1169         .ascii     "TMP"
      0005AF                       1170 TEMP:
      0005AF 90 AE 00 08      [ 2] 1171 	LDW Y,#UTMP
      0005B3 1D 00 02         [ 2] 1172 	SUBW X,#2
      0005B6 FF               [ 2] 1173         LDW (X),Y
      0005B7 81               [ 4] 1174         RET
                                   1175 
                                   1176 ;       >IN     ( -- a )
                                   1177 ;        Hold parsing pointer.
      0005B8 05 AB                 1178         .word      LINK
                           0005BA  1179 LINK = . 
      0005BA 03                    1180         .byte      3
      0005BB 3E 49 4E              1181         .ascii    ">IN"
      0005BE                       1182 INN:
      0005BE 90 AE 00 0A      [ 2] 1183 	LDW Y,#UINN 
      0005C2 1D 00 02         [ 2] 1184 	SUBW X,#2
      0005C5 FF               [ 2] 1185         LDW (X),Y
      0005C6 81               [ 4] 1186         RET
                                   1187 
                                   1188 ;       #TIB    ( -- a )
                                   1189 ;       Count in terminal input buffer.
      0005C7 05 BA                 1190         .word      LINK
                           0005C9  1191 LINK = . 
      0005C9 04                    1192         .byte      4
      0005CA 23 54 49 42           1193         .ascii     "#TIB"
      0005CE                       1194 NTIB:
      0005CE 90 AE 00 0C      [ 2] 1195 	LDW Y,#UCTIB 
      0005D2 1D 00 02         [ 2] 1196 	SUBW X,#2
      0005D5 FF               [ 2] 1197         LDW (X),Y
      0005D6 81               [ 4] 1198         RET
                                   1199 
                                   1200 ;       TBUF ( -- a )
                                   1201 ;       address of 128 bytes transaction buffer 
      0005D7 05 C9                 1202         .word LINK 
                           0005D9  1203         LINK=.
      0005D9 04                    1204         .byte 4 
      0005DA 54 42 55 46           1205         .ascii "TBUF"
      0005DE                       1206 TBUF:
      0005DE 90 AE 16 80      [ 2] 1207         ldw y,#ROWBUFF
      0005E2 1D 00 02         [ 2] 1208         subw x,#CELLL
      0005E5 FF               [ 2] 1209         ldw (x),y 
      0005E6 81               [ 4] 1210         ret 
                                   1211 
                                   1212 ; systeme variable 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 24.
Hexadecimal [24-Bits]



                                   1213 ; compilation destination 
                                   1214 ; TFLASH ( -- A )
      0005E7 05 D9                 1215         .word LINK 
                           0005E9  1216         LINK=.
      0005E9 06                    1217         .byte 6 
      0005EA 54 46 4C 41 53 48     1218         .ascii "TFLASH"         
      0005F0                       1219 TFLASH:
      0005F0 1D 00 02         [ 2] 1220         subw x,#CELLL 
      0005F3 90 AE 00 1E      [ 2] 1221         ldw y,#UTFLASH
      0005F7 FF               [ 2] 1222         ldw (x),y 
      0005F8 81               [ 4] 1223         ret 
                                   1224 
                                   1225 ;       "EVAL   ( -- a )
                                   1226 ;       Execution vector of EVAL.
      0005F9 05 E9                 1227         .word      LINK
                           0005FB  1228 LINK = . 
      0005FB 05                    1229         .byte      5
      0005FC 27 45 56 41 4C        1230         .ascii     "'EVAL"
      000601                       1231 TEVAL:
      000601 90 AE 00 10      [ 2] 1232 	LDW Y,#UINTER 
      000605 1D 00 02         [ 2] 1233 	SUBW X,#2
      000608 FF               [ 2] 1234         LDW (X),Y
      000609 81               [ 4] 1235         RET
                                   1236 
                                   1237 ;       HLD     ( -- a )
                                   1238 ;       Hold a pointer of output string.
      00060A 05 FB                 1239         .word      LINK
                           00060C  1240 LINK = . 
      00060C 03                    1241         .byte      3
      00060D 48 4C 44              1242         .ascii     "HLD"
      000610                       1243 HLD:
      000610 90 AE 00 12      [ 2] 1244 	LDW Y,#UHLD 
      000614 1D 00 02         [ 2] 1245 	SUBW X,#2
      000617 FF               [ 2] 1246         LDW (X),Y
      000618 81               [ 4] 1247         RET
                                   1248 
                                   1249 ;       CONTEXT ( -- a )
                                   1250 ;       Start vocabulary search.
      000619 06 0C                 1251         .word      LINK
                           00061B  1252 LINK = . 
      00061B 07                    1253         .byte      7
      00061C 43 4F 4E 54 45 58 54  1254         .ascii     "CONTEXT"
      000623                       1255 CNTXT:
      000623 90 AE 00 14      [ 2] 1256 	LDW Y,#UCNTXT
      000627 1D 00 02         [ 2] 1257 	SUBW X,#2
      00062A FF               [ 2] 1258         LDW (X),Y
      00062B 81               [ 4] 1259         RET
                                   1260 
                                   1261 ;       VP      ( -- a )
                                   1262 ;       Point to top of variables
      00062C 06 1B                 1263         .word      LINK
                           00062E  1264 LINK = . 
      00062E 02                    1265         .byte      2
      00062F 56 50                 1266         .ascii     "VP"
      000631                       1267 VPP:
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 25.
Hexadecimal [24-Bits]



      000631 90 AE 00 16      [ 2] 1268 	LDW Y,#UVP 
      000635 1D 00 02         [ 2] 1269 	SUBW X,#2
      000638 FF               [ 2] 1270         LDW (X),Y
      000639 81               [ 4] 1271         RET
                                   1272 
                                   1273 ;       CP    ( -- a )
                                   1274 ;       Pointer to top of FLASH 
      00063A 06 2E                 1275         .word LINK 
                           00063C  1276         LINK=.
      00063C 02                    1277         .byte 2 
      00063D 43 50                 1278         .ascii "CP"
      00063F                       1279 CPP: 
      00063F 90 AE 00 18      [ 2] 1280         ldw y,#UCP 
      000643 1D 00 02         [ 2] 1281         subw x,#CELLL 
      000646 FF               [ 2] 1282         ldw (x),y 
      000647 81               [ 4] 1283         ret                
                                   1284 
                                   1285 ;       LAST    ( -- a )
                                   1286 ;       Point to last name in dictionary.
      000648 06 3C                 1287         .word      LINK
                           00064A  1288 LINK = . 
      00064A 04                    1289         .byte      4
      00064B 4C 41 53 54           1290         .ascii     "LAST"
      00064F                       1291 LAST:
      00064F 90 AE 00 1A      [ 2] 1292 	LDW Y,#ULAST 
      000653 1D 00 02         [ 2] 1293 	SUBW X,#2
      000656 FF               [ 2] 1294         LDW (X),Y
      000657 81               [ 4] 1295         RET
                                   1296 
                                   1297 ; address of system variable URLAST 
                                   1298 ;       RAMLAST ( -- a )
                                   1299 ; RAM dictionary context 
      000658 06 4A                 1300         .word LINK 
                           00065A  1301         LINK=. 
      00065A 07                    1302         .byte 7  
      00065B 52 41 4D 4C 41 53 54  1303         .ascii "RAMLAST" 
      000662                       1304 RAMLAST: 
      000662 90 AE 00 20      [ 2] 1305         ldw y,#URLAST 
      000666 1D 00 02         [ 2] 1306         subw x,#CELLL 
      000669 FF               [ 2] 1307         ldw (x),y 
      00066A 81               [ 4] 1308         ret 
                                   1309 
                                   1310 ; OFFSET ( -- a )
                                   1311 ; address of system variable OFFSET 
      00066B 06 5A                 1312         .word LINK 
                           00066D  1313         LINK=.
      00066D 06                    1314         .byte 6
      00066E 4F 46 46 53 45 54     1315         .ascii "OFFSET" 
      000674                       1316 OFFSET: 
      000674 1D 00 02         [ 2] 1317         subw x,#CELLL
      000677 90 AE 00 1C      [ 2] 1318         ldw y,#UOFFSET 
      00067B FF               [ 2] 1319         ldw (x),y 
      00067C 81               [ 4] 1320         ret 
                                   1321 
                                   1322 ; adjust jump address adding OFFSET
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 26.
Hexadecimal [24-Bits]



                                   1323 ; ADR-ADJ ( a -- a+offset )
      00067D                       1324 ADRADJ: 
      00067D CD 06 74         [ 4] 1325         call OFFSET 
      000680 CD 04 3C         [ 4] 1326         call AT 
      000683 CC 06 DE         [ 2] 1327         jp PLUS 
                                   1328 
                                   1329 
                                   1330 ;; Common functions
                                   1331 
                                   1332 ;       ?DUP    ( w -- w w | 0 )
                                   1333 ;       Dup tos if its is not zero.
      000686 06 6D                 1334         .word      LINK
                           000688  1335 LINK = . 
      000688 04                    1336         .byte      4
      000689 3F 44 55 50           1337         .ascii     "?DUP"
      00068D                       1338 QDUP:
      00068D 90 93            [ 1] 1339         LDW Y,X
      00068F 90 FE            [ 2] 1340 	LDW Y,(Y)
      000691 27 04            [ 1] 1341         JREQ     QDUP1
      000693 1D 00 02         [ 2] 1342 	SUBW X,#2
      000696 FF               [ 2] 1343         LDW (X),Y
      000697 81               [ 4] 1344 QDUP1:  RET
                                   1345 
                                   1346 ;       ROT     ( w1 w2 w3 -- w2 w3 w1 )
                                   1347 ;       Rot 3rd item to top.
      000698 06 88                 1348         .word      LINK
                           00069A  1349 LINK = . 
      00069A 03                    1350         .byte      3
      00069B 52 4F 54              1351         .ascii     "ROT"
      00069E                       1352 ROT:
      00069E 90 93            [ 1] 1353         ldw y,x 
      0006A0 90 FE            [ 2] 1354         ldw y,(y)
      0006A2 90 89            [ 2] 1355         pushw y 
      0006A4 90 93            [ 1] 1356         ldw y,x 
      0006A6 90 EE 04         [ 2] 1357         ldw y,(4,y)
      0006A9 FF               [ 2] 1358         ldw (x),y 
      0006AA 90 93            [ 1] 1359         ldw y,x 
      0006AC 90 EE 02         [ 2] 1360         ldw y,(2,y)
      0006AF EF 04            [ 2] 1361         ldw (4,x),y 
      0006B1 90 85            [ 2] 1362         popw y 
      0006B3 EF 02            [ 2] 1363         ldw (2,x),y
      0006B5 81               [ 4] 1364         ret 
                                   1365 
                                   1366 ;       2DROP   ( w w -- )
                                   1367 ;       Discard two items on stack.
      0006B6 06 9A                 1368         .word      LINK
                           0006B8  1369 LINK = . 
      0006B8 05                    1370         .byte      5
      0006B9 32 44 52 4F 50        1371         .ascii     "2DROP"
      0006BE                       1372 DDROP:
      0006BE 1C 00 04         [ 2] 1373         ADDW X,#4
      0006C1 81               [ 4] 1374         RET
                                   1375 
                                   1376 ;       2DUP    ( w1 w2 -- w1 w2 w1 w2 )
                                   1377 ;       Duplicate top two items.
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 27.
Hexadecimal [24-Bits]



      0006C2 06 B8                 1378         .word      LINK
                           0006C4  1379 LINK = . 
      0006C4 04                    1380         .byte      4
      0006C5 32 44 55 50           1381         .ascii     "2DUP"
      0006C9                       1382 DDUP:
      0006C9 1D 00 04         [ 2] 1383         SUBW X,#4
      0006CC 90 93            [ 1] 1384         LDW Y,X
      0006CE 90 EE 06         [ 2] 1385         LDW Y,(6,Y)
      0006D1 EF 02            [ 2] 1386         LDW (2,X),Y
      0006D3 90 93            [ 1] 1387         LDW Y,X
      0006D5 90 EE 04         [ 2] 1388         LDW Y,(4,Y)
      0006D8 FF               [ 2] 1389         LDW (X),Y
      0006D9 81               [ 4] 1390         RET
                                   1391 
                                   1392 ;       +       ( w w -- sum )
                                   1393 ;       Add top two items.
      0006DA 06 C4                 1394         .word      LINK
                           0006DC  1395 LINK = . 
      0006DC 01                    1396         .byte      1
      0006DD 2B                    1397         .ascii     "+"
      0006DE                       1398 PLUS:
      0006DE 90 93            [ 1] 1399         LDW Y,X
      0006E0 90 FE            [ 2] 1400         LDW Y,(Y)
      0006E2 90 BF 24         [ 2] 1401         LDW YTEMP,Y
      0006E5 1C 00 02         [ 2] 1402         ADDW X,#2
      0006E8 90 93            [ 1] 1403         LDW Y,X
      0006EA 90 FE            [ 2] 1404         LDW Y,(Y)
      0006EC 72 B9 00 24      [ 2] 1405         ADDW Y,YTEMP
      0006F0 FF               [ 2] 1406         LDW (X),Y
      0006F1 81               [ 4] 1407         RET
                                   1408 
                                   1409 ;       NOT     ( w -- w )
                                   1410 ;       One's complement of tos.
      0006F2 06 DC                 1411         .word      LINK
                           0006F4  1412 LINK = . 
      0006F4 03                    1413         .byte      3
      0006F5 4E 4F 54              1414         .ascii     "NOT"
      0006F8                       1415 INVER:
      0006F8 90 93            [ 1] 1416         LDW Y,X
      0006FA 90 FE            [ 2] 1417         LDW Y,(Y)
      0006FC 90 53            [ 2] 1418         CPLW Y
      0006FE FF               [ 2] 1419         LDW (X),Y
      0006FF 81               [ 4] 1420         RET
                                   1421 
                                   1422 ;       NEGATE  ( n -- -n )
                                   1423 ;       Two's complement of tos.
      000700 06 F4                 1424         .word      LINK
                           000702  1425 LINK = . 
      000702 06                    1426         .byte      6
      000703 4E 45 47 41 54 45     1427         .ascii     "NEGATE"
      000709                       1428 NEGAT:
      000709 90 93            [ 1] 1429         LDW Y,X
      00070B 90 FE            [ 2] 1430         LDW Y,(Y)
      00070D 90 50            [ 2] 1431         NEGW Y
      00070F FF               [ 2] 1432         LDW (X),Y
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 28.
Hexadecimal [24-Bits]



      000710 81               [ 4] 1433         RET
                                   1434 
                                   1435 ;       DNEGATE ( d -- -d )
                                   1436 ;       Two's complement of top double.
      000711 07 02                 1437         .word      LINK
                           000713  1438 LINK = . 
      000713 07                    1439         .byte      7
      000714 44 4E 45 47 41 54 45  1440         .ascii     "DNEGATE"
      00071B                       1441 DNEGA:
      00071B 90 93            [ 1] 1442         LDW Y,X
      00071D 90 FE            [ 2] 1443 	LDW Y,(Y)
      00071F 90 53            [ 2] 1444         CPLW Y     
      000721 90 BF 24         [ 2] 1445 	LDW YTEMP,Y
      000724 90 93            [ 1] 1446         LDW Y,X
      000726 90 EE 02         [ 2] 1447         LDW Y,(2,Y)
      000729 90 53            [ 2] 1448         CPLW Y
      00072B 72 A9 00 01      [ 2] 1449         addw y,#1
      00072F EF 02            [ 2] 1450         LDW (2,X),Y
      000731 90 BE 24         [ 2] 1451         LDW Y,YTEMP
      000734 24 02            [ 1] 1452         JRNC DN1 
      000736 90 5C            [ 2] 1453         INCW Y
      000738 FF               [ 2] 1454 DN1:    LDW (X),Y
      000739 81               [ 4] 1455         RET
                                   1456 
                                   1457 
                                   1458 ;       S>D ( n -- d )
                                   1459 ; convert single integer to double 
      00073A 07 13                 1460         .word LINK 
                           00073C  1461         LINK=. 
      00073C 03                    1462         .byte 3 
      00073D 53 3E 44              1463         .ascii "S>D"
      000740                       1464 STOD: 
      000740 1D 00 02         [ 2] 1465         subw x,#CELLL 
      000743 90 5F            [ 1] 1466         clrw y 
      000745 FF               [ 2] 1467         ldw (x),y 
      000746 90 93            [ 1] 1468         ldw y,x 
      000748 90 EE 02         [ 2] 1469         ldw y,(2,y)
      00074B 2A 05            [ 1] 1470         jrpl 1$ 
      00074D 90 AE FF FF      [ 2] 1471         ldw y,#-1
      000751 FF               [ 2] 1472         ldw (x),y 
      000752 81               [ 4] 1473 1$:     ret 
                                   1474 
                                   1475 
                                   1476 
                                   1477 
                                   1478 ;       -       ( n1 n2 -- n1-n2 )
                                   1479 ;       Subtraction.
      000753 07 3C                 1480         .word      LINK
                           000755  1481 LINK = . 
      000755 01                    1482         .byte      1
      000756 2D                    1483         .ascii     "-"
      000757                       1484 SUBB:
      000757 90 93            [ 1] 1485         LDW Y,X
      000759 90 FE            [ 2] 1486         LDW Y,(Y)
      00075B 90 BF 24         [ 2] 1487         LDW YTEMP,Y
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 29.
Hexadecimal [24-Bits]



      00075E 1C 00 02         [ 2] 1488         ADDW X,#2
      000761 90 93            [ 1] 1489         LDW Y,X
      000763 90 FE            [ 2] 1490         LDW Y,(Y)
      000765 72 B2 00 24      [ 2] 1491         SUBW Y,YTEMP
      000769 FF               [ 2] 1492         LDW (X),Y
      00076A 81               [ 4] 1493         RET
                                   1494 
                                   1495 ;       ABS     ( n -- n )
                                   1496 ;       Return  absolute value of n.
      00076B 07 55                 1497         .word      LINK
                           00076D  1498 LINK = . 
      00076D 03                    1499         .byte      3
      00076E 41 42 53              1500         .ascii     "ABS"
      000771                       1501 ABSS:
      000771 90 93            [ 1] 1502         LDW Y,X
      000773 90 FE            [ 2] 1503 	LDW Y,(Y)
      000775 2A 03            [ 1] 1504         JRPL     AB1     ;negate:
      000777 90 50            [ 2] 1505         NEGW     Y     ;else negate hi byte
      000779 FF               [ 2] 1506         LDW (X),Y
      00077A 81               [ 4] 1507 AB1:    RET
                                   1508 
                                   1509 ;       =       ( w w -- t )
                                   1510 ;       Return true if top two are =al.
      00077B 07 6D                 1511         .word      LINK
                           00077D  1512 LINK = . 
      00077D 01                    1513         .byte      1
      00077E 3D                    1514         .ascii     "="
      00077F                       1515 EQUAL:
      00077F A6 FF            [ 1] 1516         LD A,#0xFF  ;true
      000781 90 93            [ 1] 1517         LDW Y,X    ;D = n2
      000783 90 FE            [ 2] 1518         LDW Y,(Y)
      000785 90 BF 24         [ 2] 1519         LDW YTEMP,Y
      000788 1C 00 02         [ 2] 1520         ADDW X,#2
      00078B 90 93            [ 1] 1521         LDW Y,X
      00078D 90 FE            [ 2] 1522         LDW Y,(Y)
      00078F 90 B3 24         [ 2] 1523         CPW Y,YTEMP     ;if n2 <> n1
      000792 27 01            [ 1] 1524         JREQ     EQ1
      000794 4F               [ 1] 1525         CLR A
      000795 F7               [ 1] 1526 EQ1:    LD (X),A
      000796 E7 01            [ 1] 1527         LD (1,X),A
      000798 81               [ 4] 1528 	RET     
                                   1529 
                                   1530 ;       U<      ( u u -- t )
                                   1531 ;       Unsigned compare of top two items.
      000799 07 7D                 1532         .word      LINK
                           00079B  1533 LINK = . 
      00079B 02                    1534         .byte      2
      00079C 55 3C                 1535         .ascii     "U<"
      00079E                       1536 ULESS:
      00079E A6 FF            [ 1] 1537         LD A,#0xFF  ;true
      0007A0 90 93            [ 1] 1538         LDW Y,X    ;D = n2
      0007A2 90 FE            [ 2] 1539         LDW Y,(Y)
      0007A4 90 BF 24         [ 2] 1540         LDW YTEMP,Y
      0007A7 1C 00 02         [ 2] 1541         ADDW X,#2
      0007AA 90 93            [ 1] 1542         LDW Y,X
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 30.
Hexadecimal [24-Bits]



      0007AC 90 FE            [ 2] 1543         LDW Y,(Y)
      0007AE 90 B3 24         [ 2] 1544         CPW Y,YTEMP     ;if n2 <> n1
      0007B1 25 01            [ 1] 1545         JRULT     ULES1
      0007B3 4F               [ 1] 1546         CLR A
      0007B4 F7               [ 1] 1547 ULES1:  LD (X),A
      0007B5 E7 01            [ 1] 1548         LD (1,X),A
      0007B7 81               [ 4] 1549 	RET     
                                   1550 
                                   1551 ;       <       ( n1 n2 -- t )
                                   1552 ;       Signed compare of top two items.
      0007B8 07 9B                 1553         .word      LINK
                           0007BA  1554 LINK = . 
      0007BA 01                    1555         .byte      1
      0007BB 3C                    1556         .ascii     "<"
      0007BC                       1557 LESS:
      0007BC A6 FF            [ 1] 1558         LD A,#0xFF  ;true
      0007BE 90 93            [ 1] 1559         LDW Y,X    ;D = n2
      0007C0 90 FE            [ 2] 1560         LDW Y,(Y)
      0007C2 90 BF 24         [ 2] 1561         LDW YTEMP,Y
      0007C5 1C 00 02         [ 2] 1562         ADDW X,#2
      0007C8 90 93            [ 1] 1563         LDW Y,X
      0007CA 90 FE            [ 2] 1564         LDW Y,(Y)
      0007CC 90 B3 24         [ 2] 1565         CPW Y,YTEMP     ;if n2 <> n1
      0007CF 2F 01            [ 1] 1566         JRSLT     LT1
      0007D1 4F               [ 1] 1567         CLR A
      0007D2 F7               [ 1] 1568 LT1:    LD (X),A
      0007D3 E7 01            [ 1] 1569         LD (1,X),A
      0007D5 81               [ 4] 1570 	RET     
                                   1571 
                                   1572 ;       MAX     ( n n -- n )
                                   1573 ;       Return greater of two top items.
      0007D6 07 BA                 1574         .word      LINK
                           0007D8  1575 LINK = . 
      0007D8 03                    1576         .byte      3
      0007D9 4D 41 58              1577         .ascii     "MAX"
      0007DC                       1578 MAX:
      0007DC 90 93            [ 1] 1579         LDW Y,X    ;D = n2
      0007DE 90 EE 02         [ 2] 1580         LDW Y,(2,Y)
      0007E1 90 BF 24         [ 2] 1581         LDW YTEMP,Y
      0007E4 90 93            [ 1] 1582         LDW Y,X
      0007E6 90 FE            [ 2] 1583         LDW Y,(Y)
      0007E8 90 B3 24         [ 2] 1584         CPW Y,YTEMP     ;if n2 <> n1
      0007EB 2F 02            [ 1] 1585         JRSLT     MAX1
      0007ED EF 02            [ 2] 1586         LDW (2,X),Y
      0007EF 1C 00 02         [ 2] 1587 MAX1:   ADDW X,#2
      0007F2 81               [ 4] 1588 	RET     
                                   1589 
                                   1590 ;       MIN     ( n n -- n )
                                   1591 ;       Return smaller of top two items.
      0007F3 07 D8                 1592         .word      LINK
                           0007F5  1593 LINK = . 
      0007F5 03                    1594         .byte      3
      0007F6 4D 49 4E              1595         .ascii     "MIN"
      0007F9                       1596 MIN:
      0007F9 90 93            [ 1] 1597         LDW Y,X    ;D = n2
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 31.
Hexadecimal [24-Bits]



      0007FB 90 EE 02         [ 2] 1598         LDW Y,(2,Y)
      0007FE 90 BF 24         [ 2] 1599         LDW YTEMP,Y
      000801 90 93            [ 1] 1600         LDW Y,X
      000803 90 FE            [ 2] 1601         LDW Y,(Y)
      000805 90 B3 24         [ 2] 1602         CPW Y,YTEMP     ;if n2 <> n1
      000808 2C 02            [ 1] 1603         JRSGT     MIN1
      00080A EF 02            [ 2] 1604         LDW (2,X),Y
      00080C 1C 00 02         [ 2] 1605 MIN1:	ADDW X,#2
      00080F 81               [ 4] 1606 	RET     
                                   1607 
                                   1608 ;       WITHIN  ( u ul uh -- t )
                                   1609 ;       Return true if u is within
                                   1610 ;       range of ul and uh. ( ul <= u < uh )
      000810 07 F5                 1611         .word      LINK
                           000812  1612 LINK = . 
      000812 06                    1613         .byte      6
      000813 57 49 54 48 49 4E     1614         .ascii     "WITHIN"
      000819                       1615 WITHI:
      000819 CD 05 0D         [ 4] 1616         CALL     OVER
      00081C CD 07 57         [ 4] 1617         CALL     SUBB
      00081F CD 04 AC         [ 4] 1618         CALL     TOR
      000822 CD 07 57         [ 4] 1619         CALL     SUBB
      000825 CD 04 8D         [ 4] 1620         CALL     RFROM
      000828 CC 07 9E         [ 2] 1621         JP     ULESS
                                   1622 
                                   1623 ;; Divide
                                   1624 
                                   1625 ;       UM/MOD  ( udl udh un -- ur uq )
                                   1626 ;       Unsigned divide of a double by a
                                   1627 ;       single. Return mod and quotient.
      00082B 08 12                 1628         .word      LINK
                           00082D  1629 LINK = . 
      00082D 06                    1630         .byte      6
      00082E 55 4D 2F 4D 4F 44     1631         .ascii     "UM/MOD"
      000834                       1632 UMMOD:
      000834 BF 22            [ 2] 1633 	LDW XTEMP,X	; save stack pointer
      000836 FE               [ 2] 1634 	LDW X,(X)	; un
      000837 BF 24            [ 2] 1635 	LDW YTEMP,X     ; save un
      000839 90 BE 22         [ 2] 1636 	LDW Y,XTEMP	; stack pointer
      00083C 90 EE 04         [ 2] 1637 	LDW Y,(4,Y)     ; Y=udl
      00083F BE 22            [ 2] 1638 	LDW X,XTEMP
      000841 EE 02            [ 2] 1639 	LDW X,(2,X)	; X=udh
      000843 B3 24            [ 2] 1640 	CPW X,YTEMP
      000845 23 0F            [ 2] 1641 	JRULE MMSM1
      000847 BE 22            [ 2] 1642 	LDW X,XTEMP
      000849 1C 00 02         [ 2] 1643 	ADDW X,#2	; pop off 1 level
      00084C 90 AE FF FF      [ 2] 1644 	LDW Y,#0xFFFF
      000850 FF               [ 2] 1645 	LDW (X),Y
      000851 90 5F            [ 1] 1646 	CLRW Y
      000853 EF 02            [ 2] 1647 	LDW (2,X),Y
      000855 81               [ 4] 1648 	RET
      000856                       1649 MMSM1:
                                   1650 ; take advantage of divw x,y when udh==0
      000856 5D               [ 2] 1651         tnzw x  ; is udh==0?
      000857 26 11            [ 1] 1652         jrne MMSM2 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 32.
Hexadecimal [24-Bits]



      000859 93               [ 1] 1653         ldw x,y    ;udl 
      00085A 90 BE 24         [ 2] 1654         ldw y,YTEMP ; divisor 
      00085D 65               [ 2] 1655         divw x,y 
      00085E 89               [ 2] 1656         pushw x     ; quotient 
      00085F BE 22            [ 2] 1657         ldw x,XTEMP 
      000861 1C 00 02         [ 2] 1658         addw x,#CELLL 
      000864 EF 02            [ 2] 1659         ldw (2,x),y  ; ur
      000866 90 85            [ 2] 1660         popw y 
      000868 FF               [ 2] 1661         ldw (x),y ; uq 
      000869 81               [ 4] 1662         ret 
      00086A                       1663 MMSM2:        
      00086A A6 11            [ 1] 1664 	LD A,#17	; loop count
      00086C                       1665 MMSM3:
      00086C B3 24            [ 2] 1666 	CPW X,YTEMP	; compare udh to un
      00086E 25 04            [ 1] 1667 	JRULT MMSM4	; can't subtract
      000870 72 B0 00 24      [ 2] 1668 	SUBW X,YTEMP	; can subtract
      000874                       1669 MMSM4:
      000874 8C               [ 1] 1670 	CCF	; quotient bit
      000875 90 59            [ 2] 1671 	RLCW Y	; rotate into quotient
      000877 59               [ 2] 1672 	RLCW X	; rotate into remainder
      000878 4A               [ 1] 1673 	DEC A	; repeat
      000879 22 F1            [ 1] 1674 	JRUGT MMSM3
      00087B 56               [ 2] 1675         RRCW X 
      00087C BF 24            [ 2] 1676 	LDW YTEMP,X	; done, save remainder
      00087E BE 22            [ 2] 1677 	LDW X,XTEMP
      000880 1C 00 02         [ 2] 1678 	ADDW X,#2	; drop
      000883 FF               [ 2] 1679 	LDW (X),Y
      000884 90 BE 24         [ 2] 1680 	LDW Y,YTEMP	; save quotient
      000887 EF 02            [ 2] 1681 	LDW (2,X),Y
      000889 81               [ 4] 1682 	RET
                                   1683 	
                                   1684 ;       M/MOD   ( d n -- r q )
                                   1685 ;       Signed floored divide of double by
                                   1686 ;       single. Return mod and quotient.
      00088A 08 2D                 1687         .word      LINK
                           00088C  1688 LINK = . 
      00088C 05                    1689         .byte      5
      00088D 4D 2F 4D 4F 44        1690         .ascii     "M/MOD"
      000892                       1691 MSMOD:  
      000892 CD 04 E3         [ 4] 1692         CALL	DUPP
      000895 CD 05 1C         [ 4] 1693         CALL	ZLESS
      000898 CD 04 E3         [ 4] 1694         CALL	DUPP
      00089B CD 04 AC         [ 4] 1695         CALL	TOR
      00089E CD 03 E7         [ 4] 1696         CALL	QBRAN
      0008A1 08 AF                 1697         .word	MMOD1
      0008A3 CD 07 09         [ 4] 1698         CALL	NEGAT
      0008A6 CD 04 AC         [ 4] 1699         CALL	TOR
      0008A9 CD 07 1B         [ 4] 1700         CALL	DNEGA
      0008AC CD 04 8D         [ 4] 1701         CALL	RFROM
      0008AF CD 04 AC         [ 4] 1702 MMOD1:	CALL	TOR
      0008B2 CD 04 E3         [ 4] 1703         CALL	DUPP
      0008B5 CD 05 1C         [ 4] 1704         CALL	ZLESS
      0008B8 CD 03 E7         [ 4] 1705         CALL	QBRAN
      0008BB 08 C3                 1706         .word	MMOD2
      0008BD CD 04 A0         [ 4] 1707         CALL	RAT
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 33.
Hexadecimal [24-Bits]



      0008C0 CD 06 DE         [ 4] 1708         CALL	PLUS
      0008C3 CD 04 8D         [ 4] 1709 MMOD2:	CALL	RFROM
      0008C6 CD 08 34         [ 4] 1710         CALL	UMMOD
      0008C9 CD 04 8D         [ 4] 1711         CALL	RFROM
      0008CC CD 03 E7         [ 4] 1712         CALL	QBRAN
      0008CF 08 DA                 1713         .word	MMOD3
      0008D1 CD 04 F3         [ 4] 1714         CALL	SWAPP
      0008D4 CD 07 09         [ 4] 1715         CALL	NEGAT
      0008D7 CD 04 F3         [ 4] 1716         CALL	SWAPP
      0008DA 81               [ 4] 1717 MMOD3:	RET
                                   1718 
                                   1719 ;       /MOD    ( n n -- r q )
                                   1720 ;       Signed divide. Return mod and quotient.
      0008DB 08 8C                 1721         .word      LINK
                           0008DD  1722 LINK = . 
      0008DD 04                    1723         .byte      4
      0008DE 2F 4D 4F 44           1724         .ascii     "/MOD"
      0008E2                       1725 SLMOD:
      0008E2 CD 05 0D         [ 4] 1726         CALL	OVER
      0008E5 CD 05 1C         [ 4] 1727         CALL	ZLESS
      0008E8 CD 04 F3         [ 4] 1728         CALL	SWAPP
      0008EB CC 08 92         [ 2] 1729         JP	MSMOD
                                   1730 
                                   1731 ;       MOD     ( n n -- r )
                                   1732 ;       Signed divide. Return mod only.
      0008EE 08 DD                 1733         .word      LINK
                           0008F0  1734 LINK = . 
      0008F0 03                    1735         .byte      3
      0008F1 4D 4F 44              1736         .ascii     "MOD"
      0008F4                       1737 MODD:
      0008F4 CD 08 E2         [ 4] 1738 	CALL	SLMOD
      0008F7 CC 04 D9         [ 2] 1739 	JP	DROP
                                   1740 
                                   1741 ;       /       ( n n -- q )
                                   1742 ;       Signed divide. Return quotient only.
      0008FA 08 F0                 1743         .word      LINK
                           0008FC  1744 LINK = . 
      0008FC 01                    1745         .byte      1
      0008FD 2F                    1746         .ascii     "/"
      0008FE                       1747 SLASH:
      0008FE CD 08 E2         [ 4] 1748         CALL	SLMOD
      000901 CD 04 F3         [ 4] 1749         CALL	SWAPP
      000904 CC 04 D9         [ 2] 1750         JP	DROP
                                   1751 
                                   1752 ;; Multiply
                                   1753 
                                   1754 ;       UM*     ( u u -- ud )
                                   1755 ;       Unsigned multiply. Return double product.
      000907 08 FC                 1756         .word      LINK
                           000909  1757 LINK = . 
      000909 03                    1758         .byte      3
      00090A 55 4D 2A              1759         .ascii     "UM*"
      00090D                       1760 UMSTA:	; stack have 4 bytes u1=a,b u2=c,d
                                   1761 ; take advantage of SP addressing modes
                                   1762 ; these PRODx in RAM are not required
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 34.
Hexadecimal [24-Bits]



                                   1763 ; the product is kept on stack as local variable 
                                   1764         ;; bytes offset on data stack 
                           000002  1765         da=2 
                           000003  1766         db=3 
                           000000  1767         dc=0 
                           000001  1768         dd=1 
                                   1769         ;; product bytes offset on return stack 
                           000001  1770         UD1=1  ; ud bits 31..24
                           000002  1771         UD2=2  ; ud bits 23..16
                           000003  1772         UD3=3  ; ud bits 15..8 
                           000004  1773         UD4=4  ; ud bits 7..0 
                                   1774         ;; local variable for product set to zero   
      00090D 90 5F            [ 1] 1775         clrw y 
      00090F 90 89            [ 2] 1776         pushw y  ; bits 15..0
      000911 90 89            [ 2] 1777         pushw y  ; bits 31..16 
      000913 E6 03            [ 1] 1778         ld a,(db,x) ; b 
      000915 90 97            [ 1] 1779         ld yl,a 
      000917 E6 01            [ 1] 1780         ld a,(dd,x)   ; d
      000919 90 42            [ 4] 1781         mul y,a    ; b*d  
      00091B 17 03            [ 2] 1782         ldw (UD3,sp),y ; lowest weight product 
      00091D E6 03            [ 1] 1783         ld a,(db,x)
      00091F 90 97            [ 1] 1784         ld yl,a 
      000921 E6 00            [ 1] 1785         ld a,(dc,x)
      000923 90 42            [ 4] 1786         mul y,a  ; b*c 
                                   1787         ;;; do the partial sum 
      000925 72 F9 02         [ 2] 1788         addw y,(UD2,sp)
      000928 4F               [ 1] 1789         clr a 
      000929 49               [ 1] 1790         rlc a
      00092A 6B 01            [ 1] 1791         ld (UD1,sp),a 
      00092C 17 02            [ 2] 1792         ldw (UD2,sp),y 
      00092E E6 02            [ 1] 1793         ld a,(da,x)
      000930 90 97            [ 1] 1794         ld yl,a 
      000932 E6 01            [ 1] 1795         ld a,(dd,x)
      000934 90 42            [ 4] 1796         mul y,a   ; a*d 
                                   1797         ;; do partial sum 
      000936 72 F9 02         [ 2] 1798         addw y,(UD2,sp)
      000939 4F               [ 1] 1799         clr a 
      00093A 19 01            [ 1] 1800         adc a,(UD1,sp)
      00093C 6B 01            [ 1] 1801         ld (UD1,sp),a  
      00093E 17 02            [ 2] 1802         ldw (UD2,sp),y 
      000940 E6 02            [ 1] 1803         ld a,(da,x)
      000942 90 97            [ 1] 1804         ld yl,a 
      000944 E6 00            [ 1] 1805         ld a,(dc,x)
      000946 90 42            [ 4] 1806         mul y,a  ;  a*c highest weight product 
                                   1807         ;;; do partial sum 
      000948 72 F9 01         [ 2] 1808         addw y,(UD1,sp)
      00094B FF               [ 2] 1809         ldw (x),y  ; udh 
      00094C 16 03            [ 2] 1810         ldw y,(UD3,sp)
      00094E EF 02            [ 2] 1811         ldw (2,x),y  ; udl  
      000950 5B 04            [ 2] 1812         addw sp,#4 ; drop local variable 
      000952 81               [ 4] 1813         ret  
                                   1814 
                                   1815 
                                   1816 ;       *       ( n n -- n )
                                   1817 ;       Signed multiply. Return single product.
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 35.
Hexadecimal [24-Bits]



      000953 09 09                 1818         .word      LINK
                           000955  1819 LINK = . 
      000955 01                    1820         .byte      1
      000956 2A                    1821         .ascii     "*"
      000957                       1822 STAR:
      000957 CD 09 0D         [ 4] 1823 	CALL	UMSTA
      00095A CC 04 D9         [ 2] 1824 	JP	DROP
                                   1825 
                                   1826 ;       M*      ( n n -- d )
                                   1827 ;       Signed multiply. Return double product.
      00095D 09 55                 1828         .word      LINK
                           00095F  1829 LINK = . 
      00095F 02                    1830         .byte      2
      000960 4D 2A                 1831         .ascii     "M*"
      000962                       1832 MSTAR:      
      000962 CD 06 C9         [ 4] 1833         CALL	DDUP
      000965 CD 05 58         [ 4] 1834         CALL	XORR
      000968 CD 05 1C         [ 4] 1835         CALL	ZLESS
      00096B CD 04 AC         [ 4] 1836         CALL	TOR
      00096E CD 07 71         [ 4] 1837         CALL	ABSS
      000971 CD 04 F3         [ 4] 1838         CALL	SWAPP
      000974 CD 07 71         [ 4] 1839         CALL	ABSS
      000977 CD 09 0D         [ 4] 1840         CALL	UMSTA
      00097A CD 04 8D         [ 4] 1841         CALL	RFROM
      00097D CD 03 E7         [ 4] 1842         CALL	QBRAN
      000980 09 85                 1843         .word	MSTA1
      000982 CD 07 1B         [ 4] 1844         CALL	DNEGA
      000985 81               [ 4] 1845 MSTA1:	RET
                                   1846 
                                   1847 ;       */MOD   ( n1 n2 n3 -- r q )
                                   1848 ;       Multiply n1 and n2, then divide
                                   1849 ;       by n3. Return mod and quotient.
      000986 09 5F                 1850         .word      LINK
                           000988  1851 LINK = . 
      000988 05                    1852         .byte      5
      000989 2A 2F 4D 4F 44        1853         .ascii     "*/MOD"
      00098E                       1854 SSMOD:
      00098E CD 04 AC         [ 4] 1855         CALL     TOR
      000991 CD 09 62         [ 4] 1856         CALL     MSTAR
      000994 CD 04 8D         [ 4] 1857         CALL     RFROM
      000997 CC 08 92         [ 2] 1858         JP     MSMOD
                                   1859 
                                   1860 ;       */      ( n1 n2 n3 -- q )
                                   1861 ;       Multiply n1 by n2, then divide
                                   1862 ;       by n3. Return quotient only.
      00099A 09 88                 1863         .word      LINK
                           00099C  1864 LINK = . 
      00099C 02                    1865         .byte      2
      00099D 2A 2F                 1866         .ascii     "*/"
      00099F                       1867 STASL:
      00099F CD 09 8E         [ 4] 1868         CALL	SSMOD
      0009A2 CD 04 F3         [ 4] 1869         CALL	SWAPP
      0009A5 CC 04 D9         [ 2] 1870         JP	DROP
                                   1871 
                                   1872 ;; Miscellaneous
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 36.
Hexadecimal [24-Bits]



                                   1873 
                                   1874 ;       CELL+   ( a -- a )
                                   1875 ;       Add cell size in byte to address.
      0009A8 09 9C                 1876         .word      LINK
                           0009AA  1877 LINK = . 
      0009AA 02                    1878         .byte       2
      0009AB 32 2B                 1879         .ascii     "2+"
      0009AD                       1880 CELLP:
      0009AD 90 93            [ 1] 1881         LDW Y,X
      0009AF 90 FE            [ 2] 1882 	LDW Y,(Y)
      0009B1 72 A9 00 02      [ 2] 1883         ADDW Y,#CELLL 
      0009B5 FF               [ 2] 1884         LDW (X),Y
      0009B6 81               [ 4] 1885         RET
                                   1886 
                                   1887 ;       CELL-   ( a -- a )
                                   1888 ;       Subtract 2 from address.
      0009B7 09 AA                 1889         .word      LINK
                           0009B9  1890 LINK = . 
      0009B9 02                    1891         .byte       2
      0009BA 32 2D                 1892         .ascii     "2-"
      0009BC                       1893 CELLM:
      0009BC 90 93            [ 1] 1894         LDW Y,X
      0009BE 90 FE            [ 2] 1895 	LDW Y,(Y)
      0009C0 72 A2 00 02      [ 2] 1896         SUBW Y,#CELLL
      0009C4 FF               [ 2] 1897         LDW (X),Y
      0009C5 81               [ 4] 1898         RET
                                   1899 
                                   1900 ;       CELLS   ( n -- n )
                                   1901 ;       Multiply tos by 2.
      0009C6 09 B9                 1902         .word      LINK
                           0009C8  1903 LINK = . 
      0009C8 02                    1904         .byte       2
      0009C9 32 2A                 1905         .ascii     "2*"
      0009CB                       1906 CELLS:
      0009CB 90 93            [ 1] 1907         LDW Y,X
      0009CD 90 FE            [ 2] 1908 	LDW Y,(Y)
      0009CF 90 58            [ 2] 1909         SLAW Y
      0009D1 FF               [ 2] 1910         LDW (X),Y
      0009D2 81               [ 4] 1911         RET
                                   1912 
                                   1913 ;       1+      ( a -- a )
                                   1914 ;       Add cell size in byte to address.
      0009D3 09 C8                 1915         .word      LINK
                           0009D5  1916 LINK = . 
      0009D5 02                    1917         .byte      2
      0009D6 31 2B                 1918         .ascii     "1+"
      0009D8                       1919 ONEP:
      0009D8 90 93            [ 1] 1920         LDW Y,X
      0009DA 90 FE            [ 2] 1921 	LDW Y,(Y)
      0009DC 90 5C            [ 2] 1922         INCW Y
      0009DE FF               [ 2] 1923         LDW (X),Y
      0009DF 81               [ 4] 1924         RET
                                   1925 
                                   1926 ;       1-      ( a -- a )
                                   1927 ;       Subtract 2 from address.
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 37.
Hexadecimal [24-Bits]



      0009E0 09 D5                 1928         .word      LINK
                           0009E2  1929 LINK = . 
      0009E2 02                    1930         .byte      2
      0009E3 31 2D                 1931         .ascii     "1-"
      0009E5                       1932 ONEM:
      0009E5 90 93            [ 1] 1933         LDW Y,X
      0009E7 90 FE            [ 2] 1934 	LDW Y,(Y)
      0009E9 90 5A            [ 2] 1935         DECW Y
      0009EB FF               [ 2] 1936         LDW (X),Y
      0009EC 81               [ 4] 1937         RET
                                   1938 
                                   1939 ;  shift left n times 
                                   1940 ; LSHIFT ( n1 n2 -- n1<<n2 )
      0009ED 09 E2                 1941         .word LINK 
                           0009EF  1942         LINK=.
      0009EF 06                    1943         .byte 6 
      0009F0 4C 53 48 49 46 54     1944         .ascii "LSHIFT"
      0009F6                       1945 LSHIFT:
      0009F6 E6 01            [ 1] 1946         ld a,(1,x)
      0009F8 1C 00 02         [ 2] 1947         addw x,#CELLL 
      0009FB 90 93            [ 1] 1948         ldw y,x 
      0009FD 90 FE            [ 2] 1949         ldw y,(y)
      0009FF                       1950 LSHIFT1:
      0009FF 4D               [ 1] 1951         tnz a 
      000A00 27 05            [ 1] 1952         jreq LSHIFT4 
      000A02 90 58            [ 2] 1953         sllw y 
      000A04 4A               [ 1] 1954         dec a 
      000A05 20 F8            [ 2] 1955         jra LSHIFT1 
      000A07                       1956 LSHIFT4:
      000A07 FF               [ 2] 1957         ldw (x),y 
      000A08 81               [ 4] 1958         ret 
                                   1959 
                                   1960 ; shift right n times                 
                                   1961 ; RSHIFT (n1 n2 -- n1>>n2 )
      000A09 09 EF                 1962         .word LINK 
                           000A0B  1963         LINK=.
      000A0B 06                    1964         .byte 6
      000A0C 52 53 48 49 46 54     1965         .ascii "RSHIFT"
      000A12                       1966 RSHIFT:
      000A12 E6 01            [ 1] 1967         ld a,(1,x)
      000A14 1C 00 02         [ 2] 1968         addw x,#CELLL 
      000A17 90 93            [ 1] 1969         ldw y,x 
      000A19 90 FE            [ 2] 1970         ldw y,(y)
      000A1B                       1971 RSHIFT1:
      000A1B 4D               [ 1] 1972         tnz a 
      000A1C 27 05            [ 1] 1973         jreq RSHIFT4 
      000A1E 90 54            [ 2] 1974         srlw y 
      000A20 4A               [ 1] 1975         dec a 
      000A21 20 F8            [ 2] 1976         jra RSHIFT1 
      000A23                       1977 RSHIFT4:
      000A23 FF               [ 2] 1978         ldw (x),y 
      000A24 81               [ 4] 1979         ret 
                                   1980 
                                   1981 
                                   1982 ;       2/      ( n -- n )
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 38.
Hexadecimal [24-Bits]



                                   1983 ;       divide  tos by 2.
      000A25 0A 0B                 1984         .word      LINK
                           000A27  1985 LINK = . 
      000A27 02                    1986         .byte      2
      000A28 32 2F                 1987         .ascii     "2/"
      000A2A                       1988 TWOSL:
      000A2A 90 93            [ 1] 1989         LDW Y,X
      000A2C 90 FE            [ 2] 1990 	LDW Y,(Y)
      000A2E 90 57            [ 2] 1991         SRAW Y
      000A30 FF               [ 2] 1992         LDW (X),Y
      000A31 81               [ 4] 1993         RET
                                   1994 
                                   1995 ;       BL      ( -- 32 )
                                   1996 ;       Return 32,  blank character.
      000A32 0A 27                 1997         .word      LINK
                           000A34  1998 LINK = . 
      000A34 02                    1999         .byte      2
      000A35 42 4C                 2000         .ascii     "BL"
      000A37                       2001 BLANK:
      000A37 1D 00 02         [ 2] 2002         SUBW X,#2
      000A3A 90 AE 00 20      [ 2] 2003 	LDW Y,#32
      000A3E FF               [ 2] 2004         LDW (X),Y
      000A3F 81               [ 4] 2005         RET
                                   2006 
                                   2007 ;         0     ( -- 0)
                                   2008 ;         Return 0.
      000A40 0A 34                 2009         .word      LINK
                           000A42  2010 LINK = . 
      000A42 01                    2011         .byte       1
      000A43 30                    2012         .ascii     "0"
      000A44                       2013 ZERO:
      000A44 1D 00 02         [ 2] 2014         SUBW X,#2
      000A47 90 5F            [ 1] 2015 	CLRW Y
      000A49 FF               [ 2] 2016         LDW (X),Y
      000A4A 81               [ 4] 2017         RET
                                   2018 
                                   2019 ;         1     ( -- 1)
                                   2020 ;         Return 1.
      000A4B 0A 42                 2021         .word      LINK
                           000A4D  2022 LINK = . 
      000A4D 01                    2023         .byte       1
      000A4E 31                    2024         .ascii     "1"
      000A4F                       2025 ONE:
      000A4F 1D 00 02         [ 2] 2026         SUBW X,#2
      000A52 90 AE 00 01      [ 2] 2027 	LDW Y,#1
      000A56 FF               [ 2] 2028         LDW (X),Y
      000A57 81               [ 4] 2029         RET
                                   2030 
                                   2031 ;         -1    ( -- -1)
                                   2032 ;         Return 32,  blank character.
      000A58 0A 4D                 2033         .word      LINK
                           000A5A  2034 LINK = . 
      000A5A 02                    2035         .byte       2
      000A5B 2D 31                 2036         .ascii     "-1"
      000A5D                       2037 MONE:
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 39.
Hexadecimal [24-Bits]



      000A5D 1D 00 02         [ 2] 2038         SUBW X,#2
      000A60 90 AE FF FF      [ 2] 2039 	LDW Y,#0xFFFF
      000A64 FF               [ 2] 2040         LDW (X),Y
      000A65 81               [ 4] 2041         RET
                                   2042 
                                   2043 ;       >CHAR   ( c -- c )
                                   2044 ;       Filter non-printing characters.
      000A66 0A 5A                 2045         .word      LINK
                           000A68  2046 LINK = . 
      000A68 05                    2047         .byte      5
      000A69 3E 43 48 41 52        2048         .ascii     ">CHAR"
      000A6E                       2049 TCHAR:
      000A6E E6 01            [ 1] 2050         ld a,(1,x)
      000A70 A1 20            [ 1] 2051         cp a,#32  
      000A72 2B 05            [ 1] 2052         jrmi 1$ 
      000A74 A1 7F            [ 1] 2053         cp a,#127 
      000A76 2A 01            [ 1] 2054         jrpl 1$ 
      000A78 81               [ 4] 2055         ret 
      000A79 A6 5F            [ 1] 2056 1$:     ld a,#'_ 
      000A7B E7 01            [ 1] 2057         ld (1,x),a 
      000A7D 81               [ 4] 2058         ret 
                                   2059 
                                   2060 ;       DEPTH   ( -- n )
                                   2061 ;       Return  depth of  data stack.
      000A7E 0A 68                 2062         .word      LINK
                           000A80  2063 LINK = . 
      000A80 05                    2064         .byte      5
      000A81 44 45 50 54 48        2065         .ascii     "DEPTH"
      000A86                       2066 DEPTH: 
      000A86 90 BE 2A         [ 2] 2067         LDW Y,SP0    ;save data stack ptr
      000A89 BF 22            [ 2] 2068 	LDW XTEMP,X
      000A8B 72 B2 00 22      [ 2] 2069         SUBW Y,XTEMP     ;#bytes = SP0 - X
      000A8F 90 57            [ 2] 2070         SRAW Y    ;Y = #stack items
      000A91 1D 00 02         [ 2] 2071 	SUBW X,#2
      000A94 FF               [ 2] 2072         LDW (X),Y     ; if neg, underflow
      000A95 81               [ 4] 2073         RET
                                   2074 
                                   2075 ;       PICK    ( ... +n -- ... w )
                                   2076 ;       Copy  nth stack item to tos.
      000A96 0A 80                 2077         .word      LINK
                           000A98  2078 LINK = . 
      000A98 04                    2079         .byte      4
      000A99 50 49 43 4B           2080         .ascii     "PICK"
      000A9D                       2081 PICK:
      000A9D 90 93            [ 1] 2082         LDW Y,X   ;D = n1
      000A9F 90 FE            [ 2] 2083         LDW Y,(Y)
                                   2084 ; modified for standard compliance          
                                   2085 ; 0 PICK must be equivalent to DUP 
      000AA1 90 5C            [ 2] 2086         INCW Y 
      000AA3 90 58            [ 2] 2087         SLAW Y
      000AA5 BF 22            [ 2] 2088         LDW XTEMP,X
      000AA7 72 B9 00 22      [ 2] 2089         ADDW Y,XTEMP
      000AAB 90 FE            [ 2] 2090         LDW Y,(Y)
      000AAD FF               [ 2] 2091         LDW (X),Y
      000AAE 81               [ 4] 2092         RET
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 40.
Hexadecimal [24-Bits]



                                   2093 
                                   2094 ;; Memory access
                                   2095 
                                   2096 ;       +!      ( n a -- )
                                   2097 ;       Add n to  contents at address a.
      000AAF 0A 98                 2098         .word      LINK
                           000AB1  2099 LINK = . 
      000AB1 02                    2100         .byte      2
      000AB2 2B 21                 2101         .ascii     "+!"
      000AB4                       2102 PSTOR:
      000AB4 90 93            [ 1] 2103         ldw y,x 
      000AB6 90 FE            [ 2] 2104         ldw y,(y)
      000AB8 90 BF 24         [ 2] 2105         ldw YTEMP,y  ; address
      000ABB 90 FE            [ 2] 2106         ldw y,(y)  
      000ABD 90 89            [ 2] 2107         pushw y  ; value at address 
      000ABF 90 93            [ 1] 2108         ldw y,x 
      000AC1 90 EE 02         [ 2] 2109         ldw y,(2,y) ; n 
      000AC4 72 F9 01         [ 2] 2110         addw y,(1,sp) ; n+value
      000AC7 91 CF 24         [ 5] 2111         ldw [YTEMP],y ;  a!
      000ACA 90 85            [ 2] 2112         popw y    ;drop local var
      000ACC 1C 00 04         [ 2] 2113         addw x,#4 ; DDROP 
      000ACF 81               [ 4] 2114         ret 
                                   2115 
                                   2116 ;       2!      ( d a -- )
                                   2117 ;       Store  double integer to address a.
      000AD0 0A B1                 2118         .word      LINK
                           000AD2  2119 LINK = . 
      000AD2 02                    2120         .byte      2
      000AD3 32 21                 2121         .ascii     "2!"
      000AD5                       2122 DSTOR:
      000AD5 90 93            [ 1] 2123         ldw y,x 
      000AD7 90 FE            [ 2] 2124         ldw y,(y)
      000AD9 90 BF 24         [ 2] 2125         ldw YTEMP,y ; address 
      000ADC 1C 00 02         [ 2] 2126         addw x,#CELLL ; drop a 
      000ADF 90 93            [ 1] 2127         ldw y,x 
      000AE1 90 FE            [ 2] 2128         ldw y,(y) ; hi word 
      000AE3 89               [ 2] 2129         pushw x 
      000AE4 EE 02            [ 2] 2130         ldw x,(2,x) ; lo word 
      000AE6 91 CF 24         [ 5] 2131         ldw [YTEMP],y
      000AE9 90 93            [ 1] 2132         ldw y,x 
      000AEB AE 00 02         [ 2] 2133         ldw x,#2 
      000AEE 92 DF 24         [ 5] 2134         ldw ([YTEMP],x),y 
      000AF1 85               [ 2] 2135         popw x 
      000AF2 1C 00 04         [ 2] 2136         addw x,#4 ; DDROP 
      000AF5 81               [ 4] 2137         ret 
                                   2138 
                                   2139 ;       2@      ( a -- d )
                                   2140 ;       Fetch double integer from address a.
      000AF6 0A D2                 2141         .word      LINK
                           000AF8  2142 LINK = . 
      000AF8 02                    2143         .byte      2
      000AF9 32 40                 2144         .ascii     "2@"
      000AFB                       2145 DAT:
      000AFB 90 93            [ 1] 2146         ldw y,x 
      000AFD 90 FE            [ 2] 2147         ldw y,(y) ;address 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 41.
Hexadecimal [24-Bits]



      000AFF 90 BF 24         [ 2] 2148         ldw YTEMP,y 
      000B02 1D 00 02         [ 2] 2149         subw x,#CELLL ; space for udh 
      000B05 91 CE 24         [ 5] 2150         ldw y,[YTEMP] ; udh 
      000B08 FF               [ 2] 2151         ldw (x),y 
      000B09 90 AE 00 02      [ 2] 2152         ldw y,#2
      000B0D 91 DE 24         [ 5] 2153         ldw y,([YTEMP],y) ; udl 
      000B10 EF 02            [ 2] 2154         ldw (2,x),y
      000B12 81               [ 4] 2155         ret 
                                   2156 
                                   2157 ;       COUNT   ( b -- b +n )
                                   2158 ;       Return count byte of a string
                                   2159 ;       and add 1 to byte address.
      000B13 0A F8                 2160         .word      LINK
                           000B15  2161 LINK = . 
      000B15 05                    2162         .byte      5
      000B16 43 4F 55 4E 54        2163         .ascii     "COUNT"
      000B1B                       2164 COUNT:
      000B1B 90 93            [ 1] 2165         ldw y,x 
      000B1D 90 FE            [ 2] 2166         ldw y,(y) ; address 
      000B1F 90 F6            [ 1] 2167         ld a,(y)  ; count 
      000B21 90 5C            [ 2] 2168         incw y 
      000B23 FF               [ 2] 2169         ldw (x),y 
      000B24 1D 00 02         [ 2] 2170         subw x,#CELLL 
      000B27 E7 01            [ 1] 2171         ld (1,x),a 
      000B29 7F               [ 1] 2172         clr (x)
      000B2A 81               [ 4] 2173         ret 
                                   2174 
                                   2175 ;       HERE    ( -- a )
                                   2176 ;       Return  top of  variables
      000B2B 0B 15                 2177         .word      LINK
                           000B2D  2178 LINK = . 
      000B2D 04                    2179         .byte      4
      000B2E 48 45 52 45           2180         .ascii     "HERE"
      000B32                       2181 HERE:
      000B32 90 AE 00 16      [ 2] 2182       	ldw y,#UVP 
      000B36 90 FE            [ 2] 2183         ldw y,(y)
      000B38 1D 00 02         [ 2] 2184         subw x,#CELLL 
      000B3B FF               [ 2] 2185         ldw (x),y 
      000B3C 81               [ 4] 2186         ret 
                                   2187 
                                   2188 ;       PAD     ( -- a )
                                   2189 ;       Return address of text buffer
                                   2190 ;       above  code dictionary.
      000B3D 0B 2D                 2191         .word      LINK
                           000B3F  2192 LINK = . 
      000B3F 03                    2193         .byte      3
      000B40 50 41 44              2194         .ascii     "PAD"
      000B43                       2195 PAD:
      000B43 CD 0B 32         [ 4] 2196         CALL     HERE
      000B46 CD 03 B4         [ 4] 2197         CALL     DOLIT
      000B49 00 50                 2198         .word      80
      000B4B CC 06 DE         [ 2] 2199         JP     PLUS
                                   2200 
                                   2201 ;       TIB     ( -- a )
                                   2202 ;       Return address of terminal input buffer.
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 42.
Hexadecimal [24-Bits]



      000B4E 0B 3F                 2203         .word      LINK
                           000B50  2204 LINK = . 
      000B50 03                    2205         .byte      3
      000B51 54 49 42              2206         .ascii     "TIB"
      000B54                       2207 TIB:
      000B54 CD 05 CE         [ 4] 2208         CALL     NTIB
      000B57 CD 09 AD         [ 4] 2209         CALL     CELLP
      000B5A CC 04 3C         [ 2] 2210         JP     AT
                                   2211 
                                   2212 ;       @EXECUTE        ( a -- )
                                   2213 ;       Execute vector stored in address a.
      000B5D 0B 50                 2214         .word      LINK
                           000B5F  2215 LINK = . 
      000B5F 08                    2216         .byte      8
      000B60 40 45 58 45 43 55 54  2217         .ascii     "@EXECUTE"
             45
      000B68                       2218 ATEXE:
      000B68 CD 04 3C         [ 4] 2219         CALL     AT
      000B6B CD 06 8D         [ 4] 2220         CALL     QDUP    ;?address or zero
      000B6E CD 03 E7         [ 4] 2221         CALL     QBRAN
      000B71 0B 76                 2222         .word      EXE1
      000B73 CD 04 0E         [ 4] 2223         CALL     EXECU   ;execute if non-zero
      000B76 81               [ 4] 2224 EXE1:   RET     ;do nothing if zero
                                   2225 
                                   2226 ;       CMOVE   ( b1 b2 u -- )
                                   2227 ;       Copy u bytes from b1 to b2.
      000B77 0B 5F                 2228         .word      LINK
                           000B79  2229 LINK = . 
      000B79 05                    2230         .byte      5
      000B7A 43 4D 4F 56 45        2231         .ascii     "CMOVE"
      000B7F                       2232 CMOVE:
      000B7F CD 04 AC         [ 4] 2233         CALL	TOR
      000B82 CD 03 FE         [ 4] 2234         CALL	BRAN
      000B85 0B 9F                 2235         .word	CMOV2
      000B87 CD 04 AC         [ 4] 2236 CMOV1:	CALL	TOR
      000B8A CD 04 E3         [ 4] 2237         CALL	DUPP
      000B8D CD 04 5A         [ 4] 2238         CALL	CAT
      000B90 CD 04 A0         [ 4] 2239         CALL	RAT
      000B93 CD 04 49         [ 4] 2240         CALL	CSTOR
      000B96 CD 09 D8         [ 4] 2241         CALL	ONEP
      000B99 CD 04 8D         [ 4] 2242         CALL	RFROM
      000B9C CD 09 D8         [ 4] 2243         CALL	ONEP
      000B9F CD 03 C8         [ 4] 2244 CMOV2:	CALL	DONXT
      000BA2 0B 87                 2245         .word	CMOV1
      000BA4 CC 06 BE         [ 2] 2246         JP	DDROP
                                   2247 
                                   2248 ;       FILL    ( b u c -- )
                                   2249 ;       Fill u bytes of character c
                                   2250 ;       to area beginning at b.
      000BA7 0B 79                 2251         .word       LINK
                           000BA9  2252 LINK = . 
      000BA9 04                    2253         .byte       4
      000BAA 46 49 4C 4C           2254         .ascii     "FILL"
      000BAE                       2255 FILL:
      000BAE 90 93            [ 1] 2256         ldw y,x 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 43.
Hexadecimal [24-Bits]



      000BB0 90 E6 01         [ 1] 2257         ld a,(1,y) ; c 
      000BB3 1C 00 02         [ 2] 2258         addw x,#CELLL ; drop c 
      000BB6 90 93            [ 1] 2259         ldw y,x 
      000BB8 90 FE            [ 2] 2260         ldw y,(y) ; count
      000BBA 90 89            [ 2] 2261         pushw y 
      000BBC 1C 00 02         [ 2] 2262         addw x,#CELLL ; drop u 
      000BBF 90 93            [ 1] 2263         ldw y,x 
      000BC1 1C 00 02         [ 2] 2264         addw x,#CELLL ; drop b 
      000BC4 90 FE            [ 2] 2265         ldw y,(y) ; address
      000BC6 90 BF 24         [ 2] 2266         ldw YTEMP,y
      000BC9 90 85            [ 2] 2267         popw y ; count 
      000BCB                       2268 FILL1:  
      000BCB 92 C7 24         [ 4] 2269         ld [YTEMP],a 
      000BCE 3C 25            [ 1] 2270         inc YTEMP+1
      000BD0 24 02            [ 1] 2271         jrnc FILL2 
      000BD2 3C 24            [ 1] 2272         inc YTEMP
      000BD4                       2273 FILL2: 
      000BD4 90 5A            [ 2] 2274         decw y ; count 
      000BD6 26 F3            [ 1] 2275         jrne FILL1  
      000BD8 81               [ 4] 2276         ret 
                                   2277 
                                   2278 ;       ERASE   ( b u -- )
                                   2279 ;       Erase u bytes beginning at b.
      000BD9 0B A9                 2280         .word      LINK
                           000BDB  2281 LINK = . 
      000BDB 05                    2282         .byte      5
      000BDC 45 52 41 53 45        2283         .ascii     "ERASE"
      000BE1                       2284 ERASE:
      000BE1 90 5F            [ 1] 2285         clrw y 
      000BE3 1D 00 02         [ 2] 2286         subw x,#CELLL 
      000BE6 FF               [ 2] 2287         ldw (x),y 
      000BE7 CC 0B AE         [ 2] 2288         jp FILL 
                                   2289 
                                   2290 
                                   2291 ;       PACK0x   ( b u a -- a )
                                   2292 ;       Build a counted string with
                                   2293 ;       u characters from b. Null fill.
      000BEA 0B DB                 2294         .word      LINK
                           000BEC  2295 LINK = . 
      000BEC 05                    2296         .byte      5
      000BED 50 41 43 4B 30 58     2297         .ascii     "PACK0X"
      000BF3                       2298 PACKS:
      000BF3 CD 04 E3         [ 4] 2299         CALL     DUPP
      000BF6 CD 04 AC         [ 4] 2300         CALL     TOR     ;strings only on cell boundary
      000BF9 CD 06 C9         [ 4] 2301         CALL     DDUP
      000BFC CD 04 49         [ 4] 2302         CALL     CSTOR
      000BFF CD 09 D8         [ 4] 2303         CALL     ONEP ;save count
      000C02 CD 04 F3         [ 4] 2304         CALL     SWAPP
      000C05 CD 0B 7F         [ 4] 2305         CALL     CMOVE
      000C08 CD 04 8D         [ 4] 2306         CALL     RFROM
      000C0B 81               [ 4] 2307         RET
                                   2308 
                                   2309 ;; Numeric output, single precision
                                   2310 
                                   2311 ;       DIGIT   ( u -- c )
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 44.
Hexadecimal [24-Bits]



                                   2312 ;       Convert digit u to a character.
      000C0C 0B EC                 2313         .word      LINK
                           000C0E  2314 LINK = . 
      000C0E 05                    2315         .byte      5
      000C0F 44 49 47 49 54        2316         .ascii     "DIGIT"
      000C14                       2317 DIGIT:
      000C14 CD 03 B4         [ 4] 2318         CALL	DOLIT
      000C17 00 09                 2319         .word	9
      000C19 CD 05 0D         [ 4] 2320         CALL	OVER
      000C1C CD 07 BC         [ 4] 2321         CALL	LESS
      000C1F CD 03 B4         [ 4] 2322         CALL	DOLIT
      000C22 00 07                 2323         .word	7
      000C24 CD 05 2F         [ 4] 2324         CALL	ANDD
      000C27 CD 06 DE         [ 4] 2325         CALL	PLUS
      000C2A CD 03 B4         [ 4] 2326         CALL	DOLIT
      000C2D 00 30                 2327         .word	48	;'0'
      000C2F CC 06 DE         [ 2] 2328         JP	PLUS
                                   2329 
                                   2330 ;       EXTRACT ( n base -- n c )
                                   2331 ;       Extract least significant digit from n.
      000C32 0C 0E                 2332         .word      LINK
                           000C34  2333 LINK = . 
      000C34 07                    2334         .byte      7
      000C35 45 58 54 52 41 43 54  2335         .ascii     "EXTRACT"
      000C3C                       2336 EXTRC:
      000C3C CD 0A 44         [ 4] 2337         CALL     ZERO
      000C3F CD 04 F3         [ 4] 2338         CALL     SWAPP
      000C42 CD 08 34         [ 4] 2339         CALL     UMMOD
      000C45 CD 04 F3         [ 4] 2340         CALL     SWAPP
      000C48 CC 0C 14         [ 2] 2341         JP     DIGIT
                                   2342 
                                   2343 ;       <#      ( -- )
                                   2344 ;       Initiate  numeric output process.
      000C4B 0C 34                 2345         .word      LINK
                           000C4D  2346 LINK = . 
      000C4D 02                    2347         .byte      2
      000C4E 3C 23                 2348         .ascii     "<#"
      000C50                       2349 BDIGS:
      000C50 CD 0B 43         [ 4] 2350         CALL     PAD
      000C53 CD 06 10         [ 4] 2351         CALL     HLD
      000C56 CC 04 25         [ 2] 2352         JP     STORE
                                   2353 
                                   2354 ;       HOLD    ( c -- )
                                   2355 ;       Insert a character into output string.
      000C59 0C 4D                 2356         .word      LINK
                           000C5B  2357 LINK = . 
      000C5B 04                    2358         .byte      4
      000C5C 48 4F 4C 44           2359         .ascii     "HOLD"
      000C60                       2360 HOLD:
      000C60 CD 06 10         [ 4] 2361         CALL     HLD
      000C63 CD 04 3C         [ 4] 2362         CALL     AT
      000C66 CD 09 E5         [ 4] 2363         CALL     ONEM
      000C69 CD 04 E3         [ 4] 2364         CALL     DUPP
      000C6C CD 06 10         [ 4] 2365         CALL     HLD
      000C6F CD 04 25         [ 4] 2366         CALL     STORE
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 45.
Hexadecimal [24-Bits]



      000C72 CC 04 49         [ 2] 2367         JP     CSTOR
                                   2368 
                                   2369 ;       #       ( u -- u )
                                   2370 ;       Extract one digit from u and
                                   2371 ;       append digit to output string.
      000C75 0C 5B                 2372         .word      LINK
                           000C77  2373 LINK = . 
      000C77 01                    2374         .byte      1
      000C78 23                    2375         .ascii     "#"
      000C79                       2376 DIG:
      000C79 CD 05 A0         [ 4] 2377         CALL     BASE
      000C7C CD 04 3C         [ 4] 2378         CALL     AT
      000C7F CD 0C 3C         [ 4] 2379         CALL     EXTRC
      000C82 CC 0C 60         [ 2] 2380         JP     HOLD
                                   2381 
                                   2382 ;       #S      ( u -- 0 )
                                   2383 ;       Convert u until all digits
                                   2384 ;       are added to output string.
      000C85 0C 77                 2385         .word      LINK
                           000C87  2386 LINK = . 
      000C87 02                    2387         .byte      2
      000C88 23 53                 2388         .ascii     "#S"
      000C8A                       2389 DIGS:
      000C8A CD 0C 79         [ 4] 2390 DIGS1:  CALL     DIG
      000C8D CD 04 E3         [ 4] 2391         CALL     DUPP
      000C90 CD 03 E7         [ 4] 2392         CALL     QBRAN
      000C93 0C 97                 2393         .word      DIGS2
      000C95 20 F3            [ 2] 2394         JRA     DIGS1
      000C97 81               [ 4] 2395 DIGS2:  RET
                                   2396 
                                   2397 ;       SIGN    ( n -- )
                                   2398 ;       Add a minus sign to
                                   2399 ;       numeric output string.
      000C98 0C 87                 2400         .word      LINK
                           000C9A  2401 LINK = . 
      000C9A 04                    2402         .byte      4
      000C9B 53 49 47 4E           2403         .ascii     "SIGN"
      000C9F                       2404 SIGN:
      000C9F CD 05 1C         [ 4] 2405         CALL     ZLESS
      000CA2 CD 03 E7         [ 4] 2406         CALL     QBRAN
      000CA5 0C AF                 2407         .word      SIGN1
      000CA7 CD 03 B4         [ 4] 2408         CALL     DOLIT
      000CAA 00 2D                 2409         .word      45	;"-"
      000CAC CC 0C 60         [ 2] 2410         JP     HOLD
      000CAF 81               [ 4] 2411 SIGN1:  RET
                                   2412 
                                   2413 ;       #>      ( w -- b u )
                                   2414 ;       Prepare output string.
      000CB0 0C 9A                 2415         .word      LINK
                           000CB2  2416 LINK = . 
      000CB2 02                    2417         .byte      2
      000CB3 23 3E                 2418         .ascii     "#>"
      000CB5                       2419 EDIGS:
      000CB5 CD 04 D9         [ 4] 2420         CALL     DROP
      000CB8 CD 06 10         [ 4] 2421         CALL     HLD
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 46.
Hexadecimal [24-Bits]



      000CBB CD 04 3C         [ 4] 2422         CALL     AT
      000CBE CD 0B 43         [ 4] 2423         CALL     PAD
      000CC1 CD 05 0D         [ 4] 2424         CALL     OVER
      000CC4 CC 07 57         [ 2] 2425         JP     SUBB
                                   2426 
                                   2427 ;       str     ( w -- b u )
                                   2428 ;       Convert a signed integer
                                   2429 ;       to a numeric string.
      000CC7 0C B2                 2430         .word      LINK
                           000CC9  2431 LINK = . 
      000CC9 03                    2432         .byte      3
      000CCA 53 54 52              2433         .ascii     "STR"
      000CCD                       2434 STR:
      000CCD CD 04 E3         [ 4] 2435         CALL     DUPP
      000CD0 CD 04 AC         [ 4] 2436         CALL     TOR
      000CD3 CD 07 71         [ 4] 2437         CALL     ABSS
      000CD6 CD 0C 50         [ 4] 2438         CALL     BDIGS
      000CD9 CD 0C 8A         [ 4] 2439         CALL     DIGS
      000CDC CD 04 8D         [ 4] 2440         CALL     RFROM
      000CDF CD 0C 9F         [ 4] 2441         CALL     SIGN
      000CE2 CC 0C B5         [ 2] 2442         JP     EDIGS
                                   2443 
                                   2444 ;       HEX     ( -- )
                                   2445 ;       Use radix 16 as base for
                                   2446 ;       numeric conversions.
      000CE5 0C C9                 2447         .word      LINK
                           000CE7  2448 LINK = . 
      000CE7 03                    2449         .byte      3
      000CE8 48 45 58              2450         .ascii     "HEX"
      000CEB                       2451 HEX:
      000CEB CD 03 B4         [ 4] 2452         CALL     DOLIT
      000CEE 00 10                 2453         .word      16
      000CF0 CD 05 A0         [ 4] 2454         CALL     BASE
      000CF3 CC 04 25         [ 2] 2455         JP     STORE
                                   2456 
                                   2457 ;       DECIMAL ( -- )
                                   2458 ;       Use radix 10 as base
                                   2459 ;       for numeric conversions.
      000CF6 0C E7                 2460         .word      LINK
                           000CF8  2461 LINK = . 
      000CF8 07                    2462         .byte      7
      000CF9 44 45 43 49 4D 41 4C  2463         .ascii     "DECIMAL"
      000D00                       2464 DECIM:
      000D00 CD 03 B4         [ 4] 2465         CALL     DOLIT
      000D03 00 0A                 2466         .word      10
      000D05 CD 05 A0         [ 4] 2467         CALL     BASE
      000D08 CC 04 25         [ 2] 2468         JP     STORE
                                   2469 
                                   2470 ;; Numeric input, single precision
                                   2471 
                                   2472 ;       DIGIT?  ( c base -- u t )
                                   2473 ;       Convert a character to its numeric
                                   2474 ;       value. A flag indicates success.
      000D0B 0C F8                 2475         .word      LINK
                           000D0D  2476 LINK = . 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 47.
Hexadecimal [24-Bits]



      000D0D 06                    2477         .byte       6
      000D0E 44 49 47 49 54 3F     2478         .ascii     "DIGIT?"
      000D14                       2479 DIGTQ:
      000D14 CD 04 AC         [ 4] 2480         CALL     TOR
      000D17 CD 03 B4         [ 4] 2481         CALL     DOLIT
      000D1A 00 30                 2482         .word     48	; "0"
      000D1C CD 07 57         [ 4] 2483         CALL     SUBB
      000D1F CD 03 B4         [ 4] 2484         CALL     DOLIT
      000D22 00 09                 2485         .word      9
      000D24 CD 05 0D         [ 4] 2486         CALL     OVER
      000D27 CD 07 BC         [ 4] 2487         CALL     LESS
      000D2A CD 03 E7         [ 4] 2488         CALL     QBRAN
      000D2D 0D 45                 2489         .word      DGTQ1
      000D2F CD 03 B4         [ 4] 2490         CALL     DOLIT
      000D32 00 07                 2491         .word      7
      000D34 CD 07 57         [ 4] 2492         CALL     SUBB
      000D37 CD 04 E3         [ 4] 2493         CALL     DUPP
      000D3A CD 03 B4         [ 4] 2494         CALL     DOLIT
      000D3D 00 0A                 2495         .word      10
      000D3F CD 07 BC         [ 4] 2496         CALL     LESS
      000D42 CD 05 43         [ 4] 2497         CALL     ORR
      000D45 CD 04 E3         [ 4] 2498 DGTQ1:  CALL     DUPP
      000D48 CD 04 8D         [ 4] 2499         CALL     RFROM
      000D4B CC 07 9E         [ 2] 2500         JP     ULESS
                                   2501 
                                   2502 ;       NUMBER? ( a -- n T | a F )
                                   2503 ;       Convert a number string to
                                   2504 ;       integer. Push a flag on tos.
      000D4E 0D 0D                 2505         .word      LINK
                           000D50  2506 LINK = . 
      000D50 07                    2507         .byte      7
      000D51 4E 55 4D 42 45 52 3F  2508         .ascii     "NUMBER?"
      000D58                       2509 NUMBQ:
      000D58 CD 05 A0         [ 4] 2510         CALL     BASE
      000D5B CD 04 3C         [ 4] 2511         CALL     AT
      000D5E CD 04 AC         [ 4] 2512         CALL     TOR
      000D61 CD 0A 44         [ 4] 2513         CALL     ZERO
      000D64 CD 05 0D         [ 4] 2514         CALL     OVER
      000D67 CD 0B 1B         [ 4] 2515         CALL     COUNT
      000D6A CD 05 0D         [ 4] 2516         CALL     OVER
      000D6D CD 04 5A         [ 4] 2517         CALL     CAT
      000D70 CD 03 B4         [ 4] 2518         CALL     DOLIT
      000D73 00 24                 2519         .word     36	; "0x"
      000D75 CD 07 7F         [ 4] 2520         CALL     EQUAL
      000D78 CD 03 E7         [ 4] 2521         CALL     QBRAN
      000D7B 0D 8C                 2522         .word      NUMQ1
      000D7D CD 0C EB         [ 4] 2523         CALL     HEX
      000D80 CD 04 F3         [ 4] 2524         CALL     SWAPP
      000D83 CD 09 D8         [ 4] 2525         CALL     ONEP
      000D86 CD 04 F3         [ 4] 2526         CALL     SWAPP
      000D89 CD 09 E5         [ 4] 2527         CALL     ONEM
      000D8C CD 05 0D         [ 4] 2528 NUMQ1:  CALL     OVER
      000D8F CD 04 5A         [ 4] 2529         CALL     CAT
      000D92 CD 03 B4         [ 4] 2530         CALL     DOLIT
      000D95 00 2D                 2531         .word     45	; "-"
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 48.
Hexadecimal [24-Bits]



      000D97 CD 07 7F         [ 4] 2532         CALL     EQUAL
      000D9A CD 04 AC         [ 4] 2533         CALL     TOR
      000D9D CD 04 F3         [ 4] 2534         CALL     SWAPP
      000DA0 CD 04 A0         [ 4] 2535         CALL     RAT
      000DA3 CD 07 57         [ 4] 2536         CALL     SUBB
      000DA6 CD 04 F3         [ 4] 2537         CALL     SWAPP
      000DA9 CD 04 A0         [ 4] 2538         CALL     RAT
      000DAC CD 06 DE         [ 4] 2539         CALL     PLUS
      000DAF CD 06 8D         [ 4] 2540         CALL     QDUP
      000DB2 CD 03 E7         [ 4] 2541         CALL     QBRAN
      000DB5 0E 16                 2542         .word      NUMQ6
      000DB7 CD 09 E5         [ 4] 2543         CALL     ONEM
      000DBA CD 04 AC         [ 4] 2544         CALL     TOR
      000DBD CD 04 E3         [ 4] 2545 NUMQ2:  CALL     DUPP
      000DC0 CD 04 AC         [ 4] 2546         CALL     TOR
      000DC3 CD 04 5A         [ 4] 2547         CALL     CAT
      000DC6 CD 05 A0         [ 4] 2548         CALL     BASE
      000DC9 CD 04 3C         [ 4] 2549         CALL     AT
      000DCC CD 0D 14         [ 4] 2550         CALL     DIGTQ
      000DCF CD 03 E7         [ 4] 2551         CALL     QBRAN
      000DD2 0E 04                 2552         .word      NUMQ4
      000DD4 CD 04 F3         [ 4] 2553         CALL     SWAPP
      000DD7 CD 05 A0         [ 4] 2554         CALL     BASE
      000DDA CD 04 3C         [ 4] 2555         CALL     AT
      000DDD CD 09 57         [ 4] 2556         CALL     STAR
      000DE0 CD 06 DE         [ 4] 2557         CALL     PLUS
      000DE3 CD 04 8D         [ 4] 2558         CALL     RFROM
      000DE6 CD 09 D8         [ 4] 2559         CALL     ONEP
      000DE9 CD 03 C8         [ 4] 2560         CALL     DONXT
      000DEC 0D BD                 2561         .word      NUMQ2
      000DEE CD 04 A0         [ 4] 2562         CALL     RAT
      000DF1 CD 04 F3         [ 4] 2563         CALL     SWAPP
      000DF4 CD 04 D9         [ 4] 2564         CALL     DROP
      000DF7 CD 03 E7         [ 4] 2565         CALL     QBRAN
      000DFA 0D FF                 2566         .word      NUMQ3
      000DFC CD 07 09         [ 4] 2567         CALL     NEGAT
      000DFF CD 04 F3         [ 4] 2568 NUMQ3:  CALL     SWAPP
      000E02 20 0F            [ 2] 2569         JRA     NUMQ5
      000E04 CD 04 8D         [ 4] 2570 NUMQ4:  CALL     RFROM
      000E07 CD 04 8D         [ 4] 2571         CALL     RFROM
      000E0A CD 06 BE         [ 4] 2572         CALL     DDROP
      000E0D CD 06 BE         [ 4] 2573         CALL     DDROP
      000E10 CD 0A 44         [ 4] 2574         CALL     ZERO
      000E13 CD 04 E3         [ 4] 2575 NUMQ5:  CALL     DUPP
      000E16 CD 04 8D         [ 4] 2576 NUMQ6:  CALL     RFROM
      000E19 CD 06 BE         [ 4] 2577         CALL     DDROP
      000E1C CD 04 8D         [ 4] 2578         CALL     RFROM
      000E1F CD 05 A0         [ 4] 2579         CALL     BASE
      000E22 CC 04 25         [ 2] 2580         JP     STORE
                                   2581 
                                   2582 ;; Basic I/O
                                   2583 
                                   2584 ;       KEY     ( -- c )
                                   2585 ;       Wait for and return an
                                   2586 ;       input character.
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 49.
Hexadecimal [24-Bits]



      000E25 0D 50                 2587         .word      LINK
                           000E27  2588 LINK = . 
      000E27 03                    2589         .byte      3
      000E28 4B 45 59              2590         .ascii     "KEY"
      000E2B                       2591 KEY:
      000E2B 72 0B 52 30 FB   [ 2] 2592         btjf UART1_SR,#UART_SR_RXNE,. 
      000E30 C6 52 31         [ 1] 2593         ld a,UART1_DR 
      000E33 1D 00 02         [ 2] 2594         subw x,#CELLL 
      000E36 E7 01            [ 1] 2595         ld (1,x),a 
      000E38 7F               [ 1] 2596         clr (x)
      000E39 81               [ 4] 2597         ret 
                                   2598 
                           000001  2599 WANT_SEE=1
                           000001  2600 .if WANT_SEE 
                                   2601 ;       NUF?    ( -- t )
                                   2602 ;       Return false if no input,
                                   2603 ;       else pause and if CR return true.
      000E3A 0E 27                 2604         .word      LINK
                           000E3C  2605 LINK = . 
      000E3C 04                    2606         .byte      4
      000E3D 4E 55 46 3F           2607         .ascii     "NUF?"
      000E41                       2608 NUFQ:
      000E41 CD 03 80         [ 4] 2609         CALL     QKEY
      000E44 CD 04 E3         [ 4] 2610         CALL     DUPP
      000E47 CD 03 E7         [ 4] 2611         CALL     QBRAN
      000E4A 0E 5A                 2612         .word    NUFQ1
      000E4C CD 06 BE         [ 4] 2613         CALL     DDROP
      000E4F CD 0E 2B         [ 4] 2614         CALL     KEY
      000E52 CD 03 B4         [ 4] 2615         CALL     DOLIT
      000E55 00 0D                 2616         .word      CRR
      000E57 CC 07 7F         [ 2] 2617         JP     EQUAL
      000E5A 81               [ 4] 2618 NUFQ1:  RET
                                   2619 .endif ; WANT_SEE
                                   2620 
                                   2621 ;       SPACE   ( -- )
                                   2622 ;       Send  blank character to
                                   2623 ;       output device.
      000E5B 0E 3C                 2624         .word      LINK
                           000E5D  2625 LINK = . 
      000E5D 05                    2626         .byte      5
      000E5E 53 50 41 43 45        2627         .ascii     "SPACE"
      000E63                       2628 SPACE:
      000E63 CD 0A 37         [ 4] 2629         CALL     BLANK
      000E66 CC 03 9E         [ 2] 2630         JP     EMIT
                                   2631 
                                   2632 ;       SPACES  ( +n -- )
                                   2633 ;       Send n spaces to output device.
      000E69 0E 5D                 2634         .word      LINK
                           000E6B  2635 LINK = . 
      000E6B 06                    2636         .byte      6
      000E6C 53 50 41 43 45 53     2637         .ascii     "SPACES"
      000E72                       2638 SPACS:
      000E72 CD 0A 44         [ 4] 2639         CALL     ZERO
      000E75 CD 07 DC         [ 4] 2640         CALL     MAX
      000E78 CD 04 AC         [ 4] 2641         CALL     TOR
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 50.
Hexadecimal [24-Bits]



      000E7B 20 03            [ 2] 2642         JRA      CHAR2
      000E7D CD 0E 63         [ 4] 2643 CHAR1:  CALL     SPACE
      000E80 CD 03 C8         [ 4] 2644 CHAR2:  CALL     DONXT
      000E83 0E 7D                 2645         .word    CHAR1
      000E85 81               [ 4] 2646         RET
                                   2647 
                                   2648 ;       TYPE    ( b u -- )
                                   2649 ;       Output u characters from b.
      000E86 0E 6B                 2650         .word      LINK
                           000E88  2651 LINK = . 
      000E88 04                    2652         .byte      4
      000E89 54 59 50 45           2653         .ascii     "TYPE"
      000E8D                       2654 TYPES:
      000E8D CD 04 AC         [ 4] 2655         CALL     TOR
      000E90 20 0C            [ 2] 2656         JRA     TYPE2
      000E92 CD 04 E3         [ 4] 2657 TYPE1:  CALL     DUPP
      000E95 CD 04 5A         [ 4] 2658         CALL     CAT
      000E98 CD 03 9E         [ 4] 2659         CALL     EMIT
      000E9B CD 09 D8         [ 4] 2660         CALL     ONEP
      000E9E CD 03 C8         [ 4] 2661 TYPE2:  CALL     DONXT
      000EA1 0E 92                 2662         .word      TYPE1
      000EA3 CC 04 D9         [ 2] 2663         JP     DROP
                                   2664 
                                   2665 ;       CR      ( -- )
                                   2666 ;       Output a carriage return
                                   2667 ;       and a line feed.
      000EA6 0E 88                 2668         .word      LINK
                           000EA8  2669 LINK = . 
      000EA8 02                    2670         .byte      2
      000EA9 43 52                 2671         .ascii     "CR"
      000EAB                       2672 CR:
      000EAB CD 03 B4         [ 4] 2673         CALL     DOLIT
      000EAE 00 0D                 2674         .word      CRR
      000EB0 CD 03 9E         [ 4] 2675         CALL     EMIT
      000EB3 CD 03 B4         [ 4] 2676         CALL     DOLIT
      000EB6 00 0A                 2677         .word      LF
      000EB8 CC 03 9E         [ 2] 2678         JP     EMIT
                                   2679 
                                   2680 ;       do$     ( -- a )
                                   2681 ;       Return  address of a compiled
                                   2682 ;       string.
      000EBB 0E A8                 2683         .word      LINK
                           000EBD  2684 LINK = . 
      000EBD 43                    2685 	.byte      COMPO+3
      000EBE 44 4F 24              2686         .ascii     "DO$"
      000EC1                       2687 DOSTR:
      000EC1 CD 04 8D         [ 4] 2688         CALL     RFROM
      000EC4 CD 04 A0         [ 4] 2689         CALL     RAT
      000EC7 CD 04 8D         [ 4] 2690         CALL     RFROM
      000ECA CD 0B 1B         [ 4] 2691         CALL     COUNT
      000ECD CD 06 DE         [ 4] 2692         CALL     PLUS
      000ED0 CD 04 AC         [ 4] 2693         CALL     TOR
      000ED3 CD 04 F3         [ 4] 2694         CALL     SWAPP
      000ED6 CD 04 AC         [ 4] 2695         CALL     TOR
      000ED9 81               [ 4] 2696         RET
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 51.
Hexadecimal [24-Bits]



                                   2697 
                                   2698 ;       $"|     ( -- a )
                                   2699 ;       Run time routine compiled by $".
                                   2700 ;       Return address of a compiled string.
      000EDA 0E BD                 2701         .word      LINK
                           000EDC  2702 LINK = . 
      000EDC 43                    2703 	.byte      COMPO+3
      000EDD 24 22 7C              2704         .byte     '$','"','|'
      000EE0                       2705 STRQP:
      000EE0 CD 0E C1         [ 4] 2706         CALL     DOSTR
      000EE3 81               [ 4] 2707         RET
                                   2708 
                                   2709 ;       ."|     ( -- )
                                   2710 ;       Run time routine of ." .
                                   2711 ;       Output a compiled string.
      000EE4 0E DC                 2712         .word      LINK
                           000EE6  2713 LINK = . 
      000EE6 43                    2714 	.byte      COMPO+3
      000EE7 2E 22 7C              2715         .byte     '.','"','|'
      000EEA                       2716 DOTQP:
      000EEA CD 0E C1         [ 4] 2717         CALL     DOSTR
      000EED CD 0B 1B         [ 4] 2718         CALL     COUNT
      000EF0 CC 0E 8D         [ 2] 2719         JP     TYPES
                                   2720 
                                   2721 ;       .R      ( n +n -- )
                                   2722 ;       Display an integer in a field
                                   2723 ;       of n columns, right justified.
      000EF3 0E E6                 2724         .word      LINK
                           000EF5  2725 LINK = . 
      000EF5 02                    2726         .byte      2
      000EF6 2E 52                 2727         .ascii     ".R"
      000EF8                       2728 DOTR:
      000EF8 CD 04 AC         [ 4] 2729         CALL     TOR
      000EFB CD 0C CD         [ 4] 2730         CALL     STR
      000EFE CD 04 8D         [ 4] 2731         CALL     RFROM
      000F01 CD 05 0D         [ 4] 2732         CALL     OVER
      000F04 CD 07 57         [ 4] 2733         CALL     SUBB
      000F07 CD 0E 72         [ 4] 2734         CALL     SPACS
      000F0A CC 0E 8D         [ 2] 2735         JP     TYPES
                                   2736 
                                   2737 ;       U.R     ( u +n -- )
                                   2738 ;       Display an unsigned integer
                                   2739 ;       in n column, right justified.
      000F0D 0E F5                 2740         .word      LINK
                           000F0F  2741 LINK = . 
      000F0F 03                    2742         .byte      3
      000F10 55 2E 52              2743         .ascii     "U.R"
      000F13                       2744 UDOTR:
      000F13 CD 04 AC         [ 4] 2745         CALL     TOR
      000F16 CD 0C 50         [ 4] 2746         CALL     BDIGS
      000F19 CD 0C 8A         [ 4] 2747         CALL     DIGS
      000F1C CD 0C B5         [ 4] 2748         CALL     EDIGS
      000F1F CD 04 8D         [ 4] 2749         CALL     RFROM
      000F22 CD 05 0D         [ 4] 2750         CALL     OVER
      000F25 CD 07 57         [ 4] 2751         CALL     SUBB
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 52.
Hexadecimal [24-Bits]



      000F28 CD 0E 72         [ 4] 2752         CALL     SPACS
      000F2B CC 0E 8D         [ 2] 2753         JP     TYPES
                                   2754 
                                   2755 ;       U.      ( u -- )
                                   2756 ;       Display an unsigned integer
                                   2757 ;       in free format.
      000F2E 0F 0F                 2758         .word      LINK
                           000F30  2759 LINK = . 
      000F30 02                    2760         .byte      2
      000F31 55 2E                 2761         .ascii     "U."
      000F33                       2762 UDOT:
      000F33 CD 0C 50         [ 4] 2763         CALL     BDIGS
      000F36 CD 0C 8A         [ 4] 2764         CALL     DIGS
      000F39 CD 0C B5         [ 4] 2765         CALL     EDIGS
      000F3C CD 0E 63         [ 4] 2766         CALL     SPACE
      000F3F CC 0E 8D         [ 2] 2767         JP     TYPES
                                   2768 
                                   2769 ;       .       ( w -- )
                                   2770 ;       Display an integer in free
                                   2771 ;       format, preceeded by a space.
      000F42 0F 30                 2772         .word      LINK
                           000F44  2773 LINK = . 
      000F44 01                    2774         .byte      1
      000F45 2E                    2775         .ascii     "."
      000F46                       2776 DOT:
      000F46 CD 05 A0         [ 4] 2777         CALL     BASE
      000F49 CD 04 3C         [ 4] 2778         CALL     AT
      000F4C CD 03 B4         [ 4] 2779         CALL     DOLIT
      000F4F 00 0A                 2780         .word      10
      000F51 CD 05 58         [ 4] 2781         CALL     XORR    ;?decimal
      000F54 CD 03 E7         [ 4] 2782         CALL     QBRAN
      000F57 0F 5C                 2783         .word      DOT1
      000F59 CC 0F 33         [ 2] 2784         JP     UDOT
      000F5C CD 0C CD         [ 4] 2785 DOT1:   CALL     STR
      000F5F CD 0E 63         [ 4] 2786         CALL     SPACE
      000F62 CC 0E 8D         [ 2] 2787         JP     TYPES
                                   2788 
                                   2789 ;       ?       ( a -- )
                                   2790 ;       Display contents in memory cell.
      000F65 0F 44                 2791         .word      LINK
                                   2792         
                           000F67  2793 LINK = . 
      000F67 01                    2794         .byte      1
      000F68 3F                    2795         .ascii     "?"
      000F69                       2796 QUEST:
      000F69 CD 04 3C         [ 4] 2797         CALL     AT
      000F6C CC 0F 46         [ 2] 2798         JP     DOT
                                   2799 
                                   2800 ;; Parsing
                                   2801 
                                   2802 ;       parse   ( b u c -- b u delta ; <string> )
                                   2803 ;       Scan string delimited by c.
                                   2804 ;       Return found string and its offset.
      000F6F 0F 67                 2805         .word      LINK
                           000F71  2806 LINK = . 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 53.
Hexadecimal [24-Bits]



      000F71 05                    2807         .byte      5
      000F72 70 61 72 73 65        2808         .ascii     "parse"
      000F77                       2809 PARS:
      000F77 CD 05 AF         [ 4] 2810         CALL     TEMP
      000F7A CD 04 25         [ 4] 2811         CALL     STORE
      000F7D CD 05 0D         [ 4] 2812         CALL     OVER
      000F80 CD 04 AC         [ 4] 2813         CALL     TOR
      000F83 CD 04 E3         [ 4] 2814         CALL     DUPP
      000F86 CD 03 E7         [ 4] 2815         CALL     QBRAN
      000F89 10 2F                 2816         .word    PARS8
      000F8B CD 09 E5         [ 4] 2817         CALL     ONEM
      000F8E CD 05 AF         [ 4] 2818         CALL     TEMP
      000F91 CD 04 3C         [ 4] 2819         CALL     AT
      000F94 CD 0A 37         [ 4] 2820         CALL     BLANK
      000F97 CD 07 7F         [ 4] 2821         CALL     EQUAL
      000F9A CD 03 E7         [ 4] 2822         CALL     QBRAN
      000F9D 0F D0                 2823         .word      PARS3
      000F9F CD 04 AC         [ 4] 2824         CALL     TOR
      000FA2 CD 0A 37         [ 4] 2825 PARS1:  CALL     BLANK
      000FA5 CD 05 0D         [ 4] 2826         CALL     OVER
      000FA8 CD 04 5A         [ 4] 2827         CALL     CAT     ;skip leading blanks ONLY
      000FAB CD 07 57         [ 4] 2828         CALL     SUBB
      000FAE CD 05 1C         [ 4] 2829         CALL     ZLESS
      000FB1 CD 06 F8         [ 4] 2830         CALL     INVER
      000FB4 CD 03 E7         [ 4] 2831         CALL     QBRAN
      000FB7 0F CD                 2832         .word      PARS2
      000FB9 CD 09 D8         [ 4] 2833         CALL     ONEP
      000FBC CD 03 C8         [ 4] 2834         CALL     DONXT
      000FBF 0F A2                 2835         .word      PARS1
      000FC1 CD 04 8D         [ 4] 2836         CALL     RFROM
      000FC4 CD 04 D9         [ 4] 2837         CALL     DROP
      000FC7 CD 0A 44         [ 4] 2838         CALL     ZERO
      000FCA CC 04 E3         [ 2] 2839         JP     DUPP
      000FCD CD 04 8D         [ 4] 2840 PARS2:  CALL     RFROM
      000FD0 CD 05 0D         [ 4] 2841 PARS3:  CALL     OVER
      000FD3 CD 04 F3         [ 4] 2842         CALL     SWAPP
      000FD6 CD 04 AC         [ 4] 2843         CALL     TOR
      000FD9 CD 05 AF         [ 4] 2844 PARS4:  CALL     TEMP
      000FDC CD 04 3C         [ 4] 2845         CALL     AT
      000FDF CD 05 0D         [ 4] 2846         CALL     OVER
      000FE2 CD 04 5A         [ 4] 2847         CALL     CAT
      000FE5 CD 07 57         [ 4] 2848         CALL     SUBB    ;scan for delimiter
      000FE8 CD 05 AF         [ 4] 2849         CALL     TEMP
      000FEB CD 04 3C         [ 4] 2850         CALL     AT
      000FEE CD 0A 37         [ 4] 2851         CALL     BLANK
      000FF1 CD 07 7F         [ 4] 2852         CALL     EQUAL
      000FF4 CD 03 E7         [ 4] 2853         CALL     QBRAN
      000FF7 0F FC                 2854         .word      PARS5
      000FF9 CD 05 1C         [ 4] 2855         CALL     ZLESS
      000FFC CD 03 E7         [ 4] 2856 PARS5:  CALL     QBRAN
      000FFF 10 11                 2857         .word      PARS6
      001001 CD 09 D8         [ 4] 2858         CALL     ONEP
      001004 CD 03 C8         [ 4] 2859         CALL     DONXT
      001007 0F D9                 2860         .word      PARS4
      001009 CD 04 E3         [ 4] 2861         CALL     DUPP
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 54.
Hexadecimal [24-Bits]



      00100C CD 04 AC         [ 4] 2862         CALL     TOR
      00100F 20 0F            [ 2] 2863         JRA     PARS7
      001011 CD 04 8D         [ 4] 2864 PARS6:  CALL     RFROM
      001014 CD 04 D9         [ 4] 2865         CALL     DROP
      001017 CD 04 E3         [ 4] 2866         CALL     DUPP
      00101A CD 09 D8         [ 4] 2867         CALL     ONEP
      00101D CD 04 AC         [ 4] 2868         CALL     TOR
      001020 CD 05 0D         [ 4] 2869 PARS7:  CALL     OVER
      001023 CD 07 57         [ 4] 2870         CALL     SUBB
      001026 CD 04 8D         [ 4] 2871         CALL     RFROM
      001029 CD 04 8D         [ 4] 2872         CALL     RFROM
      00102C CC 07 57         [ 2] 2873         JP     SUBB
      00102F CD 05 0D         [ 4] 2874 PARS8:  CALL     OVER
      001032 CD 04 8D         [ 4] 2875         CALL     RFROM
      001035 CC 07 57         [ 2] 2876         JP     SUBB
                                   2877 
                                   2878 ;       PARSE   ( c -- b u ; <string> )
                                   2879 ;       Scan input stream and return
                                   2880 ;       counted string delimited by c.
      001038 0F 71                 2881         .word      LINK
                           00103A  2882 LINK = . 
      00103A 05                    2883         .byte      5
      00103B 50 41 52 53 45        2884         .ascii     "PARSE"
      001040                       2885 PARSE:
      001040 CD 04 AC         [ 4] 2886         CALL     TOR
      001043 CD 0B 54         [ 4] 2887         CALL     TIB
      001046 CD 05 BE         [ 4] 2888         CALL     INN
      001049 CD 04 3C         [ 4] 2889         CALL     AT
      00104C CD 06 DE         [ 4] 2890         CALL     PLUS    ;current input buffer pointer
      00104F CD 05 CE         [ 4] 2891         CALL     NTIB
      001052 CD 04 3C         [ 4] 2892         CALL     AT
      001055 CD 05 BE         [ 4] 2893         CALL     INN
      001058 CD 04 3C         [ 4] 2894         CALL     AT
      00105B CD 07 57         [ 4] 2895         CALL     SUBB    ;remaining count
      00105E CD 04 8D         [ 4] 2896         CALL     RFROM
      001061 CD 0F 77         [ 4] 2897         CALL     PARS
      001064 CD 05 BE         [ 4] 2898         CALL     INN
      001067 CC 0A B4         [ 2] 2899         JP     PSTOR
                                   2900 
                                   2901 ;       .(      ( -- )
                                   2902 ;       Output following string up to next ) .
      00106A 10 3A                 2903         .word      LINK
                           00106C  2904 LINK = . 
      00106C 82                    2905 	.byte      IMEDD+2
      00106D 2E 28                 2906         .ascii     ".("
      00106F                       2907 DOTPR:
      00106F CD 03 B4         [ 4] 2908         CALL     DOLIT
      001072 00 29                 2909         .word     41	; ")"
      001074 CD 10 40         [ 4] 2910         CALL     PARSE
      001077 CC 0E 8D         [ 2] 2911         JP     TYPES
                                   2912 
                                   2913 ;       (       ( -- )
                                   2914 ;       Ignore following string up to next ).
                                   2915 ;       A comment.
      00107A 10 6C                 2916         .word      LINK
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 55.
Hexadecimal [24-Bits]



                           00107C  2917 LINK = . 
      00107C 81                    2918 	.byte      IMEDD+1
      00107D 28                    2919         .ascii     "("
      00107E                       2920 PAREN:
      00107E CD 03 B4         [ 4] 2921         CALL     DOLIT
      001081 00 29                 2922         .word     41	; ")"
      001083 CD 10 40         [ 4] 2923         CALL     PARSE
      001086 CC 06 BE         [ 2] 2924         JP     DDROP
                                   2925 
                                   2926 ;       \       ( -- )
                                   2927 ;       Ignore following text till
                                   2928 ;       end of line.
      001089 10 7C                 2929         .word      LINK
                           00108B  2930 LINK = . 
      00108B 81                    2931 	.byte      IMEDD+1
      00108C 5C                    2932         .ascii     "\"
      00108D                       2933 BKSLA:
      00108D 90 AE 00 0C      [ 2] 2934         ldw y,#UCTIB ; #TIB  
      001091 90 FE            [ 2] 2935         ldw y,(y)
      001093 90 89            [ 2] 2936         pushw y ; count in TIB 
      001095 90 AE 00 0A      [ 2] 2937         ldw y,#UINN ; >IN 
      001099 90 BF 24         [ 2] 2938         ldw YTEMP,y
      00109C 90 85            [ 2] 2939         popw y 
      00109E 91 CF 24         [ 5] 2940         ldw [YTEMP],y
      0010A1 81               [ 4] 2941         ret 
                                   2942 
                                   2943 ;       WORD    ( c -- a ; <string> )
                                   2944 ;       Parse a word from input stream
                                   2945 ;       and copy it to code dictionary.
      0010A2 10 8B                 2946         .word      LINK
                           0010A4  2947 LINK = . 
      0010A4 04                    2948         .byte      4
      0010A5 57 4F 52 44           2949         .ascii     "WORD"
      0010A9                       2950 WORDD:
      0010A9 CD 10 40         [ 4] 2951         CALL     PARSE
      0010AC CD 0B 32         [ 4] 2952         CALL     HERE
      0010AF CD 09 AD         [ 4] 2953         CALL     CELLP
      0010B2 CC 0B F3         [ 2] 2954         JP     PACKS
                                   2955 
                                   2956 ;       TOKEN   ( -- a ; <string> )
                                   2957 ;       Parse a word from input stream
                                   2958 ;       and copy it to name dictionary.
      0010B5 10 A4                 2959         .word      LINK
                           0010B7  2960 LINK = . 
      0010B7 05                    2961         .byte      5
      0010B8 54 4F 4B 45 4E        2962         .ascii     "TOKEN"
      0010BD                       2963 TOKEN:
      0010BD CD 0A 37         [ 4] 2964         CALL     BLANK
      0010C0 CC 10 A9         [ 2] 2965         JP     WORDD
                                   2966 
                                   2967 ;; Dictionary search
                                   2968 
                                   2969 ;       NAME>   ( na -- ca )
                                   2970 ;       Return a code address given
                                   2971 ;       a name address.
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 56.
Hexadecimal [24-Bits]



      0010C3 10 B7                 2972         .word      LINK
                           0010C5  2973 LINK = . 
      0010C5 05                    2974         .byte      5
      0010C6 4E 41 4D 45 3E        2975         .ascii     "NAME>"
      0010CB                       2976 NAMET:
      0010CB CD 0B 1B         [ 4] 2977         CALL     COUNT
      0010CE CD 03 B4         [ 4] 2978         CALL     DOLIT
      0010D1 00 1F                 2979         .word      31
      0010D3 CD 05 2F         [ 4] 2980         CALL     ANDD
      0010D6 CC 06 DE         [ 2] 2981         JP     PLUS
                                   2982 
                                   2983 ;       SAME?   ( a a u -- a a f \ -0+ )
                                   2984 ;       Compare u cells in two
                                   2985 ;       strings. Return 0 if identical.
      0010D9 10 C5                 2986         .word      LINK
                           0010DB  2987 LINK = . 
      0010DB 05                    2988         .byte       5
      0010DC 53 41 4D 45 3F        2989         .ascii     "SAME?"
      0010E1                       2990 SAMEQ:
      0010E1 CD 09 E5         [ 4] 2991         CALL     ONEM
      0010E4 CD 04 AC         [ 4] 2992         CALL     TOR
      0010E7 20 29            [ 2] 2993         JRA     SAME2
      0010E9 CD 05 0D         [ 4] 2994 SAME1:  CALL     OVER
      0010EC CD 04 A0         [ 4] 2995         CALL     RAT
      0010EF CD 06 DE         [ 4] 2996         CALL     PLUS
      0010F2 CD 04 5A         [ 4] 2997         CALL     CAT
      0010F5 CD 05 0D         [ 4] 2998         CALL     OVER
      0010F8 CD 04 A0         [ 4] 2999         CALL     RAT
      0010FB CD 06 DE         [ 4] 3000         CALL     PLUS
      0010FE CD 04 5A         [ 4] 3001         CALL     CAT
      001101 CD 07 57         [ 4] 3002         CALL     SUBB
      001104 CD 06 8D         [ 4] 3003         CALL     QDUP
      001107 CD 03 E7         [ 4] 3004         CALL     QBRAN
      00110A 11 12                 3005         .word      SAME2
      00110C CD 04 8D         [ 4] 3006         CALL     RFROM
      00110F CC 04 D9         [ 2] 3007         JP     DROP
      001112 CD 03 C8         [ 4] 3008 SAME2:  CALL     DONXT
      001115 10 E9                 3009         .word      SAME1
      001117 CC 0A 44         [ 2] 3010         JP     ZERO
                                   3011 
                                   3012 ;       find    ( a va -- ca na | a F )
                                   3013 ;       Search vocabulary for string.
                                   3014 ;       Return ca and na if succeeded.
      00111A 10 DB                 3015         .word      LINK
                           00111C  3016 LINK = . 
      00111C 04                    3017         .byte      4
      00111D 46 49 4E 44           3018         .ascii     "FIND"
      001121                       3019 FIND:
      001121 CD 04 F3         [ 4] 3020         CALL     SWAPP
      001124 CD 04 E3         [ 4] 3021         CALL     DUPP
      001127 CD 04 5A         [ 4] 3022         CALL     CAT
      00112A CD 05 AF         [ 4] 3023         CALL     TEMP
      00112D CD 04 25         [ 4] 3024         CALL     STORE
      001130 CD 04 E3         [ 4] 3025         CALL     DUPP
      001133 CD 04 3C         [ 4] 3026         CALL     AT
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 57.
Hexadecimal [24-Bits]



      001136 CD 04 AC         [ 4] 3027         CALL     TOR
      001139 CD 09 AD         [ 4] 3028         CALL     CELLP
      00113C CD 04 F3         [ 4] 3029         CALL     SWAPP
      00113F CD 04 3C         [ 4] 3030 FIND1:  CALL     AT
      001142 CD 04 E3         [ 4] 3031         CALL     DUPP
      001145 CD 03 E7         [ 4] 3032         CALL     QBRAN
      001148 11 7E                 3033         .word      FIND6
      00114A CD 04 E3         [ 4] 3034         CALL     DUPP
      00114D CD 04 3C         [ 4] 3035         CALL     AT
      001150 CD 03 B4         [ 4] 3036         CALL     DOLIT
      001153 1F 7F                 3037         .word      MASKK
      001155 CD 05 2F         [ 4] 3038         CALL     ANDD
      001158 CD 04 A0         [ 4] 3039         CALL     RAT
      00115B CD 05 58         [ 4] 3040         CALL     XORR
      00115E CD 03 E7         [ 4] 3041         CALL     QBRAN
      001161 11 6D                 3042         .word      FIND2
      001163 CD 09 AD         [ 4] 3043         CALL     CELLP
      001166 CD 03 B4         [ 4] 3044         CALL     DOLIT
      001169 FF FF                 3045         .word     0xFFFF
      00116B 20 0C            [ 2] 3046         JRA     FIND3
      00116D CD 09 AD         [ 4] 3047 FIND2:  CALL     CELLP
      001170 CD 05 AF         [ 4] 3048         CALL     TEMP
      001173 CD 04 3C         [ 4] 3049         CALL     AT
      001176 CD 10 E1         [ 4] 3050         CALL     SAMEQ
      001179 CD 03 FE         [ 4] 3051 FIND3:  CALL     BRAN
      00117C 11 8D                 3052         .word      FIND4
      00117E CD 04 8D         [ 4] 3053 FIND6:  CALL     RFROM
      001181 CD 04 D9         [ 4] 3054         CALL     DROP
      001184 CD 04 F3         [ 4] 3055         CALL     SWAPP
      001187 CD 09 BC         [ 4] 3056         CALL     CELLM
      00118A CC 04 F3         [ 2] 3057         JP     SWAPP
      00118D CD 03 E7         [ 4] 3058 FIND4:  CALL     QBRAN
      001190 11 9A                 3059         .word      FIND5
      001192 CD 09 BC         [ 4] 3060         CALL     CELLM
      001195 CD 09 BC         [ 4] 3061         CALL     CELLM
      001198 20 A5            [ 2] 3062         JRA     FIND1
      00119A CD 04 8D         [ 4] 3063 FIND5:  CALL     RFROM
      00119D CD 04 D9         [ 4] 3064         CALL     DROP
      0011A0 CD 04 F3         [ 4] 3065         CALL     SWAPP
      0011A3 CD 04 D9         [ 4] 3066         CALL     DROP
      0011A6 CD 09 BC         [ 4] 3067         CALL     CELLM
      0011A9 CD 04 E3         [ 4] 3068         CALL     DUPP
      0011AC CD 10 CB         [ 4] 3069         CALL     NAMET
      0011AF CC 04 F3         [ 2] 3070         JP     SWAPP
                                   3071 
                                   3072 ;       NAME?   ( a -- ca na | a F )
                                   3073 ;       Search vocabularies for a string.
      0011B2 11 1C                 3074         .word      LINK
                           0011B4  3075 LINK = . 
      0011B4 05                    3076         .byte      5
      0011B5 4E 41 4D 45 3F        3077         .ascii     "NAME?"
      0011BA                       3078 NAMEQ:
      0011BA CD 06 23         [ 4] 3079         CALL   CNTXT
      0011BD CC 11 21         [ 2] 3080         JP     FIND
                                   3081 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 58.
Hexadecimal [24-Bits]



                                   3082 ;; Terminal response
                                   3083 
                                   3084 ;       ^H      ( bot eot cur -- bot eot cur )
                                   3085 ;       Backup cursor by one character.
      0011C0 11 B4                 3086         .word      LINK
                           0011C2  3087 LINK = . 
      0011C2 02                    3088         .byte      2
      0011C3 5E 48                 3089         .ascii     "^H"
      0011C5                       3090 BKSP:
      0011C5 CD 04 AC         [ 4] 3091         CALL     TOR
      0011C8 CD 05 0D         [ 4] 3092         CALL     OVER
      0011CB CD 04 8D         [ 4] 3093         CALL     RFROM
      0011CE CD 04 F3         [ 4] 3094         CALL     SWAPP
      0011D1 CD 05 0D         [ 4] 3095         CALL     OVER
      0011D4 CD 05 58         [ 4] 3096         CALL     XORR
      0011D7 CD 03 E7         [ 4] 3097         CALL     QBRAN
      0011DA 11 F5                 3098         .word      BACK1
      0011DC CD 03 B4         [ 4] 3099         CALL     DOLIT
      0011DF 00 08                 3100         .word      BKSPP
      0011E1 CD 03 9E         [ 4] 3101         CALL     EMIT
      0011E4 CD 09 E5         [ 4] 3102         CALL     ONEM
      0011E7 CD 0A 37         [ 4] 3103         CALL     BLANK
      0011EA CD 03 9E         [ 4] 3104         CALL     EMIT
      0011ED CD 03 B4         [ 4] 3105         CALL     DOLIT
      0011F0 00 08                 3106         .word      BKSPP
      0011F2 CC 03 9E         [ 2] 3107         JP     EMIT
      0011F5 81               [ 4] 3108 BACK1:  RET
                                   3109 
                                   3110 ;       TAP    ( bot eot cur c -- bot eot cur )
                                   3111 ;       Accept and echo key stroke
                                   3112 ;       and bump cursor.
      0011F6 11 C2                 3113         .word      LINK
                           0011F8  3114 LINK = . 
      0011F8 03                    3115         .byte      3
      0011F9 54 41 50              3116         .ascii     "TAP"
      0011FC                       3117 TAP:
      0011FC CD 04 E3         [ 4] 3118         CALL     DUPP
      0011FF CD 03 9E         [ 4] 3119         CALL     EMIT
      001202 CD 05 0D         [ 4] 3120         CALL     OVER
      001205 CD 04 49         [ 4] 3121         CALL     CSTOR
      001208 CC 09 D8         [ 2] 3122         JP     ONEP
                                   3123 
                                   3124 ;       kTAP    ( bot eot cur c -- bot eot cur )
                                   3125 ;       Process a key stroke,
                                   3126 ;       CR or backspace.
      00120B 11 F8                 3127         .word      LINK
                           00120D  3128 LINK = . 
      00120D 04                    3129         .byte      4
      00120E 4B 54 41 50           3130         .ascii     "KTAP"
      001212                       3131 KTAP:
      001212 CD 04 E3         [ 4] 3132         CALL     DUPP
      001215 CD 03 B4         [ 4] 3133         CALL     DOLIT
      001218 00 0D                 3134         .word      CRR
      00121A CD 05 58         [ 4] 3135         CALL     XORR
      00121D CD 03 E7         [ 4] 3136         CALL     QBRAN
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 59.
Hexadecimal [24-Bits]



      001220 12 38                 3137         .word      KTAP2
      001222 CD 03 B4         [ 4] 3138         CALL     DOLIT
      001225 00 08                 3139         .word      BKSPP
      001227 CD 05 58         [ 4] 3140         CALL     XORR
      00122A CD 03 E7         [ 4] 3141         CALL     QBRAN
      00122D 12 35                 3142         .word      KTAP1
      00122F CD 0A 37         [ 4] 3143         CALL     BLANK
      001232 CC 11 FC         [ 2] 3144         JP     TAP
      001235 CC 11 C5         [ 2] 3145 KTAP1:  JP     BKSP
      001238 CD 04 D9         [ 4] 3146 KTAP2:  CALL     DROP
      00123B CD 04 F3         [ 4] 3147         CALL     SWAPP
      00123E CD 04 D9         [ 4] 3148         CALL     DROP
      001241 CC 04 E3         [ 2] 3149         JP     DUPP
                                   3150 
                                   3151 ;       accept  ( b u -- b u )
                                   3152 ;       Accept characters to input
                                   3153 ;       buffer. Return with actual count.
      001244 12 0D                 3154         .word      LINK
                           001246  3155 LINK = . 
      001246 06                    3156         .byte      6
      001247 41 43 43 45 50 54     3157         .ascii     "ACCEPT"
      00124D                       3158 ACCEP:
      00124D CD 05 0D         [ 4] 3159         CALL     OVER
      001250 CD 06 DE         [ 4] 3160         CALL     PLUS
      001253 CD 05 0D         [ 4] 3161         CALL     OVER
      001256 CD 06 C9         [ 4] 3162 ACCP1:  CALL     DDUP
      001259 CD 05 58         [ 4] 3163         CALL     XORR
      00125C CD 03 E7         [ 4] 3164         CALL     QBRAN
      00125F 12 81                 3165         .word      ACCP4
      001261 CD 0E 2B         [ 4] 3166         CALL     KEY
      001264 CD 04 E3         [ 4] 3167         CALL     DUPP
      001267 CD 0A 37         [ 4] 3168         CALL     BLANK
      00126A CD 03 B4         [ 4] 3169         CALL     DOLIT
      00126D 00 7F                 3170         .word      127
      00126F CD 08 19         [ 4] 3171         CALL     WITHI
      001272 CD 03 E7         [ 4] 3172         CALL     QBRAN
      001275 12 7C                 3173         .word      ACCP2
      001277 CD 11 FC         [ 4] 3174         CALL     TAP
      00127A 20 03            [ 2] 3175         JRA     ACCP3
      00127C CD 12 12         [ 4] 3176 ACCP2:  CALL     KTAP
      00127F 20 D5            [ 2] 3177 ACCP3:  JRA     ACCP1
      001281 CD 04 D9         [ 4] 3178 ACCP4:  CALL     DROP
      001284 CD 05 0D         [ 4] 3179         CALL     OVER
      001287 CC 07 57         [ 2] 3180         JP     SUBB
                                   3181 
                                   3182 ;       QUERY   ( -- )
                                   3183 ;       Accept input stream to
                                   3184 ;       terminal input buffer.
      00128A 12 46                 3185         .word      LINK
                                   3186         
                           00128C  3187 LINK = . 
      00128C 05                    3188         .byte      5
      00128D 51 55 45 52 59        3189         .ascii     "QUERY"
      001292                       3190 QUERY:
      001292 CD 0B 54         [ 4] 3191         CALL     TIB
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 60.
Hexadecimal [24-Bits]



      001295 CD 03 B4         [ 4] 3192         CALL     DOLIT
      001298 00 50                 3193         .word      80
      00129A CD 12 4D         [ 4] 3194         CALL     ACCEP
      00129D CD 05 CE         [ 4] 3195         CALL     NTIB
      0012A0 CD 04 25         [ 4] 3196         CALL     STORE
      0012A3 CD 04 D9         [ 4] 3197         CALL     DROP
      0012A6 CD 0A 44         [ 4] 3198         CALL     ZERO
      0012A9 CD 05 BE         [ 4] 3199         CALL     INN
      0012AC CC 04 25         [ 2] 3200         JP     STORE
                                   3201 
                                   3202 ;       ABORT   ( -- )
                                   3203 ;       Reset data stack and
                                   3204 ;       jump to QUIT.
      0012AF 12 8C                 3205         .word      LINK
                           0012B1  3206 LINK = . 
      0012B1 05                    3207         .byte      5
      0012B2 41 42 4F 52 54        3208         .ascii     "ABORT"
      0012B7                       3209 ABORT:
      0012B7 CD 13 AE         [ 4] 3210         CALL     PRESE
      0012BA CC 13 CB         [ 2] 3211         JP     QUIT
                                   3212 
                                   3213 ;       abort"  ( f -- )
                                   3214 ;       Run time routine of ABORT".
                                   3215 ;       Abort with a message.
      0012BD 12 B1                 3216         .word      LINK
                           0012BF  3217 LINK = . 
      0012BF 46                    3218 	.byte      COMPO+6
      0012C0 41 42 4F 52 54        3219         .ascii     "ABORT"
      0012C5 22                    3220         .byte      '"'
      0012C6                       3221 ABORQ:
      0012C6 CD 03 E7         [ 4] 3222         CALL     QBRAN
      0012C9 12 E5                 3223         .word      ABOR2   ;text flag
      0012CB CD 0E C1         [ 4] 3224         CALL     DOSTR
      0012CE CD 0E 63         [ 4] 3225 ABOR1:  CALL     SPACE
      0012D1 CD 0B 1B         [ 4] 3226         CALL     COUNT
      0012D4 CD 0E 8D         [ 4] 3227         CALL     TYPES
      0012D7 CD 03 B4         [ 4] 3228         CALL     DOLIT
      0012DA 00 3F                 3229         .word     63 ; "?"
      0012DC CD 03 9E         [ 4] 3230         CALL     EMIT
      0012DF CD 0E AB         [ 4] 3231         CALL     CR
      0012E2 CC 12 B7         [ 2] 3232         JP     ABORT   ;pass error string
      0012E5 CD 0E C1         [ 4] 3233 ABOR2:  CALL     DOSTR
      0012E8 CC 04 D9         [ 2] 3234         JP     DROP
                                   3235 
                                   3236 ;; The text interpreter
                                   3237 
                                   3238 ;       $INTERPRET      ( a -- )
                                   3239 ;       Interpret a word. If failed,
                                   3240 ;       try to convert it to an integer.
      0012EB 12 BF                 3241         .word      LINK
                           0012ED  3242 LINK = . 
      0012ED 0A                    3243         .byte      10
      0012EE 24 49 4E 54 45 52 50  3244         .ascii     "$INTERPRET"
             52 45 54
      0012F8                       3245 INTER:
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 61.
Hexadecimal [24-Bits]



      0012F8 CD 11 BA         [ 4] 3246         CALL     NAMEQ
      0012FB CD 06 8D         [ 4] 3247         CALL     QDUP    ;?defined
      0012FE CD 03 E7         [ 4] 3248         CALL     QBRAN
      001301 13 22                 3249         .word      INTE1
      001303 CD 04 3C         [ 4] 3250         CALL     AT
      001306 CD 03 B4         [ 4] 3251         CALL     DOLIT
      001309 40 00                 3252 	.word       0x4000	; COMPO*256
      00130B CD 05 2F         [ 4] 3253         CALL     ANDD    ;?compile only lexicon bits
      00130E CD 12 C6         [ 4] 3254         CALL     ABORQ
      001311 0D                    3255         .byte      13
      001312 20 63 6F 6D 70 69 6C  3256         .ascii     " compile only"
             65 20 6F 6E 6C 79
      00131F CC 04 0E         [ 2] 3257         JP     EXECU
      001322 CD 0D 58         [ 4] 3258 INTE1:  CALL     NUMBQ   ;convert a number
      001325 CD 03 E7         [ 4] 3259         CALL     QBRAN
      001328 12 CE                 3260         .word    ABOR1
      00132A 81               [ 4] 3261         RET
                                   3262 
                                   3263 ;       [       ( -- )
                                   3264 ;       Start  text interpreter.
      00132B 12 ED                 3265         .word      LINK
                           00132D  3266 LINK = . 
      00132D 81                    3267 	.byte      IMEDD+1
      00132E 5B                    3268         .ascii     "["
      00132F                       3269 LBRAC:
      00132F CD 03 B4         [ 4] 3270         CALL   DOLIT
      001332 12 F8                 3271         .word  INTER
      001334 CD 06 01         [ 4] 3272         CALL   TEVAL
      001337 CC 04 25         [ 2] 3273         JP     STORE
                                   3274 
                                   3275 ;       .OK     ( -- )
                                   3276 ;       Display 'ok' while interpreting.
      00133A 13 2D                 3277         .word      LINK
                           00133C  3278 LINK = . 
      00133C 03                    3279         .byte      3
      00133D 2E 4F 4B              3280         .ascii     ".OK"
      001340                       3281 DOTOK:
      001340 CD 03 B4         [ 4] 3282         CALL     DOLIT
      001343 12 F8                 3283         .word      INTER
      001345 CD 06 01         [ 4] 3284         CALL     TEVAL
      001348 CD 04 3C         [ 4] 3285         CALL     AT
      00134B CD 07 7F         [ 4] 3286         CALL     EQUAL
      00134E CD 03 E7         [ 4] 3287         CALL     QBRAN
      001351 13 5A                 3288         .word      DOTO1
      001353 CD 0E EA         [ 4] 3289         CALL     DOTQP
      001356 03                    3290         .byte      3
      001357 20 6F 6B              3291         .ascii     " ok"
      00135A CC 0E AB         [ 2] 3292 DOTO1:  JP     CR
                                   3293 
                                   3294 ;       ?STACK  ( -- )
                                   3295 ;       Abort if stack underflows.
      00135D 13 3C                 3296         .word      LINK
                           00135F  3297 LINK = . 
      00135F 06                    3298         .byte      6
      001360 3F 53 54 41 43 4B     3299         .ascii     "?STACK"
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 62.
Hexadecimal [24-Bits]



      001366                       3300 QSTAC: 
      001366 CD 0A 86         [ 4] 3301         CALL     DEPTH
      001369 CD 05 1C         [ 4] 3302         CALL     ZLESS   ;check only for underflow
      00136C CD 12 C6         [ 4] 3303         CALL     ABORQ
      00136F 0B                    3304         .byte      11
      001370 20 75 6E 64 65 72 66  3305         .ascii     " underflow "
             6C 6F 77 20
      00137B 81               [ 4] 3306         RET
                                   3307 
                                   3308 ;       EVAL    ( -- )
                                   3309 ;       Interpret  input stream.
      00137C 13 5F                 3310         .word      LINK
                           00137E  3311 LINK = . 
      00137E 04                    3312         .byte      4
      00137F 45 56 41 4C           3313         .ascii     "EVAL"
      001383                       3314 EVAL:
      001383 CD 10 BD         [ 4] 3315 EVAL1:  CALL     TOKEN
      001386 CD 04 E3         [ 4] 3316         CALL     DUPP
      001389 CD 04 5A         [ 4] 3317         CALL     CAT     ;?input stream empty
      00138C CD 03 E7         [ 4] 3318         CALL     QBRAN
      00138F 13 9F                 3319         .word    EVAL2
      001391 CD 06 01         [ 4] 3320         CALL     TEVAL
      001394 CD 0B 68         [ 4] 3321         CALL     ATEXE
      001397 CD 13 66         [ 4] 3322         CALL     QSTAC   ;evaluate input, check stack
      00139A CD 03 FE         [ 4] 3323         CALL     BRAN
      00139D 13 83                 3324         .word    EVAL1
      00139F CD 04 D9         [ 4] 3325 EVAL2:  CALL     DROP
      0013A2 CC 13 40         [ 2] 3326         JP       DOTOK
                                   3327 
                                   3328 ;       PRESET  ( -- )
                                   3329 ;       Reset data stack pointer and
                                   3330 ;       terminal input buffer.
      0013A5 13 7E                 3331         .word      LINK
                           0013A7  3332 LINK = . 
      0013A7 06                    3333         .byte      6
      0013A8 50 52 45 53 45 54     3334         .ascii     "PRESET"
      0013AE                       3335 PRESE:
      0013AE CD 03 B4         [ 4] 3336         CALL     DOLIT
      0013B1 16 80                 3337         .word      SPP
      0013B3 CD 04 D0         [ 4] 3338         CALL     SPSTO
      0013B6 CD 03 B4         [ 4] 3339         CALL     DOLIT
      0013B9 17 00                 3340         .word      TIBB
      0013BB CD 05 CE         [ 4] 3341         CALL     NTIB
      0013BE CD 09 AD         [ 4] 3342         CALL     CELLP
      0013C1 CC 04 25         [ 2] 3343         JP     STORE
                                   3344 
                                   3345 ;       QUIT    ( -- )
                                   3346 ;       Reset return stack pointer
                                   3347 ;       and start text interpreter.
      0013C4 13 A7                 3348         .word      LINK
                           0013C6  3349 LINK = . 
      0013C6 04                    3350         .byte      4
      0013C7 51 55 49 54           3351         .ascii     "QUIT"
      0013CB                       3352 QUIT:
      0013CB CD 03 B4         [ 4] 3353         CALL     DOLIT
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 63.
Hexadecimal [24-Bits]



      0013CE 17 FF                 3354         .word      RPP
      0013D0 CD 04 77         [ 4] 3355         CALL     RPSTO   ;reset return stack pointer
      0013D3 CD 13 2F         [ 4] 3356 QUIT1:  CALL     LBRAC   ;start interpretation
      0013D6 CD 12 92         [ 4] 3357 QUIT2:  CALL     QUERY   ;get input
      0013D9 CD 13 83         [ 4] 3358         CALL     EVAL
      0013DC 20 F8            [ 2] 3359         JRA     QUIT2   ;continue till error
                                   3360 
                                   3361 ;; The compiler
                                   3362 
                                   3363 ;       '       ( -- ca )
                                   3364 ;       Search vocabularies for
                                   3365 ;       next word in input stream.
      0013DE 13 C6                 3366         .word      LINK
                           0013E0  3367 LINK = . 
      0013E0 01                    3368         .byte      1
      0013E1 27                    3369         .ascii     "'"
      0013E2                       3370 TICK:
      0013E2 CD 10 BD         [ 4] 3371         CALL     TOKEN
      0013E5 CD 11 BA         [ 4] 3372         CALL     NAMEQ   ;?defined
      0013E8 CD 03 E7         [ 4] 3373         CALL     QBRAN
      0013EB 12 CE                 3374         .word      ABOR1
      0013ED 81               [ 4] 3375         RET     ;yes, push code address
                                   3376 
                                   3377 ;       ALLOT   ( n -- )
                                   3378 ;       Allocate n bytes to RAM 
      0013EE 13 E0                 3379         .word      LINK
                           0013F0  3380         LINK = . 
      0013F0 05                    3381         .byte      5
      0013F1 41 4C 4C 4F 54        3382         .ascii     "ALLOT"
      0013F6                       3383 ALLOT:
      0013F6 CD 06 31         [ 4] 3384         CALL     VPP
                                   3385 ; must update APP_VP each time VP is modidied
      0013F9 CD 0A B4         [ 4] 3386         call PSTOR 
      0013FC CC 1B D8         [ 2] 3387         jp UPDATVP 
                                   3388 
                                   3389 ;       ,       ( w -- )
                                   3390 ;         Compile an integer into
                                   3391 ;         variable space.
      0013FF 13 F0                 3392         .word      LINK
                           001401  3393 LINK = . 
      001401 01                    3394         .byte      1
      001402 2C                    3395         .ascii     ","
      001403                       3396 COMMA:
      001403 CD 0B 32         [ 4] 3397         CALL     HERE
      001406 CD 04 E3         [ 4] 3398         CALL     DUPP
      001409 CD 09 AD         [ 4] 3399         CALL     CELLP   ;cell boundary
      00140C CD 06 31         [ 4] 3400         CALL     VPP
      00140F CD 04 25         [ 4] 3401         CALL     STORE
      001412 CC 04 25         [ 2] 3402         JP     STORE
                                   3403 
                                   3404 ;       C,      ( c -- )
                                   3405 ;       Compile a byte into
                                   3406 ;       variables space.
      001415 14 01                 3407        .word      LINK
                           001417  3408 LINK = . 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 64.
Hexadecimal [24-Bits]



      001417 02                    3409         .byte      2
      001418 43 2C                 3410         .ascii     "C,"
      00141A                       3411 CCOMMA:
      00141A CD 0B 32         [ 4] 3412         CALL     HERE
      00141D CD 04 E3         [ 4] 3413         CALL     DUPP
      001420 CD 09 D8         [ 4] 3414         CALL     ONEP
      001423 CD 06 31         [ 4] 3415         CALL     VPP
      001426 CD 04 25         [ 4] 3416         CALL     STORE
      001429 CC 04 49         [ 2] 3417         JP     CSTOR
                                   3418 
                                   3419 ;       [COMPILE]       ( -- ; <string> )
                                   3420 ;       Compile next immediate
                                   3421 ;       word into code dictionary.
      00142C 14 17                 3422         .word      LINK
                           00142E  3423 LINK = . 
      00142E 89                    3424 	.byte      IMEDD+9
      00142F 5B 43 4F 4D 50 49 4C  3425         .ascii     "[COMPILE]"
             45 5D
      001438                       3426 BCOMP:
      001438 CD 13 E2         [ 4] 3427         CALL     TICK
      00143B CC 16 FE         [ 2] 3428         JP     JSRC
                                   3429 
                                   3430 ;       COMPILE ( -- )
                                   3431 ;       Compile next jsr in
                                   3432 ;       colon list to code dictionary.
      00143E 14 2E                 3433         .word      LINK
                           001440  3434 LINK = . 
      001440 47                    3435 	.byte      COMPO+7
      001441 43 4F 4D 50 49 4C 45  3436         .ascii     "COMPILE"
      001448                       3437 COMPI:
      001448 CD 04 8D         [ 4] 3438         CALL     RFROM
      00144B CD 04 E3         [ 4] 3439         CALL     DUPP
      00144E CD 04 3C         [ 4] 3440         CALL     AT
      001451 CD 16 FE         [ 4] 3441         CALL     JSRC    ;compile subroutine
      001454 CD 09 AD         [ 4] 3442         CALL     CELLP
      001457 90 93            [ 1] 3443         ldw y,x 
      001459 90 FE            [ 2] 3444         ldw y,(y)
      00145B 1C 00 02         [ 2] 3445         addw x,#CELLL 
      00145E 90 FC            [ 2] 3446         jp (y)
                                   3447 
                                   3448 ;       LITERAL ( w -- )
                                   3449 ;       Compile tos to dictionary
                                   3450 ;       as an integer literal.
      001460 14 40                 3451         .word      LINK
                           001462  3452 LINK = . 
      001462 87                    3453 	.byte      IMEDD+7
      001463 4C 49 54 45 52 41 4C  3454         .ascii     "LITERAL"
      00146A                       3455 LITER:
      00146A CD 14 48         [ 4] 3456         CALL     COMPI
      00146D 03 B4                 3457         .word DOLIT 
      00146F CC 14 03         [ 2] 3458         JP     COMMA
                                   3459 
                                   3460 ;       $,"     ( -- )
                                   3461 ;       Compile a literal string
                                   3462 ;       up to next " .
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 65.
Hexadecimal [24-Bits]



      001472 14 62                 3463         .word      LINK
                           001474  3464 LINK = . 
      001474 03                    3465         .byte      3
      001475 24 2C 22              3466         .byte     '$',',','"'
      001478                       3467 STRCQ:
      001478 CD 03 B4         [ 4] 3468         CALL     DOLIT
      00147B 00 22                 3469         .word     34	; "
      00147D CD 10 40         [ 4] 3470         CALL     PARSE
      001480 CD 0B 32         [ 4] 3471         CALL     HERE
      001483 CD 0B F3         [ 4] 3472         CALL     PACKS   ;string to code dictionary
      001486 CD 0B 1B         [ 4] 3473         CALL     COUNT
      001489 CD 06 DE         [ 4] 3474         CALL     PLUS    ;calculate aligned end of string
      00148C CD 06 31         [ 4] 3475         CALL     VPP
      00148F CC 04 25         [ 2] 3476         JP     STORE
                                   3477 
                                   3478 ;; Structures
                                   3479 
                                   3480 ;       FOR     ( -- a )
                                   3481 ;       Start a FOR-NEXT loop
                                   3482 ;       structure in a colon definition.
      001492 14 74                 3483         .word      LINK
                           001494  3484 LINK = . 
      001494 83                    3485 	.byte      IMEDD+3
      001495 46 4F 52              3486         .ascii     "FOR"
      001498                       3487 FOR:
      001498 CD 14 48         [ 4] 3488         CALL     COMPI
      00149B 04 AC                 3489         .word TOR 
      00149D CC 0B 32         [ 2] 3490         JP     HERE
                                   3491 
                                   3492 ;       NEXT    ( a -- )
                                   3493 ;       Terminate a FOR-NEXT loop.
      0014A0 14 94                 3494         .word      LINK
                           0014A2  3495 LINK = . 
      0014A2 84                    3496 	.byte      IMEDD+4
      0014A3 4E 45 58 54           3497         .ascii     "NEXT"
      0014A7                       3498 NEXT:
      0014A7 CD 14 48         [ 4] 3499         CALL     COMPI
      0014AA 03 C8                 3500         .word DONXT 
      0014AC CD 06 7D         [ 4] 3501         call ADRADJ
      0014AF CC 14 03         [ 2] 3502         JP     COMMA
                                   3503 
                                   3504 ;       I ( -- n )
                                   3505 ;       stack FOR-NEXT COUNTER 
      0014B2 14 A2                 3506         .word LINK 
                           0014B4  3507         LINK=.
      0014B4 01                    3508         .byte 1 
      0014B5 49                    3509         .ascii "I"
      0014B6                       3510 IFETCH: 
      0014B6 1D 00 02         [ 2] 3511         subw x,#CELLL 
      0014B9 16 03            [ 2] 3512         ldw y,(3,sp)
      0014BB FF               [ 2] 3513         ldw (x),y 
      0014BC 81               [ 4] 3514         ret 
                                   3515 
                                   3516 ;       BEGIN   ( -- a )
                                   3517 ;       Start an infinite or
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 66.
Hexadecimal [24-Bits]



                                   3518 ;       indefinite loop structure.
      0014BD 14 B4                 3519         .word      LINK
                           0014BF  3520 LINK = . 
      0014BF 85                    3521 	.byte      IMEDD+5
      0014C0 42 45 47 49 4E        3522         .ascii     "BEGIN"
      0014C5                       3523 BEGIN:
      0014C5 CC 0B 32         [ 2] 3524         JP     HERE
                                   3525 
                                   3526 ;       UNTIL   ( a -- )
                                   3527 ;       Terminate a BEGIN-UNTIL
                                   3528 ;       indefinite loop structure.
      0014C8 14 BF                 3529         .word      LINK
                           0014CA  3530 LINK = . 
      0014CA 85                    3531 	.byte      IMEDD+5
      0014CB 55 4E 54 49 4C        3532         .ascii     "UNTIL"
      0014D0                       3533 UNTIL:
      0014D0 CD 14 48         [ 4] 3534         CALL     COMPI
      0014D3 03 E7                 3535         .word    QBRAN 
      0014D5 CD 06 7D         [ 4] 3536         call ADRADJ
      0014D8 CC 14 03         [ 2] 3537         JP     COMMA
                                   3538 
                                   3539 ;       AGAIN   ( a -- )
                                   3540 ;       Terminate a BEGIN-AGAIN
                                   3541 ;       infinite loop structure.
      0014DB 14 CA                 3542         .word      LINK
                           0014DD  3543 LINK = . 
      0014DD 85                    3544 	.byte      IMEDD+5
      0014DE 41 47 41 49 4E        3545         .ascii     "AGAIN"
      0014E3                       3546 AGAIN:
      0014E3 CD 14 48         [ 4] 3547         CALL     COMPI
      0014E6 03 FE                 3548         .word BRAN
      0014E8 CD 06 7D         [ 4] 3549         call ADRADJ 
      0014EB CC 14 03         [ 2] 3550         JP     COMMA
                                   3551 
                                   3552 ;       IF      ( -- A )
                                   3553 ;       Begin a conditional branch.
      0014EE 14 DD                 3554         .word      LINK
                           0014F0  3555 LINK = . 
      0014F0 82                    3556 	.byte      IMEDD+2
      0014F1 49 46                 3557         .ascii     "IF"
      0014F3                       3558 IFF:
      0014F3 CD 14 48         [ 4] 3559         CALL     COMPI
      0014F6 03 E7                 3560         .word QBRAN
      0014F8 CD 0B 32         [ 4] 3561         CALL     HERE
      0014FB CD 0A 44         [ 4] 3562         CALL     ZERO
      0014FE CC 14 03         [ 2] 3563         JP     COMMA
                                   3564 
                                   3565 ;       THEN        ( A -- )
                                   3566 ;       Terminate a conditional branch structure.
      001501 14 F0                 3567         .word      LINK
                           001503  3568 LINK = . 
      001503 84                    3569 	.byte      IMEDD+4
      001504 54 48 45 4E           3570         .ascii     "THEN"
      001508                       3571 THENN:
      001508 CD 0B 32         [ 4] 3572         CALL     HERE
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 67.
Hexadecimal [24-Bits]



      00150B CD 06 7D         [ 4] 3573         call ADRADJ 
      00150E CD 04 F3         [ 4] 3574         CALL     SWAPP
      001511 CC 04 25         [ 2] 3575         JP     STORE
                                   3576 
                                   3577 ;       ELSE        ( A -- A )
                                   3578 ;       Start the false clause in an IF-ELSE-THEN structure.
      001514 15 03                 3579         .word      LINK
                           001516  3580 LINK = . 
      001516 84                    3581 	.byte      IMEDD+4
      001517 45 4C 53 45           3582         .ascii     "ELSE"
      00151B                       3583 ELSEE:
      00151B CD 14 48         [ 4] 3584         CALL     COMPI
      00151E 03 FE                 3585         .word BRAN
      001520 CD 0B 32         [ 4] 3586         CALL     HERE
      001523 CD 0A 44         [ 4] 3587         CALL     ZERO
      001526 CD 14 03         [ 4] 3588         CALL     COMMA
      001529 CD 04 F3         [ 4] 3589         CALL     SWAPP
      00152C CD 0B 32         [ 4] 3590         CALL     HERE
      00152F CD 06 7D         [ 4] 3591         call ADRADJ 
      001532 CD 04 F3         [ 4] 3592         CALL     SWAPP
      001535 CC 04 25         [ 2] 3593         JP     STORE
                                   3594 
                                   3595 ;       AHEAD       ( -- A )
                                   3596 ;       Compile a forward branch instruction.
      001538 15 16                 3597         .word      LINK
                           00153A  3598 LINK = . 
      00153A 85                    3599 	.byte      IMEDD+5
      00153B 41 48 45 41 44        3600         .ascii     "AHEAD"
      001540                       3601 AHEAD:
      001540 CD 14 48         [ 4] 3602         CALL     COMPI
      001543 03 FE                 3603         .word BRAN
      001545 CD 0B 32         [ 4] 3604         CALL     HERE
      001548 CD 0A 44         [ 4] 3605         CALL     ZERO
      00154B CC 14 03         [ 2] 3606         JP     COMMA
                                   3607 
                                   3608 ;       WHILE       ( a -- A a )
                                   3609 ;       Conditional branch out of a BEGIN-WHILE-REPEAT loop.
      00154E 15 3A                 3610         .word      LINK
                           001550  3611 LINK = . 
      001550 85                    3612 	.byte      IMEDD+5
      001551 57 48 49 4C 45        3613         .ascii     "WHILE"
      001556                       3614 WHILE:
      001556 CD 14 48         [ 4] 3615         CALL     COMPI
      001559 03 E7                 3616         .word QBRAN
      00155B CD 0B 32         [ 4] 3617         CALL     HERE
      00155E CD 0A 44         [ 4] 3618         CALL     ZERO
      001561 CD 14 03         [ 4] 3619         CALL     COMMA
      001564 CC 04 F3         [ 2] 3620         JP     SWAPP
                                   3621 
                                   3622 ;       REPEAT      ( A a -- )
                                   3623 ;       Terminate a BEGIN-WHILE-REPEAT indefinite loop.
      001567 15 50                 3624         .word      LINK
                           001569  3625 LINK = . 
      001569 86                    3626         .byte      IMEDD+6
      00156A 52 45 50 45 41 54     3627         .ascii     "REPEAT"
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 68.
Hexadecimal [24-Bits]



      001570                       3628 REPEA:
      001570 CD 14 48         [ 4] 3629         CALL     COMPI
      001573 03 FE                 3630         .word BRAN
      001575 CD 06 7D         [ 4] 3631         call ADRADJ 
      001578 CD 14 03         [ 4] 3632         CALL     COMMA
      00157B CD 0B 32         [ 4] 3633         CALL     HERE
      00157E CD 06 7D         [ 4] 3634         call ADRADJ 
      001581 CD 04 F3         [ 4] 3635         CALL     SWAPP
      001584 CC 04 25         [ 2] 3636         JP     STORE
                                   3637 
                                   3638 ;       AFT         ( a -- a A )
                                   3639 ;       Jump to THEN in a FOR-AFT-THEN-NEXT loop the first time through.
      001587 15 69                 3640         .word      LINK
                           001589  3641 LINK = . 
      001589 83                    3642 	.byte      IMEDD+3
      00158A 41 46 54              3643         .ascii     "AFT"
      00158D                       3644 AFT:
      00158D CD 04 D9         [ 4] 3645         CALL     DROP
      001590 CD 15 40         [ 4] 3646         CALL     AHEAD
      001593 CD 0B 32         [ 4] 3647         CALL     HERE
      001596 CC 04 F3         [ 2] 3648         JP     SWAPP
                                   3649 
                                   3650 ;       ABORT"      ( -- ; <string> )
                                   3651 ;       Conditional abort with an error message.
      001599 15 89                 3652         .word      LINK
                           00159B  3653 LINK = . 
      00159B 86                    3654 	.byte      IMEDD+6
      00159C 41 42 4F 52 54        3655         .ascii     "ABORT"
      0015A1 22                    3656         .byte      '"'
      0015A2                       3657 ABRTQ:
      0015A2 CD 14 48         [ 4] 3658         CALL     COMPI
      0015A5 12 C6                 3659         .word ABORQ
      0015A7 CC 14 78         [ 2] 3660         JP     STRCQ
                                   3661 
                                   3662 ;       $"     ( -- ; <string> )
                                   3663 ;       Compile an inline string literal.
      0015AA 15 9B                 3664         .word      LINK
                           0015AC  3665 LINK = . 
      0015AC 82                    3666 	.byte      IMEDD+2
      0015AD 24 22                 3667         .byte     '$','"'
      0015AF                       3668 STRQ:
      0015AF CD 14 48         [ 4] 3669         CALL     COMPI
      0015B2 0E E0                 3670         .word STRQP 
      0015B4 CC 14 78         [ 2] 3671         JP     STRCQ
                                   3672 
                                   3673 ;       ."          ( -- ; <string> )
                                   3674 ;       Compile an inline string literal to be typed out at run time.
      0015B7 15 AC                 3675         .word      LINK
                           0015B9  3676 LINK = . 
      0015B9 82                    3677 	.byte      IMEDD+2
      0015BA 2E 22                 3678         .byte     '.','"'
      0015BC                       3679 DOTQ:
      0015BC CD 14 48         [ 4] 3680         CALL     COMPI
      0015BF 0E EA                 3681         .word DOTQP 
      0015C1 CC 14 78         [ 2] 3682         JP     STRCQ
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 69.
Hexadecimal [24-Bits]



                                   3683 
                                   3684 ;; Name compiler
                                   3685 
                                   3686 ;       ?UNIQUE ( a -- a )
                                   3687 ;       Display a warning message
                                   3688 ;       if word already exists.
      0015C4 15 B9                 3689         .word      LINK
                           0015C6  3690 LINK = . 
      0015C6 07                    3691         .byte      7
      0015C7 3F 55 4E 49 51 55 45  3692         .ascii     "?UNIQUE"
      0015CE                       3693 UNIQU:
      0015CE CD 04 E3         [ 4] 3694         CALL     DUPP
      0015D1 CD 11 BA         [ 4] 3695         CALL     NAMEQ   ;?name exists
      0015D4 CD 03 E7         [ 4] 3696         CALL     QBRAN
      0015D7 15 ED                 3697         .word      UNIQ1
      0015D9 CD 0E EA         [ 4] 3698         CALL     DOTQP   ;redef are OK
      0015DC 07                    3699         .byte       7
      0015DD 20 72 65 44 65 66 20  3700         .ascii     " reDef "       
      0015E4 CD 05 0D         [ 4] 3701         CALL     OVER
      0015E7 CD 0B 1B         [ 4] 3702         CALL     COUNT
      0015EA CD 0E 8D         [ 4] 3703         CALL     TYPES   ;just in case
      0015ED CC 04 D9         [ 2] 3704 UNIQ1:  JP     DROP
                                   3705 
                                   3706 ;       $,n     ( na -- )
                                   3707 ;       Build a new dictionary name
                                   3708 ;       using string at na.
                                   3709 ; compile dans l'espace des variables 
      0015F0 15 C6                 3710         .word      LINK
                           0015F2  3711 LINK = . 
      0015F2 03                    3712         .byte      3
      0015F3 24 2C 6E              3713         .ascii     "$,n"
      0015F6                       3714 SNAME:
      0015F6 CD 04 E3         [ 4] 3715         CALL     DUPP
      0015F9 CD 04 5A         [ 4] 3716         CALL     CAT     ;?null input
      0015FC CD 03 E7         [ 4] 3717         CALL     QBRAN
      0015FF 16 2C                 3718         .word      PNAM1
      001601 CD 15 CE         [ 4] 3719         CALL     UNIQU   ;?redefinition
      001604 CD 04 E3         [ 4] 3720         CALL     DUPP
      001607 CD 0B 1B         [ 4] 3721         CALL     COUNT
      00160A CD 06 DE         [ 4] 3722         CALL     PLUS
      00160D CD 06 31         [ 4] 3723         CALL     VPP
      001610 CD 04 25         [ 4] 3724         CALL     STORE
      001613 CD 04 E3         [ 4] 3725         CALL     DUPP
      001616 CD 06 4F         [ 4] 3726         CALL     LAST
      001619 CD 04 25         [ 4] 3727         CALL     STORE   ;save na for vocabulary link
      00161C CD 09 BC         [ 4] 3728         CALL     CELLM   ;link address
      00161F CD 06 23         [ 4] 3729         CALL     CNTXT
      001622 CD 04 3C         [ 4] 3730         CALL     AT
      001625 CD 04 F3         [ 4] 3731         CALL     SWAPP
      001628 CD 04 25         [ 4] 3732         CALL     STORE
      00162B 81               [ 4] 3733         RET     ;save code pointer
      00162C CD 0E E0         [ 4] 3734 PNAM1:  CALL     STRQP
      00162F 05                    3735         .byte      5
      001630 20 6E 61 6D 65        3736         .ascii     " name" ;null input
      001635 CC 12 CE         [ 2] 3737         JP     ABOR1
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 70.
Hexadecimal [24-Bits]



                                   3738 
                                   3739 ;; FORTH compiler
                                   3740 
                                   3741 ;       $COMPILE        ( a -- )
                                   3742 ;       Compile next word to
                                   3743 ;       dictionary as a token or literal.
      001638 15 F2                 3744         .word      LINK
                           00163A  3745 LINK = . 
      00163A 08                    3746         .byte      8
      00163B 24 43 4F 4D 50 49 4C  3747         .ascii     "$COMPILE"
             45
      001643                       3748 SCOMP:
      001643 CD 11 BA         [ 4] 3749         CALL     NAMEQ
      001646 CD 06 8D         [ 4] 3750         CALL     QDUP    ;?defined
      001649 CD 03 E7         [ 4] 3751         CALL     QBRAN
      00164C 16 64                 3752         .word      SCOM2
      00164E CD 04 3C         [ 4] 3753         CALL     AT
      001651 CD 03 B4         [ 4] 3754         CALL     DOLIT
      001654 80 00                 3755         .word     0x8000	;  IMEDD*256
      001656 CD 05 2F         [ 4] 3756         CALL     ANDD    ;?immediate
      001659 CD 03 E7         [ 4] 3757         CALL     QBRAN
      00165C 16 61                 3758         .word      SCOM1
      00165E CC 04 0E         [ 2] 3759         JP     EXECU
      001661 CC 16 FE         [ 2] 3760 SCOM1:  JP     JSRC
      001664 CD 0D 58         [ 4] 3761 SCOM2:  CALL     NUMBQ   ;try to convert to number
      001667 CD 03 E7         [ 4] 3762         CALL     QBRAN
      00166A 12 CE                 3763         .word      ABOR1
      00166C CC 14 6A         [ 2] 3764         JP     LITER
                                   3765 
                                   3766 ;       OVERT   ( -- )
                                   3767 ;       Link a new word into vocabulary.
      00166F 16 3A                 3768         .word      LINK
                           001671  3769 LINK = . 
      001671 05                    3770         .byte      5
      001672 4F 56 45 52 54        3771         .ascii     "OVERT"
      001677                       3772 OVERT:
      001677 CD 06 4F         [ 4] 3773         CALL     LAST
      00167A CD 04 3C         [ 4] 3774         CALL     AT
      00167D CD 06 23         [ 4] 3775         CALL     CNTXT
      001680 CC 04 25         [ 2] 3776         JP     STORE
                                   3777 
                                   3778 ;       ;       ( -- )
                                   3779 ;       Terminate a colon definition.
      001683 16 71                 3780         .word      LINK
                           001685  3781 LINK = . 
      001685 C1                    3782 	.byte      IMEDD+COMPO+1
      001686 3B                    3783         .ascii     ";"
      001687                       3784 SEMIS:
                           000001  3785 .if OPTIMIZE ; more compact and faster
      001687 CD 03 B4         [ 4] 3786         call DOLIT 
      00168A 00 81                 3787         .word 0x81   ; opcode for RET 
      00168C CD 14 1A         [ 4] 3788         call CCOMMA 
                           000000  3789 .else
                                   3790         CALL     COMPI
                                   3791         .word EXIT 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 71.
Hexadecimal [24-Bits]



                                   3792 .endif 
      00168F CD 13 2F         [ 4] 3793         CALL     LBRAC
      001692 CD 16 77         [ 4] 3794         call OVERT 
      001695 CD 20 A4         [ 4] 3795         CALL FMOVE
      001698 CD 06 8D         [ 4] 3796         call QDUP 
      00169B CD 03 E7         [ 4] 3797         call QBRAN 
      00169E 17 CE                 3798         .word SET_RAMLAST 
      0016A0 CD 21 38         [ 4] 3799         CALL UPDATPTR
      0016A3 81               [ 4] 3800         RET 
                                   3801 
                                   3802 
                                   3803 ;       Terminate an ISR definition 
                                   3804 ;       retourn ca of ISR as double
                                   3805 ;       I; ( -- ud )
      0016A4 16 85                 3806         .word LINK 
                           0016A6  3807         LINK=.
      0016A6 C2                    3808         .byte 2+IMEDD+COMPO 
      0016A7 49 3B                 3809         .ascii "I;" 
      0016A9                       3810 ISEMI:
      0016A9 1D 00 02         [ 2] 3811         subw x,#CELLL  
      0016AC 90 AE 00 80      [ 2] 3812         ldw y,#IRET_CODE 
      0016B0 FF               [ 2] 3813         ldw (x),y 
      0016B1 CD 14 1A         [ 4] 3814         call CCOMMA
      0016B4 CD 13 2F         [ 4] 3815         call LBRAC 
      0016B7 CD 21 7D         [ 4] 3816         call IFMOVE
      0016BA CD 06 8D         [ 4] 3817         call QDUP 
      0016BD CD 03 E7         [ 4] 3818         CALL QBRAN 
      0016C0 17 CE                 3819         .word SET_RAMLAST
      0016C2 CD 06 3F         [ 4] 3820         CALL CPP
      0016C5 CD 04 3C         [ 4] 3821         call AT 
      0016C8 CD 04 F3         [ 4] 3822         call SWAPP 
      0016CB CD 06 3F         [ 4] 3823         CALL CPP 
      0016CE CD 04 25         [ 4] 3824         call STORE 
      0016D1 CD 1B C1         [ 4] 3825         call UPDATCP 
      0016D4 CD 1B 7E         [ 4] 3826         call EEPVP 
      0016D7 CD 04 D9         [ 4] 3827         call DROP 
      0016DA CD 04 3C         [ 4] 3828         call AT 
      0016DD CD 06 31         [ 4] 3829         call VPP 
      0016E0 CD 04 25         [ 4] 3830         call STORE 
      0016E3 CC 0A 44         [ 2] 3831         jp ZERO
      0016E6 81               [ 4] 3832         ret           
                                   3833         
                                   3834 
                                   3835 ;       ]       ( -- )
                                   3836 ;       Start compiling words in
                                   3837 ;       input stream.
      0016E7 16 A6                 3838         .word      LINK
                           0016E9  3839 LINK = . 
      0016E9 01                    3840         .byte      1
      0016EA 5D                    3841         .ascii     "]"
      0016EB                       3842 RBRAC:
      0016EB CD 03 B4         [ 4] 3843         CALL   DOLIT
      0016EE 16 43                 3844         .word  SCOMP
      0016F0 CD 06 01         [ 4] 3845         CALL   TEVAL
      0016F3 CC 04 25         [ 2] 3846         JP     STORE
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 72.
Hexadecimal [24-Bits]



                                   3847 
                                   3848 ;       CALL,    ( ca -- )
                                   3849 ;       Compile a subroutine call.
      0016F6 16 E9                 3850         .word      LINK
                           0016F8  3851 LINK = . 
      0016F8 05                    3852         .byte      5
      0016F9 43 41 4C 4C 2C        3853         .ascii     "CALL,"
      0016FE                       3854 JSRC:
      0016FE CD 03 B4         [ 4] 3855         CALL     DOLIT
      001701 00 CD                 3856         .word     CALLL     ;CALL
      001703 CD 14 1A         [ 4] 3857         CALL     CCOMMA
      001706 CC 14 03         [ 2] 3858         JP     COMMA
                                   3859 
                                   3860 ;       INIT-OFS ( -- )
                                   3861 ;       compute offset to adjust jump address 
                                   3862 ;       set variable OFFSET 
      001709 16 F8                 3863         .word LINK 
                           00170B  3864         LINK=.
      00170B 08                    3865         .byte 8 
      00170C 49 4E 49 54 2D 4F 46  3866         .ascii "INIT-OFS" 
             53
      001714                       3867 INITOFS:
      001714 CD 05 F0         [ 4] 3868         call TFLASH 
      001717 CD 04 3C         [ 4] 3869         CALL AT 
      00171A CD 04 E3         [ 4] 3870         CALL DUPP 
      00171D CD 03 E7         [ 4] 3871         call QBRAN
      001720 17 31                 3872         .word 1$
      001722 CD 04 D9         [ 4] 3873         call DROP  
      001725 CD 06 3F         [ 4] 3874         call CPP 
      001728 CD 04 3C         [ 4] 3875         call AT 
      00172B CD 0B 32         [ 4] 3876         call HERE
      00172E CD 07 57         [ 4] 3877         call SUBB 
      001731 CD 06 74         [ 4] 3878 1$:     call OFFSET 
      001734 CC 04 25         [ 2] 3879         jp STORE  
                                   3880 
                                   3881 ;       :       ( -- ; <string> )
                                   3882 ;       Start a new colon definition
                                   3883 ;       using next word as its name.
      001737 17 0B                 3884         .word      LINK
                           001739  3885 LINK = . 
      001739 01                    3886         .byte      1
      00173A 3A                    3887         .ascii     ":"
      00173B                       3888 COLON:
      00173B CD 17 14         [ 4] 3889         call INITOFS       
      00173E CD 10 BD         [ 4] 3890         CALL   TOKEN
      001741 CD 15 F6         [ 4] 3891         CALL   SNAME
      001744 CC 16 EB         [ 2] 3892         JP     RBRAC
                                   3893 
                                   3894 ;       I:  ( -- )
                                   3895 ;       Start interrupt service routine definition
                                   3896 ;       those definition have no name.
      001747 17 39                 3897         .word LINK
                           001749  3898         LINK=.
      001749 02                    3899         .byte 2 
      00174A 49 3A                 3900         .ascii "I:" 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 73.
Hexadecimal [24-Bits]



      00174C                       3901 ICOLON:
      00174C CD 17 14         [ 4] 3902         call INITOFS 
      00174F CC 16 EB         [ 2] 3903         jp RBRAC  
                                   3904 
                                   3905 ;       IMMEDIATE       ( -- )
                                   3906 ;       Make last compiled word
                                   3907 ;       an immediate word.
      001752 17 49                 3908         .word      LINK
                           001754  3909 LINK = . 
      001754 09                    3910         .byte      9
      001755 49 4D 4D 45 44 49 41  3911         .ascii     "IMMEDIATE"
             54 45
      00175E                       3912 IMMED:
      00175E CD 03 B4         [ 4] 3913         CALL     DOLIT
      001761 80 00                 3914         .word     0x8000	;  IMEDD*256
      001763 CD 06 4F         [ 4] 3915         CALL     LAST
      001766 CD 04 3C         [ 4] 3916         CALL     AT
      001769 CD 04 3C         [ 4] 3917         CALL     AT
      00176C CD 05 43         [ 4] 3918         CALL     ORR
      00176F CD 06 4F         [ 4] 3919         CALL     LAST
      001772 CD 04 3C         [ 4] 3920         CALL     AT
      001775 CC 04 25         [ 2] 3921         JP     STORE
                                   3922 
                                   3923 ;; Defining words
                                   3924 
                                   3925 ;       CREATE  ( -- ; <string> )
                                   3926 ;       Compile a new array
                                   3927 ;       without allocating space.
      001778 17 54                 3928         .word      LINK
                           00177A  3929 LINK = . 
      00177A 06                    3930         .byte      6
      00177B 43 52 45 41 54 45     3931         .ascii     "CREATE"
      001781                       3932 CREAT:
      001781 CD 10 BD         [ 4] 3933         CALL     TOKEN
      001784 CD 15 F6         [ 4] 3934         CALL     SNAME
      001787 CD 16 77         [ 4] 3935         CALL     OVERT        
      00178A CD 14 48         [ 4] 3936         CALL     COMPI 
      00178D 05 90                 3937         .word DOVAR 
      00178F 81               [ 4] 3938         RET
                                   3939 
                                   3940 ;       VARIABLE        ( -- ; <string> )
                                   3941 ;       Compile a new variable
                                   3942 ;       initialized to 0.
      001790 17 7A                 3943         .word      LINK
                           001792  3944 LINK = . 
      001792 08                    3945         .byte      8
      001793 56 41 52 49 41 42 4C  3946         .ascii     "VARIABLE"
             45
      00179B                       3947 VARIA:
                                   3948 ; indirect variable so that VARIABLE definition can be compiled in FLASH 
      00179B CD 0B 32         [ 4] 3949         CALL HERE
      00179E CD 04 E3         [ 4] 3950         CALL DUPP 
      0017A1 CD 09 AD         [ 4] 3951         CALL CELLP
      0017A4 CD 06 31         [ 4] 3952         CALL VPP 
      0017A7 CD 04 25         [ 4] 3953         CALL STORE
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 74.
Hexadecimal [24-Bits]



      0017AA CD 17 81         [ 4] 3954         CALL CREAT
      0017AD CD 04 E3         [ 4] 3955         CALL DUPP
      0017B0 CD 14 03         [ 4] 3956         CALL COMMA
      0017B3 CD 0A 44         [ 4] 3957         CALL ZERO
      0017B6 CD 04 F3         [ 4] 3958         call SWAPP 
      0017B9 CD 04 25         [ 4] 3959         CALL STORE
      0017BC CD 20 A4         [ 4] 3960         CALL FMOVE ; move definition to FLASH
      0017BF CD 06 8D         [ 4] 3961         CALL QDUP 
      0017C2 CD 03 E7         [ 4] 3962         CALL QBRAN 
      0017C5 17 CE                 3963         .word SET_RAMLAST   
      0017C7 CD 1B D8         [ 4] 3964         call UPDATVP  ; don't update if variable kept in RAM.
      0017CA CD 21 38         [ 4] 3965         CALL UPDATPTR
      0017CD 81               [ 4] 3966         RET         
      0017CE                       3967 SET_RAMLAST: 
      0017CE CD 06 4F         [ 4] 3968         CALL LAST 
      0017D1 CD 04 3C         [ 4] 3969         CALL AT 
      0017D4 CD 06 62         [ 4] 3970         CALL RAMLAST 
      0017D7 CC 04 25         [ 2] 3971         jp STORE  
                                   3972 
                                   3973 
                                   3974 ;       CONSTANT  ( n -- ; <string> )
                                   3975 ;       Compile a new constant 
                                   3976 ;       n CONSTANT name 
      0017DA 17 92                 3977         .word LINK 
                           0017DC  3978         LINK=. 
      0017DC 08                    3979         .byte 8 
      0017DD 43 4F 4E 53 54 41 4E  3980         .ascii "CONSTANT" 
             54
      0017E5                       3981 CONSTANT:          
      0017E5 CD 10 BD         [ 4] 3982         CALL TOKEN
      0017E8 CD 15 F6         [ 4] 3983         CALL SNAME 
      0017EB CD 16 77         [ 4] 3984         CALL OVERT 
      0017EE CD 14 48         [ 4] 3985         CALL COMPI 
      0017F1 18 0F                 3986         .word DOCONST
      0017F3 CD 14 03         [ 4] 3987         CALL COMMA 
      0017F6 CD 20 A4         [ 4] 3988         CALL FMOVE
      0017F9 CD 06 8D         [ 4] 3989         CALL QDUP 
      0017FC CD 03 E7         [ 4] 3990         CALL QBRAN 
      0017FF 17 CE                 3991         .word SET_RAMLAST  
      001801 CD 21 38         [ 4] 3992         CALL UPDATPTR  
      001804 81               [ 4] 3993 1$:     RET          
                                   3994 
                                   3995 ; CONSTANT runtime semantic 
                                   3996 ; doCONST  ( -- n )
      001805 17 DC                 3997         .word LINK 
                           001807  3998         LINK=.
      001807 07                    3999         .byte 7
      001808 44 4F 43 4F 4E 53 54  4000         .ascii "DOCONST"
      00180F                       4001 DOCONST:
      00180F 1D 00 02         [ 2] 4002         subw x,#CELLL
      001812 90 85            [ 2] 4003         popw y 
      001814 90 FE            [ 2] 4004         ldw y,(y) 
      001816 FF               [ 2] 4005         ldw (x),y 
      001817 81               [ 4] 4006         ret 
                                   4007 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 75.
Hexadecimal [24-Bits]



                                   4008 
                                   4009 ;; Tools
                                   4010 
                                   4011 ;       _TYPE   ( b u -- )
                                   4012 ;       Display a string. Filter
                                   4013 ;       non-printing characters.
      001818 18 07                 4014         .word      LINK
                           00181A  4015 LINK = . 
      00181A 05                    4016         .byte      5
      00181B 5F 54 59 50 45        4017         .ascii     "_TYPE"
      001820                       4018 UTYPE:
      001820 CD 04 AC         [ 4] 4019         CALL     TOR     ;start count down loop
      001823 20 0F            [ 2] 4020         JRA     UTYP2   ;skip first pass
      001825 CD 04 E3         [ 4] 4021 UTYP1:  CALL     DUPP
      001828 CD 04 5A         [ 4] 4022         CALL     CAT
      00182B CD 0A 6E         [ 4] 4023         CALL     TCHAR
      00182E CD 03 9E         [ 4] 4024         CALL     EMIT    ;display only printable
      001831 CD 09 D8         [ 4] 4025         CALL     ONEP    ;increment address
      001834 CD 03 C8         [ 4] 4026 UTYP2:  CALL     DONXT
      001837 18 25                 4027         .word      UTYP1   ;loop till done
      001839 CC 04 D9         [ 2] 4028         JP     DROP
                                   4029 
                                   4030 ;       dm+     ( a u -- a )
                                   4031 ;       Dump u bytes from ,
                                   4032 ;       leaving a+u on  stack.
      00183C 18 1A                 4033         .word      LINK
                           00183E  4034 LINK = . 
      00183E 03                    4035         .byte      3
      00183F 64 6D 2B              4036         .ascii     "dm+"
      001842                       4037 DUMPP:
      001842 CD 05 0D         [ 4] 4038         CALL     OVER
      001845 CD 03 B4         [ 4] 4039         CALL     DOLIT
      001848 00 04                 4040         .word      4
      00184A CD 0F 13         [ 4] 4041         CALL     UDOTR   ;display address
      00184D CD 0E 63         [ 4] 4042         CALL     SPACE
      001850 CD 04 AC         [ 4] 4043         CALL     TOR     ;start count down loop
      001853 20 11            [ 2] 4044         JRA     PDUM2   ;skip first pass
      001855 CD 04 E3         [ 4] 4045 PDUM1:  CALL     DUPP
      001858 CD 04 5A         [ 4] 4046         CALL     CAT
      00185B CD 03 B4         [ 4] 4047         CALL     DOLIT
      00185E 00 03                 4048         .word      3
      001860 CD 0F 13         [ 4] 4049         CALL     UDOTR   ;display numeric data
      001863 CD 09 D8         [ 4] 4050         CALL     ONEP    ;increment address
      001866 CD 03 C8         [ 4] 4051 PDUM2:  CALL     DONXT
      001869 18 55                 4052         .word      PDUM1   ;loop till done
      00186B 81               [ 4] 4053         RET
                                   4054 
                                   4055 ;       DUMP    ( a u -- )
                                   4056 ;       Dump u bytes from a,
                                   4057 ;       in a formatted manner.
      00186C 18 3E                 4058         .word      LINK
                           00186E  4059 LINK = . 
      00186E 04                    4060         .byte      4
      00186F 44 55 4D 50           4061         .ascii     "DUMP"
      001873                       4062 DUMP:
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 76.
Hexadecimal [24-Bits]



      001873 CD 05 A0         [ 4] 4063         CALL     BASE
      001876 CD 04 3C         [ 4] 4064         CALL     AT
      001879 CD 04 AC         [ 4] 4065         CALL     TOR
      00187C CD 0C EB         [ 4] 4066         CALL     HEX     ;save radix, set hex
      00187F CD 03 B4         [ 4] 4067         CALL     DOLIT
      001882 00 10                 4068         .word      16
      001884 CD 08 FE         [ 4] 4069         CALL     SLASH   ;change count to lines
      001887 CD 04 AC         [ 4] 4070         CALL     TOR     ;start count down loop
      00188A CD 0E AB         [ 4] 4071 DUMP1:  CALL     CR
      00188D CD 03 B4         [ 4] 4072         CALL     DOLIT
      001890 00 10                 4073         .word      16
      001892 CD 06 C9         [ 4] 4074         CALL     DDUP
      001895 CD 18 42         [ 4] 4075         CALL     DUMPP   ;display numeric
      001898 CD 06 9E         [ 4] 4076         CALL     ROT
      00189B CD 06 9E         [ 4] 4077         CALL     ROT
      00189E CD 0E 63         [ 4] 4078         CALL     SPACE
      0018A1 CD 0E 63         [ 4] 4079         CALL     SPACE
      0018A4 CD 18 20         [ 4] 4080         CALL     UTYPE   ;display printable characters
      0018A7 CD 03 C8         [ 4] 4081         CALL     DONXT
      0018AA 18 8A                 4082         .word      DUMP1   ;loop till done
      0018AC CD 04 D9         [ 4] 4083 DUMP3:  CALL     DROP
      0018AF CD 04 8D         [ 4] 4084         CALL     RFROM
      0018B2 CD 05 A0         [ 4] 4085         CALL     BASE
      0018B5 CC 04 25         [ 2] 4086         JP     STORE   ;restore radix
                                   4087 
                                   4088 ;       .S      ( ... -- ... )
                                   4089 ;        Display  contents of stack.
      0018B8 18 6E                 4090         .word      LINK
                           0018BA  4091 LINK = . 
      0018BA 02                    4092         .byte      2
      0018BB 2E 53                 4093         .ascii     ".S"
      0018BD                       4094 DOTS:
      0018BD CD 0E AB         [ 4] 4095         CALL     CR
      0018C0 CD 0A 86         [ 4] 4096         CALL     DEPTH   ;stack depth
      0018C3 CD 04 AC         [ 4] 4097         CALL     TOR     ;start count down loop
      0018C6 20 09            [ 2] 4098         JRA     DOTS2   ;skip first pass
      0018C8 CD 04 A0         [ 4] 4099 DOTS1:  CALL     RAT
      0018CB CD 0A 9D         [ 4] 4100 	CALL     PICK
      0018CE CD 0F 46         [ 4] 4101         CALL     DOT     ;index stack, display contents
      0018D1 CD 03 C8         [ 4] 4102 DOTS2:  CALL     DONXT
      0018D4 18 C8                 4103         .word      DOTS1   ;loop till done
      0018D6 CD 0E EA         [ 4] 4104         CALL     DOTQP
      0018D9 05                    4105         .byte      5
      0018DA 20 3C 73 70 20        4106         .ascii     " <sp "
      0018DF 81               [ 4] 4107         RET
                                   4108 
                                   4109 ;       >NAME   ( ca -- na | F )
                                   4110 ;       Convert code address
                                   4111 ;       to a name address.
      0018E0 18 BA                 4112         .word      LINK
                           0018E2  4113 LINK = . 
      0018E2 05                    4114         .byte      5
      0018E3 3E 4E 41 4D 45        4115         .ascii     ">NAME"
      0018E8                       4116 TNAME:
      0018E8 CD 06 23         [ 4] 4117         CALL     CNTXT   ;vocabulary link
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 77.
Hexadecimal [24-Bits]



      0018EB CD 04 3C         [ 4] 4118 TNAM2:  CALL     AT
      0018EE CD 04 E3         [ 4] 4119         CALL     DUPP    ;?last word in a vocabulary
      0018F1 CD 03 E7         [ 4] 4120         CALL     QBRAN
      0018F4 19 0F                 4121         .word      TNAM4
      0018F6 CD 06 C9         [ 4] 4122         CALL     DDUP
      0018F9 CD 10 CB         [ 4] 4123         CALL     NAMET
      0018FC CD 05 58         [ 4] 4124         CALL     XORR    ;compare
      0018FF CD 03 E7         [ 4] 4125         CALL     QBRAN
      001902 19 09                 4126         .word      TNAM3
      001904 CD 09 BC         [ 4] 4127         CALL     CELLM   ;continue with next word
      001907 20 E2            [ 2] 4128         JRA     TNAM2
      001909 CD 04 F3         [ 4] 4129 TNAM3:  CALL     SWAPP
      00190C CC 04 D9         [ 2] 4130         JP     DROP
      00190F CD 06 BE         [ 4] 4131 TNAM4:  CALL     DDROP
      001912 CC 0A 44         [ 2] 4132         JP     ZERO
                                   4133 
                                   4134 ;       .ID     ( na -- )
                                   4135 ;        Display  name at address.
      001915 18 E2                 4136         .word      LINK
                           001917  4137 LINK = . 
      001917 03                    4138         .byte      3
      001918 2E 49 44              4139         .ascii     ".ID"
      00191B                       4140 DOTID:
      00191B CD 06 8D         [ 4] 4141         CALL     QDUP    ;if zero no name
      00191E CD 03 E7         [ 4] 4142         CALL     QBRAN
      001921 19 31                 4143         .word      DOTI1
      001923 CD 0B 1B         [ 4] 4144         CALL     COUNT
      001926 CD 03 B4         [ 4] 4145         CALL     DOLIT
      001929 00 1F                 4146         .word      0x1F
      00192B CD 05 2F         [ 4] 4147         CALL     ANDD    ;mask lexicon bits
      00192E CC 18 20         [ 2] 4148         JP     UTYPE
      001931 CD 0E EA         [ 4] 4149 DOTI1:  CALL     DOTQP
      001934 09                    4150         .byte      9
      001935 20 6E 6F 4E 61 6D 65  4151         .ascii     " noName"
      00193C 81               [ 4] 4152         RET
                                   4153 
                                   4154 
                           000001  4155 .if WANT_SEE 
                                   4156 ;       SEE     ( -- ; <string> )
                                   4157 ;       A simple decompiler.
                                   4158 ;       Updated for byte machines.
      00193D 19 17                 4159         .word      LINK
                           00193F  4160 LINK = . 
      00193F 03                    4161         .byte      3
      001940 53 45 45              4162         .ascii     "SEE"
      001943                       4163 SEE:
      001943 CD 13 E2         [ 4] 4164         CALL     TICK    ;starting address
      001946 CD 0E AB         [ 4] 4165         CALL     CR
      001949 CD 09 E5         [ 4] 4166         CALL     ONEM
      00194C CD 09 D8         [ 4] 4167 SEE1:   CALL     ONEP
      00194F CD 04 E3         [ 4] 4168         CALL     DUPP
      001952 CD 04 3C         [ 4] 4169         CALL     AT
      001955 CD 04 E3         [ 4] 4170         CALL     DUPP    ;?does it contain a zero
      001958 CD 03 E7         [ 4] 4171         CALL     QBRAN
      00195B 19 60                 4172         .word    SEE2
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 78.
Hexadecimal [24-Bits]



      00195D CD 18 E8         [ 4] 4173         CALL     TNAME   ;?is it a name
      001960 CD 06 8D         [ 4] 4174 SEE2:   CALL     QDUP    ;name address or zero
      001963 CD 03 E7         [ 4] 4175         CALL     QBRAN
      001966 19 73                 4176         .word    SEE3
      001968 CD 0E 63         [ 4] 4177         CALL     SPACE
      00196B CD 19 1B         [ 4] 4178         CALL     DOTID   ;display name
      00196E CD 09 D8         [ 4] 4179         CALL     ONEP
      001971 20 09            [ 2] 4180         JRA      SEE4
      001973 CD 04 E3         [ 4] 4181 SEE3:   CALL     DUPP
      001976 CD 04 5A         [ 4] 4182         CALL     CAT
      001979 CD 0F 33         [ 4] 4183         CALL     UDOT    ;display number
      00197C CD 0E 41         [ 4] 4184 SEE4:   CALL     NUFQ    ;user control
      00197F CD 03 E7         [ 4] 4185         CALL     QBRAN
      001982 19 4C                 4186         .word    SEE1
      001984 CC 04 D9         [ 2] 4187         JP     DROP
                                   4188 .endif ; WANT_SEE 
                                   4189 
                                   4190 ;       WORDS   ( -- )
                                   4191 ;       Display names in vocabulary.
      001987 19 3F                 4192         .word      LINK
                           001989  4193 LINK = . 
      001989 05                    4194         .byte      5
      00198A 57 4F 52 44 53        4195         .ascii     "WORDS"
      00198F                       4196 WORDS:
      00198F CD 0E AB         [ 4] 4197         CALL     CR
      001992 CD 06 23         [ 4] 4198         CALL     CNTXT   ;only in context
      001995 CD 04 3C         [ 4] 4199 WORS1:  CALL     AT
      001998 CD 06 8D         [ 4] 4200         CALL     QDUP    ;?at end of list
      00199B CD 03 E7         [ 4] 4201         CALL     QBRAN
      00199E 19 B1                 4202         .word      WORS2
      0019A0 CD 04 E3         [ 4] 4203         CALL     DUPP
      0019A3 CD 0E 63         [ 4] 4204         CALL     SPACE
      0019A6 CD 19 1B         [ 4] 4205         CALL     DOTID   ;display a name
      0019A9 CD 09 BC         [ 4] 4206         CALL     CELLM
      0019AC CD 03 FE         [ 4] 4207         CALL     BRAN
      0019AF 19 95                 4208         .word      WORS1
      0019B1 81               [ 4] 4209 WORS2:  RET
                                   4210 
                                   4211         
                                   4212 ;; Hardware reset
                                   4213 
                                   4214 ;       hi      ( -- )
                                   4215 ;       Display sign-on message.
      0019B2 19 89                 4216         .word      LINK
                           0019B4  4217 LINK = . 
      0019B4 02                    4218         .byte      2
      0019B5 68 69                 4219         .ascii     "hi"
      0019B7                       4220 HI:
      0019B7 CD 0E AB         [ 4] 4221         CALL     CR
      0019BA CD 0E EA         [ 4] 4222         CALL     DOTQP   ;initialize I/O
      0019BD 0F                    4223         .byte      15
      0019BE 73 74 6D 38 65 46 6F  4224         .ascii     "stm8eForth v"
             72 74 68 20 76
      0019CA 33                    4225 	.byte      VER+'0'
      0019CB 2E                    4226         .byte      '.' 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 79.
Hexadecimal [24-Bits]



      0019CC 30                    4227 	.byte      EXT+'0' ;version
      0019CD CC 0E AB         [ 2] 4228         JP     CR
                                   4229 
                           000000  4230 WANT_DEBUG=0
                           000000  4231 .if WANT_DEBUG 
                                   4232 ;       DEBUG      ( -- )
                                   4233 ;       Display sign-on message.
                                   4234 ;        .word      LINK
                                   4235 LINK = . 
                                   4236         .byte      5
                                   4237         .ascii     "DEBUG"
                                   4238 DEBUG:
                                   4239 	CALL DOLIT
                                   4240 	.word 0x65
                                   4241 	CALL EMIT
                                   4242 	CALL DOLIT
                                   4243 	.word 0
                                   4244  	CALL ZLESS 
                                   4245 	CALL DOLIT
                                   4246 	.word 0xFFFE
                                   4247 	CALL ZLESS 
                                   4248 	CALL UPLUS 
                                   4249  	CALL DROP 
                                   4250 	CALL DOLIT
                                   4251 	.word 3
                                   4252 	CALL UPLUS 
                                   4253 	CALL UPLUS 
                                   4254  	CALL DROP
                                   4255 	CALL DOLIT
                                   4256 	.word 0x43
                                   4257 	CALL UPLUS 
                                   4258  	CALL DROP
                                   4259 	CALL EMIT
                                   4260 	CALL DOLIT
                                   4261 	.word 0x4F
                                   4262 	CALL DOLIT
                                   4263 	.word 0x6F
                                   4264  	CALL XORR
                                   4265 	CALL DOLIT
                                   4266 	.word 0xF0
                                   4267  	CALL ANDD
                                   4268 	CALL DOLIT
                                   4269 	.word 0x4F
                                   4270  	CALL ORR
                                   4271 	CALL EMIT
                                   4272 	CALL DOLIT
                                   4273 	.word 8
                                   4274 	CALL DOLIT
                                   4275 	.word 6
                                   4276  	CALL SWAPP
                                   4277 	CALL OVER
                                   4278 	CALL XORR
                                   4279 	CALL DOLIT
                                   4280 	.word 3
                                   4281 	CALL ANDD 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 80.
Hexadecimal [24-Bits]



                                   4282 	CALL ANDD
                                   4283 	CALL DOLIT
                                   4284 	.word 0x70
                                   4285 	CALL UPLUS 
                                   4286 	CALL DROP
                                   4287 	CALL EMIT
                                   4288 	CALL DOLIT
                                   4289 	.word 0
                                   4290 	CALL QBRAN
                                   4291 	.word DEBUG1
                                   4292 	CALL DOLIT
                                   4293 	.word 0x3F
                                   4294 DEBUG1:
                                   4295 	CALL DOLIT
                                   4296 	.word 0xFFFF
                                   4297 	CALL QBRAN
                                   4298 	.word DEBUG2
                                   4299 	CALL DOLIT
                                   4300 	.word 0x74
                                   4301 	CALL BRAN
                                   4302 	.word DEBUG3
                                   4303 DEBUG2:
                                   4304 	CALL DOLIT
                                   4305 	.word 0x21
                                   4306 DEBUG3:
                                   4307 	CALL EMIT
                                   4308 	CALL DOLIT
                                   4309 	.word 0x68
                                   4310 	CALL DOLIT
                                   4311 	.word 0x80
                                   4312 	CALL STORE
                                   4313 	CALL DOLIT
                                   4314 	.word 0x80
                                   4315 	CALL AT
                                   4316 	CALL EMIT
                                   4317 	CALL DOLIT
                                   4318 	.word 0x4D
                                   4319 	CALL TOR
                                   4320 	CALL RAT
                                   4321 	CALL RFROM
                                   4322 	CALL ANDD
                                   4323 	CALL EMIT
                                   4324 	CALL DOLIT
                                   4325 	.word 0x61
                                   4326 	CALL DOLIT
                                   4327 	.word 0xA
                                   4328 	CALL TOR
                                   4329 DEBUG4:
                                   4330 	CALL DOLIT
                                   4331 	.word 1
                                   4332 	CALL UPLUS 
                                   4333 	CALL DROP
                                   4334 	CALL DONXT
                                   4335 	.word DEBUG4
                                   4336 	CALL EMIT
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 81.
Hexadecimal [24-Bits]



                                   4337 	CALL DOLIT
                                   4338 	.word 0x656D
                                   4339 	CALL DOLIT
                                   4340 	.word 0x100
                                   4341 	CALL UMSTA
                                   4342 	CALL SWAPP
                                   4343 	CALL DOLIT
                                   4344 	.word 0x100
                                   4345 	CALL UMSTA
                                   4346 	CALL SWAPP 
                                   4347 	CALL DROP
                                   4348 	CALL EMIT
                                   4349 	CALL EMIT
                                   4350 	CALL DOLIT
                                   4351 	.word 0x2043
                                   4352 	CALL DOLIT
                                   4353 	.word 0
                                   4354 	CALL DOLIT
                                   4355 	.word 0x100
                                   4356 	CALL UMMOD
                                   4357 	CALL EMIT
                                   4358 	CALL EMIT
                                   4359 	;JP ORIG
                                   4360 	RET
                                   4361 .endif ; WANT_DEBUG 
                                   4362 
                                   4363 
                                   4364 ;       'BOOT   ( -- a )
                                   4365 ;       The application startup vector.
      0019D0 19 B4                 4366         .word      LINK
                           0019D2  4367 LINK = . 
      0019D2 05                    4368         .byte      5
      0019D3 27 42 4F 4F 54        4369         .ascii     "'BOOT"
      0019D8                       4370 TBOOT:
      0019D8 CD 05 90         [ 4] 4371         CALL     DOVAR
      0019DB 40 02                 4372         .word    APP_RUN      ;application to boot
                                   4373 
                                   4374 ;       COLD    ( -- )
                                   4375 ;       The hilevel cold start s=ence.
      0019DD 19 D2                 4376         .word      LINK
                           0019DF  4377         LINK = . 
      0019DF 04                    4378         .byte      4
      0019E0 43 4F 4C 44           4379         .ascii     "COLD"
      0019E4                       4380 COLD:
                           000000  4381 .if WANT_DEBUG
                                   4382         CALL DEBUG
                                   4383 .endif ; WANT_DEBUG
      0019E4 CD 03 B4         [ 4] 4384 COLD1:  CALL     DOLIT
      0019E7 00 2B                 4385         .word      UZERO
      0019E9 CD 03 B4         [ 4] 4386 	CALL     DOLIT
      0019EC 00 06                 4387         .word      UPP
      0019EE CD 03 B4         [ 4] 4388         CALL     DOLIT
      0019F1 00 1A                 4389 	.word      UEND-UZERO
      0019F3 CD 0B 7F         [ 4] 4390         CALL     CMOVE   ;initialize user area
                                   4391 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 82.
Hexadecimal [24-Bits]



                                   4392 ; if APP_RUN==0 initialize with ca de 'hi'  
      0019F6 90 CE 40 02      [ 2] 4393         ldw y,APP_RUN 
      0019FA 26 0B            [ 1] 4394         jrne 0$
      0019FC 1D 00 02         [ 2] 4395         subw x,#CELLL 
      0019FF 90 AE 19 B7      [ 2] 4396         ldw y,#HI  
      001A03 FF               [ 2] 4397         ldw (x),y
      001A04 CD 1B B0         [ 4] 4398         call UPDATRUN 
      001A07                       4399 0$:        
                                   4400 ; update LAST with APP_LAST 
                                   4401 ; if APP_LAST > LAST else do the opposite
      001A07 90 CE 40 00      [ 2] 4402         ldw y,APP_LAST 
      001A0B 90 B3 1A         [ 2] 4403         cpw y,ULAST 
      001A0E 22 05            [ 1] 4404         jrugt 1$ 
                                   4405 ; save LAST at APP_LAST  
      001A10 CD 1B 98         [ 4] 4406         call UPDATLAST 
      001A13 20 06            [ 2] 4407         jra 2$
      001A15                       4408 1$: ; update LAST with APP_LAST 
      001A15 90 BF 1A         [ 2] 4409         ldw ULAST,y
      001A18 90 BF 14         [ 2] 4410         ldw UCNTXT,y
      001A1B                       4411 2$:  
                                   4412 ; update APP_CP if < app_space 
      001A1B 90 CE 40 04      [ 2] 4413         ldw y,APP_CP  
      001A1F 90 B3 18         [ 2] 4414         cpw y,UCP   
      001A22 24 06            [ 1] 4415         jruge 3$ 
      001A24 CD 1B C1         [ 4] 4416         call UPDATCP
      001A27 90 BE 18         [ 2] 4417         ldw y,UCP   
      001A2A                       4418 3$:
      001A2A 90 BF 18         [ 2] 4419         ldw UCP,y                 
                                   4420 ; update UVP with APP_VP  
                                   4421 ; if APP_VP>UVP else do the opposite 
      001A2D 90 CE 40 06      [ 2] 4422         ldw y,APP_VP 
      001A31 90 B3 16         [ 2] 4423         cpw y,UVP 
      001A34 22 05            [ 1] 4424         jrugt 4$
      001A36 CD 1B D8         [ 4] 4425         call UPDATVP 
      001A39 20 03            [ 2] 4426         jra 6$
      001A3B                       4427 4$: ; update UVP with APP_VP 
      001A3B 90 BF 16         [ 2] 4428         ldw UVP,y 
      001A3E                       4429 6$:      
      001A3E CD 13 AE         [ 4] 4430         CALL     PRESE   ;initialize data stack and TIB
      001A41 CD 19 D8         [ 4] 4431         CALL     TBOOT
      001A44 CD 0B 68         [ 4] 4432         CALL     ATEXE   ;application boot
      001A47 CD 16 77         [ 4] 4433         CALL     OVERT
      001A4A CC 13 CB         [ 2] 4434         JP     QUIT    ;start interpretation
                                   4435 
                           000001  4436 WANT_MATH_CONST = 1 
                           000001  4437 .if WANT_MATH_CONST 
                                   4438         ; irrational constants 
                                   4439         ; approximation by integers ratio.
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 83.
Hexadecimal [24-Bits]



                                   4440         .include "const_ratio.asm"
                                      1 ;;
                                      2 ; Copyright Jacques Deschênes 2019,2020 
                                      3 ; This file is part of stm8_eForth  
                                      4 ;
                                      5 ;     stm8_eForth is free software: you can redistribute it and/or modify
                                      6 ;     it under the terms of the GNU General Public License as published by
                                      7 ;     the Free Software Foundation, either version 3 of the License, or
                                      8 ;     (at your option) any later version.
                                      9 ;
                                     10 ;     stm8_eForth is distributed in the hope that it will be useful,
                                     11 ;     but WITHOUT ANY WARRANTY; without even the implied warranty of
                                     12 ;     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
                                     13 ;     GNU General Public License for more details.
                                     14 ;
                                     15 ;     You should have received a copy of the GNU General Public License
                                     16 ;     along with stm8_eForth.  If not, see <http://www.gnu.org/licenses/>.
                                     17 ;;
                                     18 
                                     19 ;--------------------------------------------------------------------
                                     20 ; Irrationals constants 
                                     21 ; expressed as 2 integers ratio
                                     22 ; aproximation. These are to be used with scaling operators */ and */MOD 
                                     23 ; REF: https://www.forth.com/starting-forth/5-fixed-point-arithmetic/
                                     24 ;---------------------------------------------------------------------
                                     25 
                                     26 ;       PI ( --  355 113 )
                                     27 ; precision 8.5e-8 
                                     28 ; usage example to compute circle area
                                     29 ; : CAREA DUP * PI */ ;
                                     30 ; 
      001A4D 19 DF                   31         .word LINK 
                           001A4F    32         LINK=.
      001A4F 02                      33         .byte 2
      001A50 50 49                   34         .ascii "PI" 
      001A52                         35 PII:
      001A52 1D 00 04         [ 2]   36         subw x,#2*CELLL 
      001A55 90 AE 01 63      [ 2]   37         ldw y,#355 
      001A59 EF 02            [ 2]   38         ldw (2,x),y 
      001A5B 90 AE 00 71      [ 2]   39         ldw y,#113 
      001A5F FF               [ 2]   40         ldw (x),y 
      001A60 81               [ 4]   41         ret 
                                     42 
                                     43 ;      SQRT2 ( -- 19601  13860 )
                                     44 ; precision: 1.5e-9 
                                     45 ; usage example to compute Voltage peek to peek from Vrms 
                                     46 ; : VPP SQRT2 */ 2 * ;
                                     47 ;
      001A61 1A 4F                   48         .word LINK 
                           001A63    49         LINK=.
      001A63 05                      50         .byte 5 
      001A64 53 51 52 54 32          51         .ascii "SQRT2" 
      001A69                         52 SQRT2:
      001A69 1D 00 04         [ 2]   53         subw x,#2*CELLL 
      001A6C 90 AE 4C 91      [ 2]   54         ldw y,#19601 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 84.
Hexadecimal [24-Bits]



      001A70 EF 02            [ 2]   55         ldw (2,x),y 
      001A72 90 AE 36 24      [ 2]   56         ldw y,#13860 
      001A76 FF               [ 2]   57         ldw (x),y 
      001A77 81               [ 4]   58         ret 
                                     59 
                                     60 ;   SQRT3 ( -- 18817 10864 )
                                     61 ; precision: 1.1e-9
                                     62 ;
      001A78 1A 63                   63         .word LINK 
                           001A7A    64         LINK=.
      001A7A 05                      65         .byte 5
      001A7B 53 51 52 54 33          66         .ascii "SQRT3" 
      001A80                         67 SQRT3: 
      001A80 1D 00 04         [ 2]   68     subw x,#2*CELLL 
      001A83 90 AE 49 81      [ 2]   69     ldw y,#18817 
      001A87 EF 02            [ 2]   70     ldw (2,x),y 
      001A89 90 AE 2A 70      [ 2]   71     ldw y,#10864 
      001A8D FF               [ 2]   72     ldw (x),y 
      001A8E 81               [ 4]   73     ret 
                                     74 
                                     75 ;   E ( -- 28667 10546 )
                                     76 ; precision: 5.5e-9 
                                     77 ; natural log base 
      001A8F 1A 7A                   78         .word LINK 
                           001A91    79         LINK=.
      001A91 01                      80         .byte 1
      001A92 45                      81         .ascii "E" 
      001A93                         82 ENEPER:
      001A93 1D 00 04         [ 2]   83     subw x,#2*CELLL 
      001A96 90 AE 6F FB      [ 2]   84     ldw y,#28667 
      001A9A EF 02            [ 2]   85     ldw (2,x),y 
      001A9C 90 AE 29 32      [ 2]   86     ldw y,#10546 
      001AA0 FF               [ 2]   87     ldw (x),y 
      001AA1 81               [ 4]   88     ret 
                                     89 
                                     90 ;   SQRT10 ( -- 22936 7253 )
                                     91 ; precision: 5.7e-9 
      001AA2 1A 91                   92         .word LINK 
                           001AA4    93         LINK=.
      001AA4 06                      94         .byte 6 
      001AA5 53 51 52 54 31 30       95         .ascii "SQRT10" 
      001AAB                         96 SQRT10:
      001AAB 1D 00 04         [ 2]   97     subw x,#2*CELLL
      001AAE 90 AE 59 98      [ 2]   98     ldw y,#22936 
      001AB2 EF 02            [ 2]   99     ldw (2,x),y 
      001AB4 90 AE 1C 55      [ 2]  100     ldw y,#7253
      001AB8 FF               [ 2]  101     ldw (x),y 
      001AB9 81               [ 4]  102     ret 
                                    103 
                                    104 ;   SQRT12 ( -- 26797 25293 )
                                    105 ; precision: 1.0e-9 
                                    106 ; used in music to compute well tempered scale
      001ABA 1A A4                  107         .word LINK 
                           001ABC   108         LINK=. 
      001ABC 05                     109         .byte 5 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 85.
Hexadecimal [24-Bits]



      001ABD 31 32 52 54 32         110         .ascii "12RT2"
      001AC2                        111 RT12_2:
      001AC2 1D 00 04         [ 2]  112     subw x,#2*CELLL 
      001AC5 90 AE 68 AD      [ 2]  113     ldw y,#26797
      001AC9 EF 02            [ 2]  114     ldw (2,x),y 
      001ACB 90 AE 62 CD      [ 2]  115     ldw y,#25293
      001ACF FF               [ 2]  116     ldw (x),y 
      001AD0 81               [ 4]  117     ret 
                                    118 
                                    119 ;   LOG2s ( -- 2040 11103 )
                                    120 ; log(2)/1.6384
                                    121 ; precision: 1.1e-8
      001AD1 1A BC                  122         .word LINK 
                           001AD3   123         LINK=.
      001AD3 05                     124         .byte 5 
      001AD4 4C 4F 47 32 53         125         .ascii "LOG2S" 
      001AD9                        126 LOG2S:
      001AD9 1D 00 04         [ 2]  127     subw x,#2*CELLL
      001ADC 90 AE 07 F8      [ 2]  128     ldw y,#2040 
      001AE0 EF 02            [ 2]  129     ldw (2,x),y 
      001AE2 90 AE 2B 5F      [ 2]  130     ldw y,#11103 
      001AE6 FF               [ 2]  131     ldw (x),y 
      001AE7 81               [ 4]  132     ret 
                                    133 
                                    134 ;   LN2 ( -- 485 11464 )
                                    135 ; ln(2)/16.384 
                                    136 ; precision: 1.0e-7 
      001AE8 1A D3                  137         .word LINK 
                           001AEA   138         LINK=.
      001AEA 04                     139         .byte 4 
      001AEB 4C 4E 32 53            140         .ascii "LN2S" 
      001AEF                        141 LN2S: 
      001AEF 1D 00 04         [ 2]  142     subw x,#2*CELLL
      001AF2 90 AE 01 E5      [ 2]  143     ldw y,#485
      001AF6 EF 02            [ 2]  144     ldw (2,x),y 
      001AF8 90 AE 2C C8      [ 2]  145     ldw y,#11464 
      001AFC FF               [ 2]  146     ldw (x),y 
      001AFD 81               [ 4]  147     ret 
                                    148 
                                    149 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 86.
Hexadecimal [24-Bits]



                                   4441 .endif ; WANT_MATH_CONST
                                   4442 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 87.
Hexadecimal [24-Bits]



                                   4443         .include "flash.asm"
                                      1 ;;
                                      2 ; Copyright Jacques Deschênes 2019,2020 
                                      3 ; This file is part of stm8_eForth  
                                      4 ;
                                      5 ;     stm8_eForth is free software: you can redistribute it and/or modify
                                      6 ;     it under the terms of the GNU General Public License as published by
                                      7 ;     the Free Software Foundation, either version 3 of the License, or
                                      8 ;     (at your option) any later version.
                                      9 ;
                                     10 ;     stm8_eForth is distributed in the hope that it will be useful,
                                     11 ;     but WITHOUT ANY WARRANTY; without even the implied warranty of
                                     12 ;     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
                                     13 ;     GNU General Public License for more details.
                                     14 ;
                                     15 ;     You should have received a copy of the GNU General Public License
                                     16 ;     along with stm8_eForth.  If not, see <http://www.gnu.org/licenses/>.
                                     17 ;;
                                     18 
                                     19 
                                     20 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                     21 ;  routines to write to FLASH, EEPROM 
                                     22 ;  and OPTION 
                                     23 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                     24 
                                     25 
                                     26 ;--------------------------------
                                     27 ; initialize FPTR 
                                     28 ; FP!  ( ud -- )
                                     29 ;---------------------------------
      001AFE 1A EA                   30     .word LINK 
                           001B00    31     LINK=.
      001B00 03                      32     .byte 3 
      001B01 46 50 21                33     .ascii "FP!"
      001B04                         34 fptr_store:
      001B04 90 93            [ 1]   35     ldw y,x
      001B06 90 FE            [ 2]   36     ldw y,(y)
      001B08 90 9F            [ 1]   37     ld a,yl 
      001B0A B7 32            [ 1]   38     ld FPTR,a 
      001B0C 1C 00 02         [ 2]   39     addw x,#CELLL 
      001B0F 90 93            [ 1]   40     ldw y,x 
      001B11 90 FE            [ 2]   41     ldw y,(y)
      001B13 90 BF 33         [ 2]   42     ldw PTR16,y
      001B16 1C 00 02         [ 2]   43     addw x,#CELLL 
      001B19 81               [ 4]   44     ret 
                                     45 
                                     46 ;-----------------------------------
                                     47 ; return EEPROM base address 
                                     48 ; as a double 
                                     49 ;  EEPROM  ( -- ud )
                                     50 ;-----------------------------------
      001B1A 1B 00                   51     .word LINK 
                           001B1C    52 LINK=.
      001B1C 06                      53     .byte 6 
      001B1D 45 45 50 52 4F 4D       54     .ascii "EEPROM"
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 88.
Hexadecimal [24-Bits]



      001B23                         55 EEPROM: 
      001B23 90 AE 40 00      [ 2]   56     ldw y,#EEPROM_BASE
      001B27 1D 00 04         [ 2]   57     subw x,#2*CELLL 
      001B2A EF 02            [ 2]   58     ldw (2,x),y 
      001B2C 90 5F            [ 1]   59     clrw y 
      001B2E FF               [ 2]   60     ldw (x),y 
      001B2F 81               [ 4]   61     ret
                                     62 
                                     63 ;---------------------------------
                                     64 ; return APP_LAST pointer as double
                                     65 ; EEP-LAST ( -- ud )
                                     66 ;---------------------------------
      001B30 1B 1C                   67 	.word LINK 
                           001B32    68 	LINK=.
      001B32 08                      69 	.byte 8 
      001B33 45 45 50 2D 4C 41 53    70 	.ascii "EEP-LAST"
             54
      001B3B                         71 EEPLAST:
      001B3B 1D 00 04         [ 2]   72 	subw x,#2*CELLL 
      001B3E 90 AE 40 00      [ 2]   73 	ldw y,#APP_LAST 
      001B42 EF 02            [ 2]   74 	ldw (2,x),y 
      001B44 90 5F            [ 1]   75 	clrw y 
      001B46 FF               [ 2]   76 	ldw (x),y 
      001B47 81               [ 4]   77 	ret 
                                     78 
                                     79 ;----------------------------------
                                     80 ; return APP_RUN pointer as double	
                                     81 ; EEP-RUN ( -- ud )
                                     82 ;-----------------------------------
      001B48 1B 32                   83 	.word LINK 
                           001B4A    84 	LINK=.
      001B4A 07                      85 	.byte 7
      001B4B 45 45 50 2D 52 55 4E    86 	.ascii "EEP-RUN"
      001B52                         87 EEPRUN:
      001B52 1D 00 04         [ 2]   88 	subw x,#2*CELLL 
      001B55 90 AE 40 02      [ 2]   89 	ldw y,#APP_RUN 
      001B59 EF 02            [ 2]   90 	ldw (2,x),y 
      001B5B 90 5F            [ 1]   91 	clrw y 
      001B5D FF               [ 2]   92 	ldw (x),y 
      001B5E 81               [ 4]   93 	ret 
                                     94 
                                     95 ;------------------------------------
                                     96 ; return APP_CP pointer as double 
                                     97 ; EEP-CP ( -- ud )
                                     98 ;------------------------------------
      001B5F 1B 4A                   99 	.word LINK
                           001B61   100 	LINK=.
      001B61 06                     101 	.byte 6 
      001B62 45 45 50 2D 43 50      102 	.ascii "EEP-CP"
      001B68                        103 EEPCP:
      001B68 1D 00 04         [ 2]  104 	subw x,#2*CELLL 
      001B6B 90 AE 40 04      [ 2]  105 	ldw y,#APP_CP  
      001B6F EF 02            [ 2]  106 	ldw (2,x),y 
      001B71 90 5F            [ 1]  107 	clrw y 
      001B73 FF               [ 2]  108 	ldw (x),y 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 89.
Hexadecimal [24-Bits]



      001B74 81               [ 4]  109 	ret 
                                    110 
                                    111 ;------------------------------------
                                    112 ; return APP_VP pointer as double 
                                    113 ; EEP-VP ( -- ud )
                                    114 ;-------------------------------------
      001B75 1B 61                  115 	.word LINK
                           001B77   116 	LINK=.
      001B77 06                     117 	.byte 6
      001B78 45 45 50 2D 56 50      118 	.ascii "EEP-VP"
      001B7E                        119 EEPVP:
      001B7E 1D 00 04         [ 2]  120 	subw x,#2*CELLL 
      001B81 90 AE 40 06      [ 2]  121 	ldw y,#APP_VP  
      001B85 EF 02            [ 2]  122 	ldw (2,x),y 
      001B87 90 5F            [ 1]  123 	clrw y 
      001B89 FF               [ 2]  124 	ldw (x),y 
      001B8A 81               [ 4]  125 	ret 
                                    126 
                                    127 ;----------------------------------
                                    128 ; update APP_LAST with LAST 
                                    129 ; UPDAT-LAST ( -- )
                                    130 ;----------------------------------
      001B8B 1B 77                  131 	.word LINK 
                           001B8D   132 	LINK=.
      001B8D 0A                     133 	.byte 10
      001B8E 55 50 44 41 54 2D 4C   134 	.ascii "UPDAT-LAST"
             41 53 54
      001B98                        135 UPDATLAST:
      001B98 CD 06 4F         [ 4]  136 	call LAST
      001B9B CD 04 3C         [ 4]  137 	call AT  
      001B9E CD 1B 3B         [ 4]  138 	call EEPLAST
      001BA1 CC 1D 14         [ 2]  139 	jp ee_store 
                                    140 
                                    141 ;---------------------------------
                                    142 ; update APP_RUN 
                                    143 ; UPDAT-RUN ( a -- )
                                    144 ;---------------------------------
      001BA4 1B 8D                  145 	.word LINK
                           001BA6   146 	LINK=.
      001BA6 09                     147 	.byte 9
      001BA7 55 50 44 41 54 2D 52   148 	.ascii "UPDAT-RUN"
             55 4E
      001BB0                        149 UPDATRUN:
      001BB0 CD 1B 52         [ 4]  150 	call EEPRUN
      001BB3 CC 1D 14         [ 2]  151 	jp ee_store 
                                    152 	
                                    153 ;---------------------------------
                                    154 ; update APP_CP with CP 
                                    155 ; UPDAT-CP ( -- )
                                    156 ;---------------------------------
      001BB6 1B A6                  157 	.word LINK 
                           001BB8   158 	LINK=.
      001BB8 08                     159 	.byte 8 
      001BB9 55 50 44 41 54 2D 43   160 	.ascii "UPDAT-CP"
             50
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 90.
Hexadecimal [24-Bits]



      001BC1                        161 UPDATCP:
      001BC1 CD 06 3F         [ 4]  162 	call CPP 
      001BC4 CD 04 3C         [ 4]  163 	call AT 
      001BC7 CD 1B 68         [ 4]  164 	call EEPCP 
      001BCA CC 1D 14         [ 2]  165 	jp ee_store 
                                    166 
                                    167 ;----------------------------------
                                    168 ; update APP_VP with VP 
                                    169 ; UPDAT-VP ( -- )
                                    170 ;----------------------------------
      001BCD 1B B8                  171 	.word LINK
                           001BCF   172 	LINK=.
      001BCF 08                     173 	.byte 8 
      001BD0 55 50 44 41 54 2D 56   174 	.ascii "UPDAT-VP" 
             50
      001BD8                        175 UPDATVP:
      001BD8 CD 06 31         [ 4]  176 	call VPP 
      001BDB CD 04 3C         [ 4]  177 	call AT
      001BDE CD 1B 7E         [ 4]  178 	call EEPVP 
      001BE1 CC 1D 14         [ 2]  179 	jp ee_store
                                    180 	
                                    181 
                                    182 ;----------------------------------
                                    183 ; fetch integer at address over 65535
                                    184 ;  F@   ( ud -- n )
                                    185 ;----------------------------------
      001BE4 1B CF                  186     .word LINK 
                           001BE6   187 LINK=.
      001BE6 02                     188     .byte 2
      001BE7 46 40                  189     .ascii "F@"
      001BE9                        190 farat:
      001BE9 CD 1B 04         [ 4]  191     call fptr_store
      001BEC 92 BC 00 32      [ 5]  192     ldf a,[FPTR]
      001BF0 1D 00 02         [ 2]  193     subw x,#CELLL 
      001BF3 F7               [ 1]  194     ld (x),a 
      001BF4 90 AE 00 01      [ 2]  195     ldw y,#1
      001BF8 91 AF 00 32      [ 1]  196     ldf a,([FPTR],y)
      001BFC E7 01            [ 1]  197     ld (1,x),a
      001BFE 81               [ 4]  198     ret 
                                    199 
                                    200 ;-------------------------------------
                                    201 ; fetch C at address over 65535 
                                    202 ; FC@ ( ud -- c)
                                    203 ;-------------------------------------
      001BFF 1B E6                  204     .word LINK
                           001C01   205     LINK=.
      001C01 03                     206     .byte 3 
      001C02 46 43 40               207     .ascii "FC@" 
      001C05                        208 farcat:
      001C05 CD 1B 04         [ 4]  209     call fptr_store 
      001C08 92 BC 00 32      [ 5]  210     ldf a,[FPTR]
      001C0C 1D 00 02         [ 2]  211     subw x,#CELLL 
      001C0F E7 01            [ 1]  212     ld (1,x),a 
      001C11 7F               [ 1]  213     clr (x)
      001C12 81               [ 4]  214     ret 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 91.
Hexadecimal [24-Bits]



                                    215     
                                    216 ;----------------------------------
                                    217 ; unlock EEPROM/OPT for writing/erasing
                                    218 ; wait endlessly for FLASH_IAPSR_DUL bit.
                                    219 ;  UNLKEE   ( -- )
                                    220 ;----------------------------------
      001C13 1C 01                  221     .word LINK 
                           001C15   222 LINK=.
      001C15 06                     223     .byte 6 
      001C16 55 4E 4C 4B 45 45      224     .ascii "UNLKEE"
      001C1C                        225 unlock_eeprom:
      001C1C 35 00 50 5B      [ 1]  226 	mov FLASH_CR2,#0 
      001C20 35 FF 50 5C      [ 1]  227 	mov FLASH_NCR2,#0xFF 
      001C24 35 AE 50 64      [ 1]  228 	mov FLASH_DUKR,#FLASH_DUKR_KEY1
      001C28 35 56 50 64      [ 1]  229     mov FLASH_DUKR,#FLASH_DUKR_KEY2
      001C2C 72 07 50 5F FB   [ 2]  230 	btjf FLASH_IAPSR,#FLASH_IAPSR_DUL,.
      001C31 81               [ 4]  231 	ret
                                    232 
                                    233 ;----------------------------------
                                    234 ; unlock FLASH for writing/erasing
                                    235 ; wait endlessly for FLASH_IAPSR_PUL bit.
                                    236 ; UNLKFL  ( -- )
                                    237 ;----------------------------------
      001C32 1C 15                  238     .word LINK 
                           001C34   239 LINK=. 
      001C34 06                     240     .byte 6 
      001C35 55 4E 4C 4B 46 4C      241     .ascii "UNLKFL"    
      001C3B                        242 unlock_flash:
      001C3B 35 00 50 5B      [ 1]  243 	mov FLASH_CR2,#0 
      001C3F 35 FF 50 5C      [ 1]  244 	mov FLASH_NCR2,#0xFF 
      001C43 35 56 50 62      [ 1]  245 	mov FLASH_PUKR,#FLASH_PUKR_KEY1
      001C47 35 AE 50 62      [ 1]  246 	mov FLASH_PUKR,#FLASH_PUKR_KEY2
      001C4B 72 03 50 5F FB   [ 2]  247 	btjf FLASH_IAPSR,#FLASH_IAPSR_PUL,.
      001C50 81               [ 4]  248 	ret
                                    249 
                                    250 ;-----------------------------
                                    251 ; unlock FLASH or EEPROM 
                                    252 ; according to FPTR address 
                                    253 ;  UNLOCK ( -- )
                                    254 ;-----------------------------
      001C51 1C 34                  255 	.word LINK 
                           001C53   256 	LINK=.
      001C53 06                     257 	.byte 6
      001C54 55 4E 4C 4F 43 4B      258 	.ascii "UNLOCK"
      001C5A                        259 unlock:
                                    260 ; put addr[15:0] in Y, for bounds check.
      001C5A 90 BE 33         [ 2]  261 	ldw y,PTR16   ; Y=addr15:0
                                    262 ; check addr[23:16], if <> 0 then it is extened flash memory
      001C5D 3D 32            [ 1]  263 	tnz FPTR 
      001C5F 26 16            [ 1]  264 	jrne 4$
      001C61 90 A3 80 00      [ 2]  265     cpw y,#FLASH_BASE
      001C65 24 10            [ 1]  266     jruge 4$
      001C67 90 A3 40 00      [ 2]  267 	cpw y,#EEPROM_BASE  
      001C6B 25 0D            [ 1]  268     jrult 9$
      001C6D 90 A3 48 7F      [ 2]  269 	cpw y,#OPTION_END 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 92.
Hexadecimal [24-Bits]



      001C71 22 07            [ 1]  270 	jrugt 9$
      001C73 CD 1C 1C         [ 4]  271 	call unlock_eeprom
      001C76 81               [ 4]  272 	ret 
      001C77 CD 1C 3B         [ 4]  273 4$: call unlock_flash
      001C7A 81               [ 4]  274 9$: ret 
                                    275 
                                    276 ;-------------------------
                                    277 ; lock write access to 
                                    278 ; FLASH and EEPROM 
                                    279 ; LOCK ( -- )
                                    280 ;-------------------------
      001C7B 1C 53                  281 	.word LINK 
                           001C7D   282 	LINK=.
      001C7D 04                     283 	.byte 4 
      001C7E 4C 4F 43 4B            284 	.ascii "LOCK" 
      001C82                        285 lock: 
      001C82 72 13 50 5F      [ 1]  286 	bres FLASH_IAPSR,#FLASH_IAPSR_PUL
      001C86 72 17 50 5F      [ 1]  287 	bres FLASH_IAPSR,#FLASH_IAPSR_DUL
      001C8A 81               [ 4]  288 	ret 
                                    289 
                                    290 ;-------------------------
                                    291 ; increment FPTR 
                                    292 ; INC-FPTR ( -- )
                                    293 ;-------------------------
      001C8B 1C 7D                  294 	.word LINK 
                           001C8D   295 	LINK=. 
      001C8D 08                     296 	.byte 8 
      001C8E 49 4E 43 2D 46 50 54   297 	.ascii "INC-FPTR" 
             52
      001C96                        298 inc_fptr:
      001C96 3C 34            [ 1]  299 	inc PTR8 
      001C98 26 08            [ 1]  300 	jrne 1$
      001C9A 90 BE 32         [ 2]  301 	ldw y,FPTR 
      001C9D 90 5C            [ 2]  302 	incw y 
      001C9F 90 BF 32         [ 2]  303 	ldw FPTR,y 
      001CA2 81               [ 4]  304 1$: ret 
                                    305 
                                    306 
                                    307 ;----------------------------
                                    308 ; write a byte at address pointed 
                                    309 ; by FPTR and increment FPTR.
                                    310 ; Expect pointer already initialized 
                                    311 ; and memory unlocked 
                                    312 ; WR-BYTE ( c -- )
                                    313 ;----------------------------
                                    314 
      001CA3 1C 8D                  315 	.word LINK 
                           001CA5   316 	LINK=. 
      001CA5 07                     317 	.byte 7 
      001CA6 57 52 2D 42 59 54 45   318 	.ascii "WR-BYTE" 
                                    319 
      001CAD                        320 write_byte:
      001CAD 90 93            [ 1]  321 	ldw y,x 
      001CAF 90 FE            [ 2]  322 	ldw y,(y)
      001CB1 1C 00 02         [ 2]  323 	addw x,#CELLL 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 93.
Hexadecimal [24-Bits]



      001CB4 90 9F            [ 1]  324 	ld a,yl
      001CB6 92 BD 00 32      [ 4]  325 	ldf [FPTR],a
      001CBA 72 05 50 5F FB   [ 2]  326 	btjf FLASH_IAPSR,#FLASH_IAPSR_EOP,.
      001CBF 20 D5            [ 2]  327 	jra inc_fptr 
                                    328 
                                    329 
                                    330 
                                    331 ;---------------------------------------
                                    332 ; write a byte to FLASH or EEPROM/OPTION  
                                    333 ; EEC!  (c ud -- )
                                    334 ;---------------------------------------
      001CC1 1C A5                  335     .word LINK 
                           001CC3   336 	LINK=.
      001CC3 04                     337     .byte 4 
      001CC4 45 45 43 21            338     .ascii "EEC!"
                                    339 	; local variables 
                           000001   340 	BTW = 1   ; byte to write offset on stack
                           000002   341     OPT = 2 
                           000002   342 	VSIZE = 2
      001CC8                        343 ee_cstore:
      001CC8 52 02            [ 2]  344 	sub sp,#VSIZE
      001CCA CD 1B 04         [ 4]  345     call fptr_store
      001CCD E6 01            [ 1]  346 	ld a,(1,x)
      001CCF 43               [ 1]  347 	cpl a 
      001CD0 6B 01            [ 1]  348 	ld (BTW,sp),a ; byte to write 
      001CD2 0F 02            [ 1]  349 	clr (OPT,sp)  ; OPTION flag
      001CD4 CD 1C 5A         [ 4]  350 	call unlock 
                                    351 	; check if option
      001CD7 3D 32            [ 1]  352 	tnz FPTR 
      001CD9 26 19            [ 1]  353 	jrne 2$
      001CDB 90 BE 33         [ 2]  354 	ldw y,PTR16 
      001CDE 90 A3 48 00      [ 2]  355 	cpw y,#OPTION_BASE
      001CE2 2B 10            [ 1]  356 	jrmi 2$
      001CE4 90 A3 48 80      [ 2]  357 	cpw y,#OPTION_END+1
      001CE8 2A 0A            [ 1]  358 	jrpl 2$
      001CEA 03 02            [ 1]  359 	cpl (OPT,sp)
                                    360 	; OPTION WRITE require this unlock 
      001CEC 72 1E 50 5B      [ 1]  361     bset FLASH_CR2,#FLASH_CR2_OPT
      001CF0 72 1F 50 5C      [ 1]  362     bres FLASH_NCR2,#FLASH_CR2_OPT 
      001CF4                        363 2$: 
      001CF4 CD 1C AD         [ 4]  364 	call write_byte 	
      001CF7 0D 02            [ 1]  365 	tnz (OPT,sp)
      001CF9 27 0D            [ 1]  366 	jreq 3$ 
      001CFB 7B 01            [ 1]  367     ld a,(BTW,sp)
      001CFD 90 5F            [ 1]  368     clrw y
      001CFF 90 97            [ 1]  369 	ld yl,a 
      001D01 1D 00 02         [ 2]  370 	subw x,#CELLL 
      001D04 FF               [ 2]  371 	ldw (x),y 
      001D05 CD 1C AD         [ 4]  372 	call write_byte
      001D08                        373 3$: 
      001D08 CD 1C 82         [ 4]  374 	call lock 
      001D0B 5B 02            [ 2]  375 	addw sp,#VSIZE 
      001D0D 81               [ 4]  376     ret
                                    377 
                                    378 ;------------------------------
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 94.
Hexadecimal [24-Bits]



                                    379 ; write integer in FLASH|EEPROM
                                    380 ; EE! ( n ud -- )
                                    381 ;------------------------------
      001D0E 1C C3                  382 	.word LINK 
                           001D10   383 	LINK=.
      001D10 03                     384 	.byte 3 
      001D11 45 45 21               385 	.ascii "EE!"
      001D14                        386 ee_store:
      001D14 CD 1B 04         [ 4]  387 	call fptr_store 
      001D17 CD 1C 5A         [ 4]  388 	call unlock 
      001D1A 90 93            [ 1]  389 	ldw y,x 
      001D1C 90 FE            [ 2]  390 	ldw y,(y)
      001D1E 90 89            [ 2]  391 	pushw y 
      001D20 90 5E            [ 1]  392 	swapw y 
      001D22 FF               [ 2]  393 	ldw (x),y 
      001D23 CD 1C AD         [ 4]  394 	call write_byte 
      001D26 90 85            [ 2]  395 	popw y 
      001D28 1D 00 02         [ 2]  396 	subw x,#CELLL
      001D2B FF               [ 2]  397 	ldw (x),y 
      001D2C CD 1C AD         [ 4]  398 	call write_byte
      001D2F CC 1C 82         [ 2]  399 	jp lock 
                                    400 
                                    401 
                                    402 ;----------------------------
                                    403 ; Erase flash memory row 
                                    404 ; stm8s208 as 128 bytes rows
                                    405 ; ROW-ERASE ( ud -- )
                                    406 ;----------------------------
      001D32 1D 10                  407 	.word LINK 
                           001D34   408 	LINK=. 
      001D34 09                     409 	.byte 9 
      001D35 52 4F 57 2D 45 52 41   410 	.ascii "ROW-ERASE" 
             53 45
      001D3E                        411 row_erase:
      001D3E CD 1B 04         [ 4]  412 	call fptr_store
                                    413 ;code must be execute from RAM 
                                    414 ;copy routine to PAD 
      001D41 1D 00 02         [ 2]  415 	subw x,#CELLL 
      001D44 90 AE 1D 8B      [ 2]  416 	ldw y,#row_erase_proc
      001D48 FF               [ 2]  417 	ldw (x),y 
      001D49 CD 0B 43         [ 4]  418 	call PAD 
      001D4C 90 AE 1D B2      [ 2]  419 	ldw y,#row_erase_proc_end 
      001D50 72 A2 1D 8B      [ 2]  420 	subw y,#row_erase_proc
      001D54 1D 00 02         [ 2]  421 	subw x,#CELLL 
      001D57 FF               [ 2]  422 	ldw (x),y 
      001D58 CD 0B 7F         [ 4]  423 	call CMOVE 
      001D5B                        424 block_erase:
      001D5B 90 BE 33         [ 2]  425 	ldw y,FPTR+1
      001D5E 90 A3 22 00      [ 2]  426 	cpw y,#app_space 
      001D62 2A 13            [ 1]  427 	jrpl erase_flash 
                                    428 ; erase EEPROM block
      001D64 90 A3 40 00      [ 2]  429 	cpw y,#EEPROM_BASE 
      001D68 24 01            [ 1]  430 	jruge 1$
      001D6A 81               [ 4]  431 	ret ; bad address 
      001D6B 90 A3 47 FF      [ 2]  432 1$: cpw y,#EEPROM_END 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 95.
Hexadecimal [24-Bits]



      001D6F 23 01            [ 2]  433 	jrule 2$ 
      001D71 81               [ 4]  434 	ret ; bad address 
      001D72                        435 2$:	
      001D72 CD 1C 1C         [ 4]  436 	call unlock_eeprom 
      001D75 20 03            [ 2]  437 	jra proceed_erase
                                    438 ; erase flash block:
      001D77                        439 erase_flash:
      001D77 CD 1C 3B         [ 4]  440 	call unlock_flash 
      001D7A                        441 proceed_erase:
      001D7A CD 0B 43         [ 4]  442 	call PAD 
      001D7D 90 93            [ 1]  443 	ldw y,x
      001D7F 90 FE            [ 2]  444 	ldw y,(y)
      001D81 1C 00 02         [ 2]  445 	addw x,#CELLL  
      001D84 90 FD            [ 4]  446 	call (y) 
      001D86 72 17 50 5F      [ 1]  447 	bres FLASH_IAPSR,#FLASH_IAPSR_DUL
      001D8A 81               [ 4]  448 	ret 
                                    449 
                                    450 ; this routine is to be copied to PAD 
      001D8B                        451 row_erase_proc:
      001D8B 35 20 50 5B      [ 1]  452 	mov FLASH_CR2,#(1<<FLASH_CR2_ERASE) 
      001D8F 35 DF 50 5C      [ 1]  453 	mov FLASH_NCR2,#~(1<<FLASH_CR2_ERASE)
      001D93 4F               [ 1]  454 	clr a 
      001D94 90 5F            [ 1]  455 	clrw y 
      001D96 91 A7 00 32      [ 1]  456 	ldf ([FPTR],y),a
      001D9A 90 5C            [ 2]  457     incw y
      001D9C 91 A7 00 32      [ 1]  458 	ldf ([FPTR],y),a
      001DA0 90 5C            [ 2]  459     incw y
      001DA2 91 A7 00 32      [ 1]  460 	ldf ([FPTR],y),a
      001DA6 90 5C            [ 2]  461     incw y
      001DA8 91 A7 00 32      [ 1]  462 	ldf ([FPTR],y),a
      001DAC 72 05 50 5F FB   [ 2]  463 	btjf FLASH_IAPSR,#FLASH_IAPSR_EOP,.
      001DB1 81               [ 4]  464 	ret
      001DB2                        465 row_erase_proc_end:
                                    466 
                                    467 
                                    468 ;-----------------------------------
                                    469 ; block programming must be 
                                    470 ; executed from RAM 
                                    471 ; initial contidions: 
                                    472 ; 		memory unlocked
                                    473 ;       FPTR initialized 
                                    474 ; input: 
                                    475 ;    x   buffer address 
                                    476 ;-----------------------------------
                           000001   477 	BCNT=1 
      001DB2                        478 copy_buffer:
      001DB2 4B 80            [ 1]  479 	push #BLOCK_SIZE  
                                    480 ;enable block programming 
      001DB4 72 10 50 5B      [ 1]  481 	bset FLASH_CR2,#FLASH_CR2_PRG 
      001DB8 72 11 50 5C      [ 1]  482 	bres FLASH_NCR2,#FLASH_CR2_PRG
      001DBC 90 5F            [ 1]  483 	clrw y
      001DBE F6               [ 1]  484 1$:	ld a,(x)
      001DBF 91 A7 00 32      [ 1]  485 	ldf ([FPTR],y),a
      001DC3 5C               [ 2]  486 	incw x 
      001DC4 90 5C            [ 2]  487 	incw y 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 96.
Hexadecimal [24-Bits]



      001DC6 0A 01            [ 1]  488 	dec (BCNT,sp)
      001DC8 26 F4            [ 1]  489 	jrne 1$
                                    490 ; wait EOP bit 
      001DCA 72 05 50 5F FB   [ 2]  491 	btjf FLASH_IAPSR,#FLASH_IAPSR_EOP,. 
      001DCF 84               [ 1]  492 	pop a ; remove BCNT from stack 
      001DD0 81               [ 4]  493 	ret 
      001DD1                        494 copy_buffer_end:
                                    495 
                                    496 ;-------------------------
                                    497 ; move program_row to RAM 
                                    498 ; in TIB 
                                    499 ;------------------------
      001DD1                        500 copy_prog_to_ram:
      001DD1 1D 00 06         [ 2]  501 	subw x,#6
      001DD4 90 AE 1D B2      [ 2]  502 	ldw y,#copy_buffer 
      001DD8 EF 04            [ 2]  503 	ldw (4,x),y 
      001DDA 90 AE 17 00      [ 2]  504 	ldw y,#TIBBASE
      001DDE EF 02            [ 2]  505 	ldw (2,x),y 
      001DE0 90 AE 1D D1      [ 2]  506 	ldw y,#copy_buffer_end 
      001DE4 72 A2 1D B2      [ 2]  507 	subw y,#copy_buffer  
      001DE8 FF               [ 2]  508 	ldw (x),y 
      001DE9 CD 0B 7F         [ 4]  509 	call CMOVE 
      001DEC 81               [ 4]  510 	ret 
                                    511 
                                    512 
                                    513 ;-----------------------------
                                    514 ; write a row in FLASH/EEPROM 
                                    515 ; WR-ROW ( a ud -- )
                                    516 ; a -> address 128 byte buffer to write 
                                    517 ; ud ->  row address in FLASH|EEPROM 
                                    518 ;-----------------------------
      001DED 1D 34                  519 	.word LINK 
                           001DEF   520 	LINK=.
      001DEF 06                     521 	.byte 6 
      001DF0 57 52 2D 52 4F 57      522 	.ascii "WR-ROW"
      001DF6                        523 write_row:
      001DF6 CD 1B 04         [ 4]  524 	call fptr_store
                                    525 ; align to FLASH block 
      001DF9 A6 80            [ 1]  526 	ld a,#0x80 
      001DFB B4 34            [ 1]  527 	and a,PTR8 
      001DFD B7 34            [ 1]  528 	ld PTR8,a  
      001DFF CD 1D D1         [ 4]  529 	call copy_prog_to_ram
      001E02 CD 1C 5A         [ 4]  530 	call unlock
      001E05 90 93            [ 1]  531 	ldw y,x 
      001E07 90 FE            [ 2]  532 	ldw y,(y)
      001E09 1C 00 02         [ 2]  533 	addw x,#CELLL 
      001E0C 89               [ 2]  534 	pushw x 
      001E0D 93               [ 1]  535 	ldw x,y ; buffer address in x 
      001E0E CD 17 00         [ 4]  536 	call TIBBASE
      001E11 CD 1C 82         [ 4]  537 	call lock
      001E14 85               [ 2]  538 	popw x 
      001E15 81               [ 4]  539 	ret 
                                    540 
                                    541 ;-------------------------------------
                                    542 ; change value of OPTION register 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 97.
Hexadecimal [24-Bits]



                                    543 ; SET-OPT (c n -- ) 
                                    544 ; c new value.
                                    545 ; n OPT  number {1..7}
                                    546 ;--------------------------------------
      001E16 1D EF                  547 		.word LINK 
                           001E18   548 		LINK=.
      001E18 07                     549 		.byte 7 
      001E19 53 45 54 2D 4F 50 54   550 		.ascii "SET-OPT" 
      001E20                        551 set_option: 
      001E20 90 93            [ 1]  552 		ldw y,x 
      001E22 90 FE            [ 2]  553 		ldw y,(y)
      001E24 27 06            [ 1]  554 		jreq 1$
      001E26 90 A3 00 07      [ 2]  555 		cpw y,#7 
      001E2A 23 04            [ 2]  556 		jrule 2$ 
                                    557 ; invalid OPTION number 		
      001E2C 1C 00 04         [ 2]  558 1$:		addw x,#2*CELLL
      001E2F 81               [ 4]  559 		ret
      001E30 90 58            [ 2]  560 2$:		sllw y 
      001E32 72 A9 47 FF      [ 2]  561 		addw y,#OPTION_BASE-1
      001E36 FF               [ 2]  562 		ldw (x),y 
      001E37 1D 00 02         [ 2]  563 		subw x,#CELLL 
      001E3A 90 5F            [ 1]  564 		clrw y 
      001E3C FF               [ 2]  565 		ldw (x),y 
      001E3D CD 1C C8         [ 4]  566 		call ee_cstore
      001E40 81               [ 4]  567 		ret 
                                    568 
                                    569 
                                    570 
                                    571 ;--------------------------------------
                                    572 ; reset system to its original state 
                                    573 ; before any user modification
                                    574 ; PRISTINE ( -- )
                                    575 ;-------------------------------------
      001E41 1E 18                  576 	.word LINK  
                           001E43   577 	LINK=.
      001E43 08                     578 	.byte 8 
      001E44 50 52 49 53 54 49 4E   579 	.ascii "PRISTINE"
             45
      001E4C                        580 pristine:
                                    581 ;;; erase EEPROM
      001E4C CD 1B 23         [ 4]  582 	call EEPROM 
      001E4F CD 06 C9         [ 4]  583 1$:	call DDUP 
      001E52 CD 1D 3E         [ 4]  584 	call row_erase
      001E55 90 93            [ 1]  585 	ldw y,x 
      001E57 90 EE 02         [ 2]  586 	ldw y,(2,y)
      001E5A 72 A9 00 80      [ 2]  587 	addw y,#BLOCK_SIZE
      001E5E EF 02            [ 2]  588 	ldw (2,x),y
      001E60 90 A3 48 00      [ 2]  589 	cpw y,#OPTION_BASE 
      001E64 25 E9            [ 1]  590 	jrult 1$
                                    591 ;;; reset OPTION to default values
      001E66 90 AE 00 01      [ 2]  592 	ldw y,#1 ; OPT1 
      001E6A FF               [ 2]  593 2$:	ldw (x),y   
      001E6B 90 5F            [ 1]  594 	clrw y 
      001E6D EF 02            [ 2]  595 	ldw (2,x),y  ; ( 0 1 -- ) 
      001E6F CD 06 C9         [ 4]  596 	call DDUP    ; ( 0 1 0 1 -- )  
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 98.
Hexadecimal [24-Bits]



      001E72 CD 1E 20         [ 4]  597 	call set_option
      001E75 90 93            [ 1]  598 	ldw y,x 
      001E77 90 FE            [ 2]  599 	ldw y,(y)
      001E79 90 5C            [ 2]  600 	incw y  ; next OPTION 
      001E7B 90 A3 00 08      [ 2]  601 	cpw y,#8 
      001E7F 25 E9            [ 1]  602 	jrult 2$
                                    603 ;;; erase first row of app_space 	
      001E81 90 AE 22 00      [ 2]  604 	ldw y,#app_space
      001E85 EF 02            [ 2]  605 	ldw (2,x),y  
      001E87 90 5F            [ 1]  606 	clrw y 
      001E89 FF               [ 2]  607 	ldw (x),y ; ( app_space 0 -- )
      001E8A CD 1D 3E         [ 4]  608 	call row_erase 
                                    609 ; reset interrupt vectors 
      001E8D 1D 00 02         [ 2]  610 	subw x,#CELLL 
      001E90 90 5F            [ 1]  611 	clrw y  
      001E92 FF               [ 2]  612 4$:	ldw (x),y  ; ( n -- ) int# 
      001E93 CD 04 E3         [ 4]  613 	call DUPP  
      001E96 CD 1E B3         [ 4]  614 	call reset_vector
      001E99 90 93            [ 1]  615 	ldw y,x 
      001E9B 90 FE            [ 2]  616 	ldw y,(y)
      001E9D 90 5C            [ 2]  617 	incw y   ; next vector 
      001E9F 90 A3 00 19      [ 2]  618 	cpw y,#25 
      001EA3 25 ED            [ 1]  619 	jrult 4$
      001EA5 CC 00 00         [ 2]  620 	jp NonHandledInterrupt ; reset MCU
                                    621 
                                    622 ;------------------------------
                                    623 ; reset an interrupt vector 
                                    624 ; to its initial value 
                                    625 ; i.e. NonHandledInterrupt
                                    626 ; RST-IVEC ( n -- )
                                    627 ;-----------------------------
      001EA8 1E 43                  628 	.word LINK 
                           001EAA   629 	LINK=. 
      001EAA 08                     630 	.byte 8 
      001EAB 52 53 54 2D 49 56 45   631 	.ascii "RST-IVEC"
             43
      001EB3                        632 reset_vector:
      001EB3 90 93            [ 1]  633 	ldw y,x
      001EB5 1C 00 02         [ 2]  634 	addw x,#CELLL 
      001EB8 90 FE            [ 2]  635 	ldw y,(y)
      001EBA 90 A3 00 17      [ 2]  636 	cpw y,#23 
      001EBE 27 3A            [ 1]  637 	jreq 9$
      001EC0 90 A3 00 1D      [ 2]  638 	cpw y,#29 ; last vector
      001EC4 22 34            [ 1]  639 	jrugt 9$  
      001EC6 90 58            [ 2]  640 	sllw y 
      001EC8 90 58            [ 2]  641 	sllw y 
      001ECA 72 A9 80 08      [ 2]  642 	addw y,#0x8008 ; irq0 address 
      001ECE 90 BF 24         [ 2]  643 	ldw YTEMP,y
      001ED1 1D 00 06         [ 2]  644 	subw x,#3*CELLL 
      001ED4 EF 02            [ 2]  645 	ldw (2,x),y 
      001ED6 90 5F            [ 1]  646 	clrw y
      001ED8 FF               [ 2]  647 	ldw (x),y 
      001ED9 A6 82            [ 1]  648 	ld a,#0x82 
      001EDB 90 95            [ 1]  649 	ld yh,a
      001EDD EF 04            [ 2]  650 	ldw (4,x),y
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 99.
Hexadecimal [24-Bits]



      001EDF CD 1D 14         [ 4]  651 	call ee_store
      001EE2 1D 00 06         [ 2]  652 	subw x,#3*CELLL
      001EE5 90 5F            [ 1]  653 	clrw y 
      001EE7 FF               [ 2]  654 	ldw (x),y 
      001EE8 90 AE 00 00      [ 2]  655 	ldw y,#NonHandledInterrupt
      001EEC EF 04            [ 2]  656 	ldw (4,x),y 
      001EEE 90 BE 24         [ 2]  657 	ldw y,YTEMP  
      001EF1 72 A9 00 02      [ 2]  658 	addw y,#2
      001EF5 EF 02            [ 2]  659 	ldw (2,x),y 
      001EF7 CD 1D 14         [ 4]  660 	call ee_store
      001EFA 81               [ 4]  661 9$:	ret 
                                    662 
                                    663 
                                    664 ;------------------------------
                                    665 ; all interrupt vector with 
                                    666 ; an address >= a are resetted 
                                    667 ; to default
                                    668 ; CHKIVEC ( a -- )
                                    669 ;------------------------------
      001EFB 1E AA                  670 	.word LINK 
                           001EFD   671 	LINK=.
      001EFD 07                     672 	.byte 7
      001EFE 43 48 4B 49 56 45 43   673 	.ascii "CHKIVEC"
                                    674 ;local variables 
                           000001   675 	SSP=1
                           000003   676 	CADR=3
                           000005   677 	OFS=5
                           000006   678 	VSIZE=6  
      001F05                        679 CHKIVEC:
      001F05 52 06            [ 2]  680 	sub sp,#VSIZE ;alloc local variables 
      001F07 90 93            [ 1]  681 	ldw y,x 
      001F09 90 FE            [ 2]  682 	ldw y,(y)
      001F0B 17 03            [ 2]  683 	ldw (CADR,sp),y ; ca 
      001F0D 1F 01            [ 2]  684 	ldw (SSP,sp),x 
      001F0F AE 80 0A         [ 2]  685 	ldw x,#0x800a ; irq0 address 
      001F12 BF 33            [ 2]  686 	ldw PTR16,X
      001F14 AE FF FC         [ 2]  687 	ldw x,#-4 
      001F17 1C 00 04         [ 2]  688 1$:	addw x,#4
      001F1A A3 00 78         [ 2]  689 	cpw x,#30*4 ; irq0-29 
      001F1D 27 22            [ 1]  690 	jreq 9$
      001F1F 90 93            [ 1]  691 	ldw y,x  
      001F21 91 D6 33         [ 4]  692 	ld a,([PTR16],y)
      001F24 11 03            [ 1]  693 	cp a,(CADR,sp)
      001F26 25 EF            [ 1]  694 	jrult 1$
      001F28 90 5C            [ 2]  695 	incw y 
      001F2A 91 D6 33         [ 4]  696 	ld a,([PTR16],y)
      001F2D 11 04            [ 1]  697 	cp a,(CADR+1,sp) 
      001F2F 25 E6            [ 1]  698 	jrult 1$ 
      001F31 1F 05            [ 2]  699 	ldw (OFS,sp),x 
      001F33 54               [ 2]  700 	srlw x
      001F34 54               [ 2]  701 	srlw x 
      001F35 90 93            [ 1]  702 	ldw y,x 
      001F37 1E 01            [ 2]  703 	ldw x,(SSP,sp)
      001F39 FF               [ 2]  704 	ldw (x),y
      001F3A CD 1E B3         [ 4]  705 	call reset_vector
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 100.
Hexadecimal [24-Bits]



      001F3D 1E 05            [ 2]  706 	ldw x,(OFS,sp) 
      001F3F 20 D6            [ 2]  707 	jra 1$
      001F41 1E 01            [ 2]  708 9$:	ldw x,(SSP,sp) 
      001F43 1C 00 02         [ 2]  709 	addw x,#CELLL 
      001F46 5B 06            [ 2]  710 	addw sp,#VSIZE ; drop local variables  
      001F48 81               [ 4]  711 	ret 
                                    712 
                                    713 ;------------------------------
                                    714 ; set interrupt vector 
                                    715 ; SET-IVEC ( ud n -- )
                                    716 ;  ud Handler address
                                    717 ;  n  vector # 0 .. 29 
                                    718 ;-----------------------------
      001F49 1E FD                  719 	.word LINK
                           001F4B   720 	LINK=.
      001F4B 08                     721 	.byte 8 
      001F4C 53 45 54 2D 49 56 45   722 	.ascii "SET-IVEC" 
             43
      001F54                        723 set_vector:
      001F54 90 93            [ 1]  724     ldw y,x 
      001F56 1C 00 02         [ 2]  725 	addw x,#CELLL 
      001F59 90 FE            [ 2]  726 	ldw y,(y) ; vector #
      001F5B 90 A3 00 1D      [ 2]  727 	cpw y,#29 ; last vector
      001F5F 23 04            [ 2]  728 	jrule 2$
      001F61 1C 00 04         [ 2]  729 	addw x,#2*CELLL 
      001F64 81               [ 4]  730 	ret
      001F65 90 58            [ 2]  731 2$:	sllw y 
      001F67 90 58            [ 2]  732 	sllw y 
      001F69 72 A9 80 08      [ 2]  733 	addw y,#0X8008 ; IRQ0 vector address 
      001F6D 90 BF 24         [ 2]  734 	ldw YTEMP,y ; vector address 
      001F70 A6 82            [ 1]  735 	ld a,#0x82 
      001F72 90 95            [ 1]  736 	ld yh,a 
      001F74 E6 01            [ 1]  737 	ld a,(1,x) ; isr address bits 23..16 
      001F76 90 97            [ 1]  738 	ld yl,a 
                                    739 ;  write 0x82 + most significant byte of int address	
      001F78 1D 00 06         [ 2]  740 	subw x,#3*CELLL 
      001F7B EF 04            [ 2]  741 	ldw (4,x),y 
      001F7D 90 BE 24         [ 2]  742 	ldw y,YTEMP
      001F80 EF 02            [ 2]  743 	ldw (2,x),y ; vector address 
      001F82 90 5F            [ 1]  744 	clrw y 
      001F84 FF               [ 2]  745 	ldw (x),y   ; as a double 
      001F85 CD 1D 14         [ 4]  746 	call ee_store 
      001F88 90 93            [ 1]  747 	ldw y,x 
      001F8A 90 EE 02         [ 2]  748 	ldw y,(2,y) ; bits 15..0 int vector 
      001F8D 1D 00 06         [ 2]  749 	subw x,#3*CELLL 
      001F90 EF 04            [ 2]  750 	ldw (4,x),y 
      001F92 90 BE 24         [ 2]  751 	ldw y,YTEMP 
      001F95 72 A9 00 02      [ 2]  752 	addw y,#2 
      001F99 EF 02            [ 2]  753 	ldw (2,x),y 
      001F9B 90 5F            [ 1]  754 	clrw y 
      001F9D FF               [ 2]  755 	ldw (x),y 
      001F9E CD 1D 14         [ 4]  756 	call ee_store
      001FA1 1C 00 04         [ 2]  757 	addw x,#2*CELLL  
      001FA4 81               [ 4]  758 9$: ret 
                                    759 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 101.
Hexadecimal [24-Bits]



                                    760 
                                    761 ;------------------------
                                    762 ; Compile word to flash
                                    763 ; EE, (w -- )
                                    764 ;-----------------------
      001FA5 1F 4B                  765 	.word LINK
                           001FA7   766 	LINK=.
      001FA7 03                     767 	.byte 3
      001FA8 45 45 2C               768 	.ascii "EE,"
      001FAB                        769 ee_comma:
      001FAB 1D 00 04         [ 2]  770 	subw x,#2*CELLL 
      001FAE 90 BE 18         [ 2]  771 	ldw y,UCP
      001FB1 90 89            [ 2]  772 	pushw y 
      001FB3 EF 02            [ 2]  773 	ldw (2,x),y 
      001FB5 90 5F            [ 1]  774 	clrw y 
      001FB7 FF               [ 2]  775 	ldw (x),y
      001FB8 CD 1D 14         [ 4]  776 	call ee_store
      001FBB 90 85            [ 2]  777 	popw y 
      001FBD 72 A9 00 02      [ 2]  778 	addw y,#2
      001FC1 90 BF 18         [ 2]  779 	ldw UCP,y
      001FC4 81               [ 4]  780 	ret 
                                    781 
                                    782 
                                    783 ;-------------------------
                                    784 ; Compile byte to flash 
                                    785 ; EEC, ( c -- )	
                                    786 ;-------------------------
      001FC5 1F A7                  787 	.word LINK 
                           001FC7   788 	LINK=.
      001FC7 04                     789 	.byte 4 
      001FC8 45 45 43 2C            790 	.ascii "EEC,"
      001FCC                        791 ee_ccomma:
      001FCC 1D 00 04         [ 2]  792 	subw x,#2*CELLL 
      001FCF 90 BE 18         [ 2]  793 	ldw y,UCP
      001FD2 90 89            [ 2]  794 	pushw y 
      001FD4 EF 02            [ 2]  795 	ldw (2,x),y 
      001FD6 90 5F            [ 1]  796 	clrw y 
      001FD8 FF               [ 2]  797 	ldw (x),y
      001FD9 CD 1C C8         [ 4]  798 	call ee_cstore
      001FDC 90 85            [ 2]  799 	popw y 
      001FDE 90 5C            [ 2]  800 	incw y 
      001FE0 90 BF 18         [ 2]  801 	ldw UCP,y
      001FE3 81               [ 4]  802 	ret 
                                    803 
                                    804 
                                    805 ;--------------------------
                                    806 ; copy FLASH block to ROWBUF
                                    807 ; ROW2BUF ( ud -- )
                                    808 ;--------------------------
      001FE4 1F C7                  809 	.word LINK 
                           001FE6   810 	LINK=.
      001FE6 07                     811 	.byte 7 
      001FE7 52 4F 57 32 42 55 46   812 	.ascii "ROW2BUF"
      001FEE                        813 ROW2BUF: 
      001FEE CD 1B 04         [ 4]  814 	call fptr_store 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 102.
Hexadecimal [24-Bits]



      001FF1 A6 80            [ 1]  815 	ld a,#BLOCK_SIZE
      001FF3 88               [ 1]  816 	push a 
      001FF4 B4 34            [ 1]  817 	and a,PTR8 ; block align 
      001FF6 B7 34            [ 1]  818 	ld PTR8,a
      001FF8 90 AE 16 80      [ 2]  819 	ldw y,#ROWBUFF 
      001FFC 92 BC 00 32      [ 5]  820 1$: ldf a,[FPTR]
      002000 90 F7            [ 1]  821 	ld (y),a
      002002 CD 1C 96         [ 4]  822 	call inc_fptr
      002005 90 5C            [ 2]  823 	incw y 
      002007 0A 01            [ 1]  824 	dec (1,sp)
      002009 26 F1            [ 1]  825 	jrne 1$ 
      00200B 84               [ 1]  826 	pop a 
      00200C 81               [ 4]  827 	ret 
                                    828 
                                    829 
                                    830 ;---------------------------
                                    831 ; copy ROWBUFF to flash 
                                    832 ; BUF2ROW ( ud -- )
                                    833 ; ud is row address as double 
                                    834 ;---------------------------
      00200D 1F E6                  835 	.word LINK 
                           00200F   836 	LINK=.
      00200F 07                     837 	.byte 7 
      002010 42 55 46 32 52 4F 57   838 	.ascii "BUF2ROW" 
      002017                        839 BUF2ROW:
      002017 CD 05 DE         [ 4]  840 	call TBUF ; ( ud rb -- )
      00201A CD 06 9E         [ 4]  841 	call ROT 
      00201D CD 06 9E         [ 4]  842 	call ROT  ; ( rb ud -- )
      002020 CD 1D F6         [ 4]  843 	call write_row 
      002023 81               [ 4]  844 	ret 
                                    845 
                                    846 ;---------------------------------
                                    847 ; how many byte free in that row 
                                    848 ; RFREE ( a -- n )
                                    849 ; a is least byte of target address
                                    850 ;----------------------------------
      002024 20 0F                  851 	.word LINK 
                           002026   852 	LINK=.
      002026 05                     853 	.byte 5 
      002027 52 46 52 45 45         854 	.ascii "RFREE"
      00202C                        855 RFREE:
      00202C E6 01            [ 1]  856 	ld a,(1,x)
      00202E A4 7F            [ 1]  857 	and a,#BLOCK_SIZE-1 
      002030 B7 24            [ 1]  858 	ld YTEMP,a 
      002032 A6 80            [ 1]  859 	ld a,#BLOCK_SIZE 
      002034 B0 24            [ 1]  860 	sub a,YTEMP 
      002036 90 5F            [ 1]  861 	clrw y 
      002038 90 97            [ 1]  862 	ld yl,a
      00203A FF               [ 2]  863 	ldw (x),y 
      00203B 81               [ 4]  864 	ret 
                                    865 
                                    866 ;---------------------------------
                                    867 ; write u bytes to flash/EEPROM 
                                    868 ; constraint to row limit 
                                    869 ; RAM2EE ( ud a u -- u2 )
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 103.
Hexadecimal [24-Bits]



                                    870 ; ud flash address 
                                    871 ; a ram address 
                                    872 ; u bytes count
                                    873 ; return u2 bytes written  
                                    874 ;-------------------------------
      00203C 20 26                  875 	.word LINK 
                           00203E   876 	LINK=. 
      00203E 06                     877 	.byte 6
      00203F 52 41 4D 32 45 45      878 	.ascii "RAM2EE"
                                    879 	
      002045                        880 RAM2EE:
                                    881 ; copy ud on top 
      002045 90 93            [ 1]  882 	ldw y,x 
      002047 90 EE 06         [ 2]  883 	ldw y,(6,y) ; LSW of ud  
      00204A 90 BF 24         [ 2]  884 	ldw YTEMP,y 
      00204D 90 93            [ 1]  885 	ldw y,x 
      00204F 90 EE 04         [ 2]  886 	ldw y,(4,y)  ; MSW of ud 
      002052 1D 00 04         [ 2]  887 	subw x,#2*CELLL 
      002055 FF               [ 2]  888 	ldw (x),y 
      002056 90 BE 24         [ 2]  889 	ldw y,YTEMP 
      002059 EF 02            [ 2]  890 	ldw (2,x),y 
      00205B CD 1F EE         [ 4]  891 	call ROW2BUF 
      00205E 90 93            [ 1]  892 	ldw y,x 
      002060 90 EE 06         [ 2]  893 	ldw y,(6,y)
      002063 90 89            [ 2]  894 	pushw y ; udl 
      002065 90 9F            [ 1]  895 	ld a,yl
      002067 A4 7F            [ 1]  896 	and a,#BLOCK_SIZE-1 
      002069 90 5F            [ 1]  897 	clrw y 
      00206B 90 97            [ 1]  898 	ld yl,a 
      00206D 72 A9 16 80      [ 2]  899 	addw y,#ROWBUFF 
      002071 1D 00 02         [ 2]  900 	subw x,#CELLL 
      002074 FF               [ 2]  901 	ldw (x),y  
      002075 CD 04 F3         [ 4]  902 	call SWAPP ;  ( ud a ra u -- )
      002078 CD 04 8D         [ 4]  903 	call RFROM  
      00207B CD 20 2C         [ 4]  904 	call RFREE 
      00207E CD 07 F9         [ 4]  905 	call MIN
      002081 CD 04 E3         [ 4]  906 	call DUPP 
      002084 CD 04 AC         [ 4]  907 	call TOR  
      002087 CD 0B 7F         [ 4]  908 	call CMOVE
      00208A CD 20 17         [ 4]  909 	call BUF2ROW 
      00208D CD 04 8D         [ 4]  910 	call RFROM 
      002090 81               [ 4]  911 	ret 
                                    912 
                                    913 ;--------------------------
                                    914 ; expand 16 bit address 
                                    915 ; to 32 bit address 
                                    916 ; FADDR ( a -- ud )
                                    917 ;--------------------------
      002091 20 3E                  918 	.word LINK 
                           002093   919 	LINK=. 
      002093 05                     920 	.byte 5 
      002094 46 41 44 44 52         921 	.ascii "FADDR"
      002099                        922 FADDR:
      002099 CC 0A 44         [ 2]  923 	jp ZERO 
                                    924 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 104.
Hexadecimal [24-Bits]



                                    925 ;--------------------------
                                    926 ; move new colon definition to FLASH 
                                    927 ; using WR-ROW for efficiency 
                                    928 ; preserving bytes already used 
                                    929 ; in the current block. 
                                    930 ; ud+c must not exceed block boundary 
                                    931 ; at this point the compiler as completed
                                    932 ; in RAM and pointers CP and CNTXT updated.
                                    933 ; CNTXT point to nfa of new word and  
                                    934 ; CP is after compiled word so CP-CNTXT+2=count to write 
                                    935 ; 
                                    936 ; FMOVE ( -- cp+ )
                                    937 ; 
                                    938 ;--------------------------
      00209C 20 93                  939 	.word LINK 
                           00209E   940 	LINK=.
      00209E 05                     941 	.byte 5 
      00209F 46 4D 4F 56 45         942 	.ascii "FMOVE" 
      0020A4                        943 FMOVE:
      0020A4 CD 05 F0         [ 4]  944 	call TFLASH 
      0020A7 CD 04 3C         [ 4]  945 	CALL AT 
      0020AA CD 03 E7         [ 4]  946 	CALL QBRAN 
      0020AD 21 28                  947 	.word no_move  
      0020AF CD 06 3F         [ 4]  948 	call CPP
      0020B2 CD 04 3C         [ 4]  949 	call AT  
      0020B5 CD 04 E3         [ 4]  950 	call DUPP ; ( udl udl -- )
      0020B8 CD 06 23         [ 4]  951 	call CNTXT 
      0020BB CD 04 3C         [ 4]  952 	call AT 
      0020BE CD 03 B4         [ 4]  953 	call DOLIT 
      0020C1 00 02                  954 	.word 2 
      0020C3 CD 07 57         [ 4]  955 	call SUBB ; ( udl udl a -- )
      0020C6 CD 04 F3         [ 4]  956 	call SWAPP 
      0020C9 CD 20 99         [ 4]  957 	call FADDR 
      0020CC CD 06 9E         [ 4]  958 	call ROT  ; ( udl ud a -- )
      0020CF CD 04 E3         [ 4]  959 	call DUPP 
      0020D2 CD 04 AC         [ 4]  960 	call TOR    ; R: a 
      0020D5                        961 FMOVE2: 
      0020D5 CD 0B 32         [ 4]  962 	call HERE 
      0020D8 CD 04 A0         [ 4]  963 	call RAT 
      0020DB CD 07 57         [ 4]  964 	call SUBB ; (udl ud a wl -- )
      0020DE                        965 next_row:
      0020DE CD 04 E3         [ 4]  966 	call DUPP 
      0020E1 CD 04 AC         [ 4]  967 	call TOR  ; ( udl ud a wl -- ) R: a wl
      0020E4 CD 20 45         [ 4]  968 	call RAM2EE ; ( udl a u -- udl u2 ) u2 is byte written to FLASH 
      0020E7 CD 04 E3         [ 4]  969 	call DUPP 
      0020EA CD 04 AC         [ 4]  970 	call TOR
      0020ED CD 06 DE         [ 4]  971 	call PLUS  ; ( udl+ ) 
      0020F0 CD 04 E3         [ 4]  972 	call DUPP 
      0020F3 CD 0A 44         [ 4]  973 	call ZERO   ; ( udl+ ud -- )
      0020F6 CD 04 8D         [ 4]  974 	call RFROM  ; ( udl+ ud u2  R: a wl ) 
      0020F9 CD 04 8D         [ 4]  975 	call RFROM  ; ( udl+ ud u2 wl R: a ) 
      0020FC CD 05 0D         [ 4]  976 	call OVER   ; ( udl+ ud u2 wl u2 -- )
      0020FF CD 07 57         [ 4]  977 	call SUBB  ; ( udl+ ud u2 wl- R: a )
      002102 CD 04 E3         [ 4]  978 	call DUPP 
      002105 CD 03 E7         [ 4]  979 	call QBRAN
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 105.
Hexadecimal [24-Bits]



      002108 21 21                  980 	.word fmove_done 
      00210A CD 04 F3         [ 4]  981 	call SWAPP  ; ( udl+ ud wl- u2 R: a )
      00210D CD 04 8D         [ 4]  982 	call RFROM ; ( udl+ ud wl- u2 a -- ) 
      002110 CD 06 DE         [ 4]  983 	call PLUS  ; ( udl+2 ud wl- a+ )
      002113 CD 04 E3         [ 4]  984 	call DUPP 
      002116 CD 04 AC         [ 4]  985 	call TOR   ; ( udl+2 ud wl- a+ ) R: a+
      002119 CD 04 F3         [ 4]  986 	call SWAPP 
      00211C CD 03 FE         [ 4]  987 	call BRAN
      00211F 20 DE                  988 	.word next_row  
      002121                        989 fmove_done:	
      002121 CD 04 8D         [ 4]  990 	call RFROM  ; ( -- udl+ ud u2 wl- a  )
      002124 1C 00 0A         [ 2]  991 	addw x,#5*CELLL ; (  -- cp+ ) new CP 
      002127 81               [ 4]  992  	ret  
      002128                        993 no_move:
      002128 CD 0A 44         [ 4]  994 	call ZERO
      00212B 81               [ 4]  995 	ret 
                                    996 
                                    997 ;------------------------------------------
                                    998 ; adjust pointers after **FMOVE** operetion.
                                    999 ; UPDAT-PTR ( cp+ -- )
                                   1000 ; cp+ is new CP position after FMOVE 
                                   1001 ;-------------------------------------------
      00212C 20 9E                 1002 	.word LINK 
                           00212E  1003 	LINK=.
      00212E 09                    1004 	.byte 9
      00212F 55 50 44 41 54 2D 50  1005 	.ascii "UPDAT-PTR" 
             54 52
      002138                       1006 UPDATPTR:
                                   1007 ;reset VP to previous position  
      002138 CD 1B 7E         [ 4] 1008 	call EEPVP 
      00213B CD 04 D9         [ 4] 1009 	call DROP 
      00213E CD 04 3C         [ 4] 1010 	call AT
      002141 CD 06 31         [ 4] 1011 	call VPP 
      002144 CD 04 25         [ 4] 1012 	call STORE
                                   1013 ;update CONTEXT and LAST 
      002147 CD 1B 68         [ 4] 1014 	call EEPCP 
      00214A CD 04 D9         [ 4] 1015 	call DROP
      00214D CD 04 3C         [ 4] 1016 	call AT
      002150 CD 03 B4         [ 4] 1017 	call DOLIT 
      002153 00 02                 1018 	.word 2 
      002155 CD 06 DE         [ 4] 1019 	call PLUS 
      002158 CD 04 E3         [ 4] 1020 	call DUPP 
      00215B CD 06 23         [ 4] 1021 	call CNTXT 
      00215E CD 04 25         [ 4] 1022 	call STORE
      002161 CD 06 4F         [ 4] 1023 	call LAST
      002164 CD 04 25         [ 4] 1024 	call STORE 
      002167 CD 1B 98         [ 4] 1025 	call UPDATLAST 
                                   1026 ;update CP 
      00216A CD 06 3F         [ 4] 1027 	call CPP 
      00216D CD 04 25         [ 4] 1028 	call STORE
      002170 CD 1B C1         [ 4] 1029 	call UPDATCP 
      002173 81               [ 4] 1030 	ret 
                                   1031 
                                   1032 ;-----------------------------
                                   1033 ; move interrupt sub-routine
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 106.
Hexadecimal [24-Bits]



                                   1034 ; in flash memory
                                   1035 ;----------------------------- 
      002174 21 2E                 1036 	.word LINK 
                           002176  1037 	LINK=. 
      002176 06                    1038 	.byte 6
      002177 49 46 4D 4F 56 45     1039 	.ascii "IFMOVE" 
      00217D                       1040 IFMOVE:
      00217D CD 05 F0         [ 4] 1041 	call TFLASH 
      002180 CD 04 3C         [ 4] 1042 	CALL AT 
      002183 CD 03 E7         [ 4] 1043 	CALL QBRAN 
      002186 21 28                 1044 	.word no_move 
      002188 CD 06 3F         [ 4] 1045 	call CPP 
      00218B CD 04 3C         [ 4] 1046 	call AT 
      00218E CD 04 E3         [ 4] 1047 	call DUPP ; ( udl udl -- )
      002191 CD 1B 7E         [ 4] 1048 	call EEPVP 
      002194 CD 04 D9         [ 4] 1049 	call DROP
      002197 CD 04 3C         [ 4] 1050 	call AT  ; ( udl udl a )
      00219A CD 04 AC         [ 4] 1051 	call TOR 
      00219D CD 20 99         [ 4] 1052 	call FADDR
      0021A0 CD 04 A0         [ 4] 1053 	call RAT ; ( udl ud a -- ) R: a 
      0021A3 CC 20 D5         [ 2] 1054 	jp FMOVE2 
                                   1055 
                                   1056 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 107.
Hexadecimal [24-Bits]



                                   4444 
                                   4445 ;===============================================================
                                   4446 
                           002176  4447 LASTN =	LINK   ;last name defined
                                   4448 
                                   4449 ; application code begin here
      002200                       4450 	.bndry 128 ; align on flash block  
      002200                       4451 app_space: 
                                   4452 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 108.
Hexadecimal [24-Bits]

Symbol Table

    .__.$$$.=  002710 L   |     .__.ABS.=  000000 G   |     .__.CPU.=  000000 L
    .__.H$L.=  000001 L   |   6 AB1        00077A R   |   6 ABOR1      0012CE R
  6 ABOR2      0012E5 R   |   6 ABORQ      0012C6 R   |   6 ABORT      0012B7 R
  6 ABRTQ      0015A2 R   |   6 ABSS       000771 R   |   6 ACCEP      00124D R
  6 ACCP1      001256 R   |   6 ACCP2      00127C R   |   6 ACCP3      00127F R
  6 ACCP4      001281 R   |     ADC_CR1 =  005401     |     ADC_CR1_=  000000 
    ADC_CR1_=  000001     |     ADC_CR1_=  000004     |     ADC_CR1_=  000005 
    ADC_CR1_=  000006     |     ADC_CR2 =  005402     |     ADC_CR2_=  000003 
    ADC_CR2_=  000004     |     ADC_CR2_=  000005     |     ADC_CR2_=  000006 
    ADC_CR2_=  000001     |     ADC_CR3 =  005403     |     ADC_CR3_=  000007 
    ADC_CR3_=  000006     |     ADC_CSR =  005400     |     ADC_CSR_=  000006 
    ADC_CSR_=  000004     |     ADC_CSR_=  000000     |     ADC_CSR_=  000001 
    ADC_CSR_=  000002     |     ADC_CSR_=  000003     |     ADC_CSR_=  000007 
    ADC_CSR_=  000005     |     ADC_DRH =  005404     |     ADC_DRL =  005405 
    ADC_TDRH=  005406     |     ADC_TDRL=  005407     |   6 ADRADJ     00067D R
    AFR     =  004803     |     AFR0_ADC=  000000     |     AFR1_TIM=  000001 
    AFR2_CCO=  000002     |     AFR3_TIM=  000003     |     AFR4_TIM=  000004 
    AFR5_TIM=  000005     |     AFR6_I2C=  000006     |     AFR7_BEE=  000007 
  6 AFT        00158D R   |   6 AGAIN      0014E3 R   |   6 AHEAD      001540 R
  6 ALLOT      0013F6 R   |   6 ANDD       00052F R   |     APP_CP  =  004004 
    APP_LAST=  004000     |     APP_RUN =  004002     |     APP_VP  =  004006 
  6 AT         00043C R   |   6 ATEXE      000B68 R   |   6 AUTORUN    000127 R
    AWU_APR =  0050F1     |     AWU_CSR =  0050F0     |     AWU_TBR =  0050F2 
    B0_MASK =  000001     |     B115200 =  000006     |     B19200  =  000003 
    B1_MASK =  000002     |     B230400 =  000007     |     B2400   =  000000 
    B2_MASK =  000004     |     B38400  =  000004     |     B3_MASK =  000008 
    B460800 =  000008     |     B4800   =  000001     |     B4_MASK =  000010 
    B57600  =  000005     |     B5_MASK =  000020     |     B6_MASK =  000040 
    B7_MASK =  000080     |     B921600 =  000009     |     B9600   =  000002 
  6 BACK1      0011F5 R   |   6 BASE       0005A0 R   |     BASEE   =  00000A 
    BCNT    =  000001     |   6 BCOMP      001438 R   |   6 BDIGS      000C50 R
    BEEP_BIT=  000004     |     BEEP_CSR=  0050F3     |     BEEP_MAS=  000010 
    BEEP_POR=  00000F     |   6 BEGIN      0014C5 R   |     BIT0    =  000000 
    BIT1    =  000001     |     BIT2    =  000002     |     BIT3    =  000003 
    BIT4    =  000004     |     BIT5    =  000005     |     BIT6    =  000006 
    BIT7    =  000007     |   6 BKSLA      00108D R   |   6 BKSP       0011C5 R
    BKSPP   =  000008     |   6 BLANK      000A37 R   |     BLOCK_SI=  000080 
    BOOT_ROM=  006000     |     BOOT_ROM=  007FFF     |   6 BRAN       0003FE R
    BTW     =  000001     |   6 BUF2ROW    002017 R   |   6 BYE        0000B4 R
    CADR    =  000003     |     CALLL   =  0000CD     |     CAN_DGR =  005426 
    CAN_FPSR=  005427     |     CAN_IER =  005425     |     CAN_MCR =  005420 
    CAN_MSR =  005421     |     CAN_P0  =  005428     |     CAN_P1  =  005429 
    CAN_P2  =  00542A     |     CAN_P3  =  00542B     |     CAN_P4  =  00542C 
    CAN_P5  =  00542D     |     CAN_P6  =  00542E     |     CAN_P7  =  00542F 
    CAN_P8  =  005430     |     CAN_P9  =  005431     |     CAN_PA  =  005432 
    CAN_PB  =  005433     |     CAN_PC  =  005434     |     CAN_PD  =  005435 
    CAN_PE  =  005436     |     CAN_PF  =  005437     |     CAN_RFR =  005424 
    CAN_TPR =  005423     |     CAN_TSR =  005422     |     CARRY   =  000028 
  6 CAT        00045A R   |   6 CCOMMA     00141A R   |     CC_C    =  000000 
    CC_H    =  000004     |     CC_I0   =  000003     |     CC_I1   =  000005 
    CC_N    =  000002     |     CC_V    =  000007     |     CC_Z    =  000001 
    CELLL   =  000002     |   6 CELLM      0009BC R   |   6 CELLP      0009AD R
  6 CELLS      0009CB R   |     CFG_GCR =  007F60     |     CFG_GCR_=  000001 
    CFG_GCR_=  000000     |   6 CHAR1      000E7D R   |   6 CHAR2      000E80 R
  6 CHKIVEC    001F05 R   |     CLKOPT  =  004807     |     CLKOPT_C=  000002 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 109.
Hexadecimal [24-Bits]

Symbol Table

    CLKOPT_E=  000003     |     CLKOPT_P=  000000     |     CLKOPT_P=  000001 
    CLK_CCOR=  0050C9     |     CLK_CKDI=  0050C6     |     CLK_CKDI=  000000 
    CLK_CKDI=  000001     |     CLK_CKDI=  000002     |     CLK_CKDI=  000003 
    CLK_CKDI=  000004     |     CLK_CMSR=  0050C3     |     CLK_CSSR=  0050C8 
    CLK_ECKR=  0050C1     |     CLK_ECKR=  000000     |     CLK_ECKR=  000001 
    CLK_HSIT=  0050CC     |     CLK_ICKR=  0050C0     |     CLK_ICKR=  000002 
    CLK_ICKR=  000000     |     CLK_ICKR=  000001     |     CLK_ICKR=  000003 
    CLK_ICKR=  000004     |     CLK_ICKR=  000005     |     CLK_PCKE=  0050C7 
    CLK_PCKE=  000000     |     CLK_PCKE=  000001     |     CLK_PCKE=  000007 
    CLK_PCKE=  000005     |     CLK_PCKE=  000006     |     CLK_PCKE=  000004 
    CLK_PCKE=  000002     |     CLK_PCKE=  000003     |     CLK_PCKE=  0050CA 
    CLK_PCKE=  000003     |     CLK_PCKE=  000002     |     CLK_PCKE=  000007 
    CLK_SWCR=  0050C5     |     CLK_SWCR=  000000     |     CLK_SWCR=  000001 
    CLK_SWCR=  000002     |     CLK_SWCR=  000003     |     CLK_SWIM=  0050CD 
    CLK_SWR =  0050C4     |     CLK_SWR_=  0000B4     |     CLK_SWR_=  0000E1 
    CLK_SWR_=  0000D2     |   6 CMOV1      000B87 R   |   6 CMOV2      000B9F R
  6 CMOVE      000B7F R   |     CNTDWN  =  000030     |   6 CNTXT      000623 R
  6 COLD       0019E4 R   |   6 COLD1      0019E4 R   |   6 COLON      00173B R
  6 COMMA      001403 R   |   6 COMPI      001448 R   |     COMPO   =  000040 
  6 CONSTANT   0017E5 R   |   6 COUNT      000B1B R   |   6 CPP        00063F R
    CPU_A   =  007F00     |     CPU_CCR =  007F0A     |     CPU_PCE =  007F01 
    CPU_PCH =  007F02     |     CPU_PCL =  007F03     |     CPU_SPH =  007F08 
    CPU_SPL =  007F09     |     CPU_XH  =  007F04     |     CPU_XL  =  007F05 
    CPU_YH  =  007F06     |     CPU_YL  =  007F07     |   6 CR         000EAB R
  6 CREAT      001781 R   |     CRR     =  00000D     |   6 CSTOR      000449 R
  6 DAT        000AFB R   |     DATSTK  =  001680     |   6 DDROP      0006BE R
  6 DDUP       0006C9 R   |     DEBUG_BA=  007F00     |     DEBUG_EN=  007FFF 
  6 DECIM      000D00 R   |   6 DEPTH      000A86 R   |     DEVID_BA=  0048CD 
    DEVID_EN=  0048D8     |     DEVID_LO=  0048D2     |     DEVID_LO=  0048D3 
    DEVID_LO=  0048D4     |     DEVID_LO=  0048D5     |     DEVID_LO=  0048D6 
    DEVID_LO=  0048D7     |     DEVID_LO=  0048D8     |     DEVID_WA=  0048D1 
    DEVID_XH=  0048CE     |     DEVID_XL=  0048CD     |     DEVID_YH=  0048D0 
    DEVID_YL=  0048CF     |   6 DGTQ1      000D45 R   |   6 DI         0000C2 R
  6 DIG        000C79 R   |   6 DIGIT      000C14 R   |   6 DIGS       000C8A R
  6 DIGS1      000C8A R   |   6 DIGS2      000C97 R   |   6 DIGTQ      000D14 R
    DM_BK1RE=  007F90     |     DM_BK1RH=  007F91     |     DM_BK1RL=  007F92 
    DM_BK2RE=  007F93     |     DM_BK2RH=  007F94     |     DM_BK2RL=  007F95 
    DM_CR1  =  007F96     |     DM_CR2  =  007F97     |     DM_CSR1 =  007F98 
    DM_CSR2 =  007F99     |     DM_ENFCT=  007F9A     |   6 DN1        000738 R
  6 DNEGA      00071B R   |   6 DOCONST    00180F R   |   6 DOLIT      0003B4 R
  6 DONXT      0003C8 R   |   6 DOSTR      000EC1 R   |   6 DOT        000F46 R
  6 DOT1       000F5C R   |   6 DOTI1      001931 R   |   6 DOTID      00191B R
  6 DOTO1      00135A R   |   6 DOTOK      001340 R   |   6 DOTPR      00106F R
  6 DOTQ       0015BC R   |   6 DOTQP      000EEA R   |   6 DOTR       000EF8 R
  6 DOTS       0018BD R   |   6 DOTS1      0018C8 R   |   6 DOTS2      0018D1 R
  6 DOVAR      000590 R   |   6 DROP       0004D9 R   |   6 DSTOR      000AD5 R
  6 DUMP       001873 R   |   6 DUMP1      00188A R   |   6 DUMP3      0018AC R
  6 DUMPP      001842 R   |   6 DUPP       0004E3 R   |   6 EDIGS      000CB5 R
  6 EEPCP      001B68 R   |   6 EEPLAST    001B3B R   |   6 EEPROM     001B23 R
    EEPROM_B=  004000     |     EEPROM_E=  0047FF     |     EEPROM_S=  000800 
  6 EEPRUN     001B52 R   |   6 EEPVP      001B7E R   |   6 EI         0000BB R
  6 ELSEE      00151B R   |   6 EMIT       00039E R   |   6 ENEPER     001A93 R
  6 EQ1        000795 R   |   6 EQUAL      00077F R   |   6 ERASE      000BE1 R
    ERR     =  00001B     |   6 EVAL       001383 R   |   6 EVAL1      001383 R
  6 EVAL2      00139F R   |   6 EXE1       000B76 R   |   6 EXECU      00040E R
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 110.
Hexadecimal [24-Bits]

Symbol Table

  6 EXIT       00041E R   |     EXT     =  000000     |     EXTI_CR1=  0050A0 
    EXTI_CR2=  0050A1     |   6 EXTRC      000C3C R   |   6 FADDR      002099 R
    FHSE    =  7A1200     |     FHSI    =  F42400     |   6 FILL       000BAE R
  6 FILL1      000BCB R   |   6 FILL2      000BD4 R   |   6 FIND       001121 R
  6 FIND1      00113F R   |   6 FIND2      00116D R   |   6 FIND3      001179 R
  6 FIND4      00118D R   |   6 FIND5      00119A R   |   6 FIND6      00117E R
    FLASH_BA=  008000     |     FLASH_CR=  00505A     |     FLASH_CR=  000002 
    FLASH_CR=  000000     |     FLASH_CR=  000003     |     FLASH_CR=  000001 
    FLASH_CR=  00505B     |     FLASH_CR=  000005     |     FLASH_CR=  000004 
    FLASH_CR=  000007     |     FLASH_CR=  000000     |     FLASH_CR=  000006 
    FLASH_DU=  005064     |     FLASH_DU=  0000AE     |     FLASH_DU=  000056 
    FLASH_EN=  027FFF     |     FLASH_FP=  00505D     |     FLASH_FP=  000000 
    FLASH_FP=  000001     |     FLASH_FP=  000002     |     FLASH_FP=  000003 
    FLASH_FP=  000004     |     FLASH_FP=  000005     |     FLASH_IA=  00505F 
    FLASH_IA=  000003     |     FLASH_IA=  000002     |     FLASH_IA=  000006 
    FLASH_IA=  000001     |     FLASH_IA=  000000     |     FLASH_NC=  00505C 
    FLASH_NF=  00505E     |     FLASH_NF=  000000     |     FLASH_NF=  000001 
    FLASH_NF=  000002     |     FLASH_NF=  000003     |     FLASH_NF=  000004 
    FLASH_NF=  000005     |     FLASH_PU=  005062     |     FLASH_PU=  000056 
    FLASH_PU=  0000AE     |     FLASH_SI=  020000     |     FLASH_WS=  00480D 
    FLSI    =  01F400     |   6 FMOVE      0020A4 R   |   6 FMOVE2     0020D5 R
  6 FOR        001498 R   |   6 FORGET     000158 R   |   6 FORGET1    000187 R
  6 FORGET2    00020D R   |   6 FORGET4    000216 R   |   6 FORGET6    0001CF R
    FPTR    =  000032     |   6 FREEVAR    000223 R   |   6 FREEVAR4   000259 R
    GPIO_BAS=  005000     |     GPIO_CR1=  000003     |     GPIO_CR2=  000004 
    GPIO_DDR=  000002     |     GPIO_IDR=  000001     |     GPIO_ODR=  000000 
    GPIO_SIZ=  000005     |   6 HERE       000B32 R   |   6 HEX        000CEB R
  6 HI         0019B7 R   |   6 HLD        000610 R   |   6 HOLD       000C60 R
    HSECNT  =  004809     |     I2C_CCRH=  00521C     |     I2C_CCRH=  000080 
    I2C_CCRH=  0000C0     |     I2C_CCRH=  000080     |     I2C_CCRH=  000000 
    I2C_CCRH=  000001     |     I2C_CCRH=  000000     |     I2C_CCRL=  00521B 
    I2C_CCRL=  00001A     |     I2C_CCRL=  000002     |     I2C_CCRL=  00000D 
    I2C_CCRL=  000050     |     I2C_CCRL=  000090     |     I2C_CCRL=  0000A0 
    I2C_CR1 =  005210     |     I2C_CR1_=  000006     |     I2C_CR1_=  000007 
    I2C_CR1_=  000000     |     I2C_CR2 =  005211     |     I2C_CR2_=  000002 
    I2C_CR2_=  000003     |     I2C_CR2_=  000000     |     I2C_CR2_=  000001 
    I2C_CR2_=  000007     |     I2C_DR  =  005216     |     I2C_FREQ=  005212 
    I2C_ITR =  00521A     |     I2C_ITR_=  000002     |     I2C_ITR_=  000000 
    I2C_ITR_=  000001     |     I2C_OARH=  005214     |     I2C_OARH=  000001 
    I2C_OARH=  000002     |     I2C_OARH=  000006     |     I2C_OARH=  000007 
    I2C_OARL=  005213     |     I2C_OARL=  000000     |     I2C_OAR_=  000813 
    I2C_OAR_=  000009     |     I2C_PECR=  00521E     |     I2C_READ=  000001 
    I2C_SR1 =  005217     |     I2C_SR1_=  000003     |     I2C_SR1_=  000001 
    I2C_SR1_=  000002     |     I2C_SR1_=  000006     |     I2C_SR1_=  000000 
    I2C_SR1_=  000004     |     I2C_SR1_=  000007     |     I2C_SR2 =  005218 
    I2C_SR2_=  000002     |     I2C_SR2_=  000001     |     I2C_SR2_=  000000 
    I2C_SR2_=  000003     |     I2C_SR2_=  000005     |     I2C_SR3 =  005219 
    I2C_SR3_=  000001     |     I2C_SR3_=  000007     |     I2C_SR3_=  000004 
    I2C_SR3_=  000000     |     I2C_SR3_=  000002     |     I2C_TRIS=  00521D 
    I2C_TRIS=  000005     |     I2C_TRIS=  000005     |     I2C_TRIS=  000005 
    I2C_TRIS=  000011     |     I2C_TRIS=  000011     |     I2C_TRIS=  000011 
    I2C_WRIT=  000000     |   6 ICOLON     00174C R   |   6 IFETCH     0014B6 R
  6 IFF        0014F3 R   |   6 IFMOVE     00217D R   |     IMEDD   =  000080 
  6 IMMED      00175E R   |   6 INCH       000392 R   |   6 INITOFS    001714 R
  6 INN        0005BE R   |     INPUT_DI=  000000     |     INPUT_EI=  000001 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 111.
Hexadecimal [24-Bits]

Symbol Table

    INPUT_FL=  000000     |     INPUT_PU=  000001     |   6 INTE1      001322 R
  6 INTER      0012F8 R   |     INT_ADC2=  000016     |     INT_AUAR=  000012 
    INT_AWU =  000001     |     INT_CAN_=  000008     |     INT_CAN_=  000009 
    INT_CLK =  000002     |     INT_EXTI=  000003     |     INT_EXTI=  000004 
    INT_EXTI=  000005     |     INT_EXTI=  000006     |     INT_EXTI=  000007 
    INT_FLAS=  000018     |     INT_I2C =  000013     |     INT_SPI =  00000A 
    INT_TIM1=  00000C     |     INT_TIM1=  00000B     |     INT_TIM2=  00000E 
    INT_TIM2=  00000D     |     INT_TIM3=  000010     |     INT_TIM3=  00000F 
    INT_TIM4=  000017     |     INT_TLI =  000000     |     INT_UART=  000011 
    INT_UART=  000015     |     INT_UART=  000014     |     INT_VECT=  008060 
    INT_VECT=  00800C     |     INT_VECT=  008028     |     INT_VECT=  00802C 
    INT_VECT=  008010     |     INT_VECT=  008014     |     INT_VECT=  008018 
    INT_VECT=  00801C     |     INT_VECT=  008020     |     INT_VECT=  008024 
    INT_VECT=  008068     |     INT_VECT=  008054     |     INT_VECT=  008000 
    INT_VECT=  008030     |     INT_VECT=  008038     |     INT_VECT=  008034 
    INT_VECT=  008040     |     INT_VECT=  00803C     |     INT_VECT=  008048 
    INT_VECT=  008044     |     INT_VECT=  008064     |     INT_VECT=  008008 
    INT_VECT=  008004     |     INT_VECT=  008050     |     INT_VECT=  00804C 
    INT_VECT=  00805C     |     INT_VECT=  008058     |   6 INVER      0006F8 R
    IPR0    =  000002     |     IPR1    =  000001     |     IPR2    =  000000 
    IPR3    =  000003     |     IPR_MASK=  000003     |     IRET_COD=  000080 
  6 ISEMI      0016A9 R   |     ITC_SPR1=  007F70     |     ITC_SPR2=  007F71 
    ITC_SPR3=  007F72     |     ITC_SPR4=  007F73     |     ITC_SPR5=  007F74 
    ITC_SPR6=  007F75     |     ITC_SPR7=  007F76     |     ITC_SPR8=  007F77 
    IWDG_KR =  0050E0     |     IWDG_PR =  0050E1     |     IWDG_RLR=  0050E2 
  6 JSRC       0016FE R   |   6 KEY        000E2B R   |   6 KTAP       001212 R
  6 KTAP1      001235 R   |   6 KTAP2      001238 R   |   6 LAST       00064F R
  6 LASTN   =  002176 R   |   6 LBRAC      00132F R   |     LED2_BIT=  000005 
    LED2_MAS=  000020     |     LED2_POR=  00500A     |   6 LESS       0007BC R
    LF      =  00000A     |   6 LINK    =  002176 R   |   6 LITER      00146A R
  6 LN2S       001AEF R   |   6 LOG2S      001AD9 R   |   6 LSHIFT     0009F6 R
  6 LSHIFT1    0009FF R   |   6 LSHIFT4    000A07 R   |   6 LT1        0007D2 R
    MASKK   =  001F7F     |   6 MAX        0007DC R   |   6 MAX1       0007EF R
  6 MIN        0007F9 R   |   6 MIN1       00080C R   |   6 MMOD1      0008AF R
  6 MMOD2      0008C3 R   |   6 MMOD3      0008DA R   |   6 MMSM1      000856 R
  6 MMSM2      00086A R   |   6 MMSM3      00086C R   |   6 MMSM4      000874 R
  6 MODD       0008F4 R   |   6 MONE       000A5D R   |     MS      =  00002E 
  6 MSEC       0002CE R   |   6 MSMOD      000892 R   |   6 MSTA1      000985 R
  6 MSTAR      000962 R   |     NAFR    =  004804     |   6 NAMEQ      0011BA R
  6 NAMET      0010CB R   |     NCLKOPT =  004808     |   6 NEGAT      000709 R
  6 NEX1       0003D5 R   |   6 NEXT       0014A7 R   |     NFLASH_W=  00480E 
    NHSECNT =  00480A     |     NOPT1   =  004802     |     NOPT2   =  004804 
    NOPT3   =  004806     |     NOPT4   =  004808     |     NOPT5   =  00480A 
    NOPT6   =  00480C     |     NOPT7   =  00480E     |     NOPTBL  =  00487F 
  6 NTIB       0005CE R   |     NUBC    =  004802     |   6 NUFQ       000E41 R
  6 NUFQ1      000E5A R   |   6 NUMBQ      000D58 R   |   6 NUMQ1      000D8C R
  6 NUMQ2      000DBD R   |   6 NUMQ3      000DFF R   |   6 NUMQ4      000E04 R
  6 NUMQ5      000E13 R   |   6 NUMQ6      000E16 R   |     NWDGOPT =  004806 
    NWDGOPT_=  FFFFFFFD     |     NWDGOPT_=  FFFFFFFC     |     NWDGOPT_=  FFFFFFFF 
    NWDGOPT_=  FFFFFFFE     |   6 NonHandl   000000 R   |   6 OFFSET     000674 R
    OFS     =  000005     |   6 ONE        000A4F R   |   6 ONEM       0009E5 R
  6 ONEP       0009D8 R   |     OPT     =  000002     |     OPT0    =  004800 
    OPT1    =  004801     |     OPT2    =  004803     |     OPT3    =  004805 
    OPT4    =  004807     |     OPT5    =  004809     |     OPT6    =  00480B 
    OPT7    =  00480D     |     OPTBL   =  00487E     |     OPTIMIZE=  000001 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 112.
Hexadecimal [24-Bits]

Symbol Table

    OPTION_B=  004800     |     OPTION_E=  00487F     |     OPTION_S=  000080 
  6 ORIG       000047 R   |   6 ORR        000543 R   |   6 OUTPUT     0003A3 R
    OUTPUT_F=  000001     |     OUTPUT_O=  000000     |     OUTPUT_P=  000001 
    OUTPUT_S=  000000     |   6 OVER       00050D R   |   6 OVERT      001677 R
    PA      =  000000     |   6 PACKS      000BF3 R   |   6 PAD        000B43 R
  6 PAREN      00107E R   |   6 PARS       000F77 R   |   6 PARS1      000FA2 R
  6 PARS2      000FCD R   |   6 PARS3      000FD0 R   |   6 PARS4      000FD9 R
  6 PARS5      000FFC R   |   6 PARS6      001011 R   |   6 PARS7      001020 R
  6 PARS8      00102F R   |   6 PARSE      001040 R   |   6 PAUSE      0002DE R
    PA_BASE =  005000     |     PA_CR1  =  005003     |     PA_CR2  =  005004 
    PA_DDR  =  005002     |     PA_IDR  =  005001     |     PA_ODR  =  005000 
    PB      =  000005     |     PB_BASE =  005005     |     PB_CR1  =  005008 
    PB_CR2  =  005009     |     PB_DDR  =  005007     |     PB_IDR  =  005006 
    PB_ODR  =  005005     |     PC      =  00000A     |     PC_BASE =  00500A 
    PC_CR1  =  00500D     |     PC_CR2  =  00500E     |     PC_DDR  =  00500C 
    PC_IDR  =  00500B     |     PC_ODR  =  00500A     |     PD      =  00000F 
  6 PDUM1      001855 R   |   6 PDUM2      001866 R   |     PD_BASE =  00500F 
    PD_CR1  =  005012     |     PD_CR2  =  005013     |     PD_DDR  =  005011 
    PD_IDR  =  005010     |     PD_ODR  =  00500F     |     PE      =  000014 
    PE_BASE =  005014     |     PE_CR1  =  005017     |     PE_CR2  =  005018 
    PE_DDR  =  005016     |     PE_IDR  =  005015     |     PE_ODR  =  005014 
    PF      =  000019     |     PF_BASE =  005019     |     PF_CR1  =  00501C 
    PF_CR2  =  00501D     |     PF_DDR  =  00501B     |     PF_IDR  =  00501A 
    PF_ODR  =  005019     |     PG      =  00001E     |     PG_BASE =  00501E 
    PG_CR1  =  005021     |     PG_CR2  =  005022     |     PG_DDR  =  005020 
    PG_IDR  =  00501F     |     PG_ODR  =  00501E     |     PH      =  000023 
    PH_BASE =  005023     |     PH_CR1  =  005026     |     PH_CR2  =  005027 
    PH_DDR  =  005025     |     PH_IDR  =  005024     |     PH_ODR  =  005023 
    PI      =  000028     |   6 PICK       000A9D R   |   6 PII        001A52 R
    PI_BASE =  005028     |     PI_CR1  =  00502B     |     PI_CR2  =  00502C 
    PI_DDR  =  00502A     |     PI_IDR  =  005029     |     PI_ODR  =  005028 
  6 PLUS       0006DE R   |   6 PNAM1      00162C R   |   6 PRESE      0013AE R
    PROD1   =  000022     |     PROD2   =  000024     |     PROD3   =  000026 
  6 PROTECTE   0001FF R   |   6 PSTOR      000AB4 R   |     PTR16   =  000033 
    PTR8    =  000034     |   6 QBRAN      0003E7 R   |   6 QDUP       00068D R
  6 QDUP1      000697 R   |   6 QKEY       000380 R   |   6 QSTAC      001366 R
  6 QUERY      001292 R   |   6 QUEST      000F69 R   |   6 QUIT       0013CB R
  6 QUIT1      0013D3 R   |   6 QUIT2      0013D6 R   |   6 RAM2EE     002045 R
    RAMBASE =  000000     |   6 RAMLAST    000662 R   |     RAM_BASE=  000000 
    RAM_END =  0017FF     |     RAM_SIZE=  001800     |   6 RANDOM     00027C R
  6 RAT        0004A0 R   |   6 RBRAC      0016EB R   |   6 REPEA      001570 R
  6 RFREE      00202C R   |   6 RFROM      00048D R   |     ROP     =  004800 
  6 ROT        00069E R   |   6 ROW2BUF    001FEE R   |     ROWBUFF =  001680 
    RP0     =  00002C     |   6 RPAT       00046A R   |     RPP     =  0017FF 
  6 RPSTO      000477 R   |   6 RSHIFT     000A12 R   |   6 RSHIFT1    000A1B R
  6 RSHIFT4    000A23 R   |     RST_SR  =  0050B3     |   6 RT12_2     001AC2 R
  6 SAME1      0010E9 R   |   6 SAME2      001112 R   |   6 SAMEQ      0010E1 R
  6 SCOM1      001661 R   |   6 SCOM2      001664 R   |   6 SCOMP      001643 R
  6 SEE        001943 R   |   6 SEE1       00194C R   |   6 SEE2       001960 R
  6 SEE3       001973 R   |   6 SEE4       00197C R   |   6 SEED       000263 R
    SEEDX   =  000036     |     SEEDY   =  000038     |   6 SEMIS      001687 R
  6 SETISP     0000CE R   |   6 SET_RAML   0017CE R   |     SFR_BASE=  005000 
    SFR_END =  0057FF     |   6 SIGN       000C9F R   |   6 SIGN1      000CAF R
  6 SLASH      0008FE R   |   6 SLMOD      0008E2 R   |   6 SNAME      0015F6 R
    SP0     =  00002A     |   6 SPACE      000E63 R   |   6 SPACS      000E72 R
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 113.
Hexadecimal [24-Bits]

Symbol Table

  6 SPAT       0004C3 R   |     SPI_CR1 =  005200     |     SPI_CR2 =  005201 
    SPI_CRCP=  005205     |     SPI_DR  =  005204     |     SPI_ICR =  005202 
    SPI_RXCR=  005206     |     SPI_SR  =  005203     |     SPI_TXCR=  005207 
    SPP     =  001680     |     SPSAVE  =  000001     |   6 SPSTO      0004D0 R
  6 SQRT10     001AAB R   |   6 SQRT2      001A69 R   |   6 SQRT3      001A80 R
  6 SSMOD      00098E R   |     SSP     =  000001     |     STACK   =  0017FF 
  6 STAR       000957 R   |   6 STASL      00099F R   |   6 STOD       000740 R
  6 STORE      000425 R   |   6 STR        000CCD R   |   6 STRCQ      001478 R
  6 STRQ       0015AF R   |   6 STRQP      000EE0 R   |   6 SUBB       000757 R
  6 SWAPP      0004F3 R   |     SWIM_CSR=  007F80     |   6 TAP        0011FC R
  6 TBOOT      0019D8 R   |   6 TBUF       0005DE R   |     TBUFFBAS=  001680 
  6 TCHAR      000A6E R   |   6 TEMP       0005AF R   |   6 TEVAL      000601 R
  6 TFLASH     0005F0 R   |   6 THENN      001508 R   |   6 TIB        000B54 R
    TIBB    =  001700     |     TIBBASE =  001700     |     TIC     =  000027 
  6 TICK       0013E2 R   |     TIM1_ARR=  005262     |     TIM1_ARR=  005263 
    TIM1_BKR=  00526D     |     TIM1_CCE=  00525C     |     TIM1_CCE=  00525D 
    TIM1_CCM=  005258     |     TIM1_CCM=  000000     |     TIM1_CCM=  000001 
    TIM1_CCM=  000004     |     TIM1_CCM=  000005     |     TIM1_CCM=  000006 
    TIM1_CCM=  000007     |     TIM1_CCM=  000002     |     TIM1_CCM=  000003 
    TIM1_CCM=  000007     |     TIM1_CCM=  000002     |     TIM1_CCM=  000004 
    TIM1_CCM=  000005     |     TIM1_CCM=  000006     |     TIM1_CCM=  000003 
    TIM1_CCM=  005259     |     TIM1_CCM=  000000     |     TIM1_CCM=  000001 
    TIM1_CCM=  000004     |     TIM1_CCM=  000005     |     TIM1_CCM=  000006 
    TIM1_CCM=  000007     |     TIM1_CCM=  000002     |     TIM1_CCM=  000003 
    TIM1_CCM=  000007     |     TIM1_CCM=  000002     |     TIM1_CCM=  000004 
    TIM1_CCM=  000005     |     TIM1_CCM=  000006     |     TIM1_CCM=  000003 
    TIM1_CCM=  00525A     |     TIM1_CCM=  000000     |     TIM1_CCM=  000001 
    TIM1_CCM=  000004     |     TIM1_CCM=  000005     |     TIM1_CCM=  000006 
    TIM1_CCM=  000007     |     TIM1_CCM=  000002     |     TIM1_CCM=  000003 
    TIM1_CCM=  000007     |     TIM1_CCM=  000002     |     TIM1_CCM=  000004 
    TIM1_CCM=  000005     |     TIM1_CCM=  000006     |     TIM1_CCM=  000003 
    TIM1_CCM=  00525B     |     TIM1_CCM=  000000     |     TIM1_CCM=  000001 
    TIM1_CCM=  000004     |     TIM1_CCM=  000005     |     TIM1_CCM=  000006 
    TIM1_CCM=  000007     |     TIM1_CCM=  000002     |     TIM1_CCM=  000003 
    TIM1_CCM=  000007     |     TIM1_CCM=  000002     |     TIM1_CCM=  000004 
    TIM1_CCM=  000005     |     TIM1_CCM=  000006     |     TIM1_CCM=  000003 
    TIM1_CCR=  005265     |     TIM1_CCR=  005266     |     TIM1_CCR=  005267 
    TIM1_CCR=  005268     |     TIM1_CCR=  005269     |     TIM1_CCR=  00526A 
    TIM1_CCR=  00526B     |     TIM1_CCR=  00526C     |     TIM1_CNT=  00525E 
    TIM1_CNT=  00525F     |     TIM1_CR1=  005250     |     TIM1_CR2=  005251 
    TIM1_CR2=  000000     |     TIM1_CR2=  000002     |     TIM1_CR2=  000004 
    TIM1_CR2=  000005     |     TIM1_CR2=  000006     |     TIM1_DTR=  00526E 
    TIM1_EGR=  005257     |     TIM1_EGR=  000007     |     TIM1_EGR=  000001 
    TIM1_EGR=  000002     |     TIM1_EGR=  000003     |     TIM1_EGR=  000004 
    TIM1_EGR=  000005     |     TIM1_EGR=  000006     |     TIM1_EGR=  000000 
    TIM1_ETR=  005253     |     TIM1_ETR=  000006     |     TIM1_ETR=  000000 
    TIM1_ETR=  000001     |     TIM1_ETR=  000002     |     TIM1_ETR=  000003 
    TIM1_ETR=  000007     |     TIM1_ETR=  000004     |     TIM1_ETR=  000005 
    TIM1_IER=  005254     |     TIM1_IER=  000007     |     TIM1_IER=  000001 
    TIM1_IER=  000002     |     TIM1_IER=  000003     |     TIM1_IER=  000004 
    TIM1_IER=  000005     |     TIM1_IER=  000006     |     TIM1_IER=  000000 
    TIM1_OIS=  00526F     |     TIM1_PSC=  005260     |     TIM1_PSC=  005261 
    TIM1_RCR=  005264     |     TIM1_SMC=  005252     |     TIM1_SMC=  000007 
    TIM1_SMC=  000000     |     TIM1_SMC=  000001     |     TIM1_SMC=  000002 
    TIM1_SMC=  000004     |     TIM1_SMC=  000005     |     TIM1_SMC=  000006 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 114.
Hexadecimal [24-Bits]

Symbol Table

    TIM1_SR1=  005255     |     TIM1_SR1=  000007     |     TIM1_SR1=  000001 
    TIM1_SR1=  000002     |     TIM1_SR1=  000003     |     TIM1_SR1=  000004 
    TIM1_SR1=  000005     |     TIM1_SR1=  000006     |     TIM1_SR1=  000000 
    TIM1_SR2=  005256     |     TIM1_SR2=  000001     |     TIM1_SR2=  000002 
    TIM1_SR2=  000003     |     TIM1_SR2=  000004     |     TIM2_ARR=  00530D 
    TIM2_ARR=  00530E     |     TIM2_CCE=  005308     |     TIM2_CCE=  000000 
    TIM2_CCE=  000001     |     TIM2_CCE=  000004     |     TIM2_CCE=  000005 
    TIM2_CCE=  005309     |     TIM2_CCM=  005305     |     TIM2_CCM=  005306 
    TIM2_CCM=  005307     |     TIM2_CCM=  000000     |     TIM2_CCM=  000004 
    TIM2_CCM=  000003     |     TIM2_CCR=  00530F     |     TIM2_CCR=  005310 
    TIM2_CCR=  005311     |     TIM2_CCR=  005312     |     TIM2_CCR=  005313 
    TIM2_CCR=  005314     |     TIM2_CNT=  00530A     |     TIM2_CNT=  00530B 
    TIM2_CR1=  005300     |     TIM2_CR1=  000007     |     TIM2_CR1=  000000 
    TIM2_CR1=  000003     |     TIM2_CR1=  000001     |     TIM2_CR1=  000002 
    TIM2_EGR=  005304     |     TIM2_EGR=  000001     |     TIM2_EGR=  000002 
    TIM2_EGR=  000003     |     TIM2_EGR=  000006     |     TIM2_EGR=  000000 
    TIM2_IER=  005301     |     TIM2_PSC=  00530C     |     TIM2_SR1=  005302 
    TIM2_SR2=  005303     |     TIM3_ARR=  00532B     |     TIM3_ARR=  00532C 
    TIM3_CCE=  005327     |     TIM3_CCE=  000000     |     TIM3_CCE=  000001 
    TIM3_CCE=  000004     |     TIM3_CCE=  000005     |     TIM3_CCE=  000000 
    TIM3_CCE=  000001     |     TIM3_CCM=  005325     |     TIM3_CCM=  005326 
    TIM3_CCM=  000000     |     TIM3_CCM=  000004     |     TIM3_CCM=  000003 
    TIM3_CCR=  00532D     |     TIM3_CCR=  00532E     |     TIM3_CCR=  00532F 
    TIM3_CCR=  005330     |     TIM3_CNT=  005328     |     TIM3_CNT=  005329 
    TIM3_CR1=  005320     |     TIM3_CR1=  000007     |     TIM3_CR1=  000000 
    TIM3_CR1=  000003     |     TIM3_CR1=  000001     |     TIM3_CR1=  000002 
    TIM3_EGR=  005324     |     TIM3_IER=  005321     |     TIM3_PSC=  00532A 
    TIM3_SR1=  005322     |     TIM3_SR2=  005323     |     TIM4_ARR=  005346 
    TIM4_CNT=  005344     |     TIM4_CR1=  005340     |     TIM4_CR1=  000007 
    TIM4_CR1=  000000     |     TIM4_CR1=  000003     |     TIM4_CR1=  000001 
    TIM4_CR1=  000002     |     TIM4_EGR=  005343     |     TIM4_EGR=  000000 
    TIM4_IER=  005341     |     TIM4_IER=  000000     |     TIM4_PSC=  005345 
    TIM4_PSC=  000000     |     TIM4_PSC=  000007     |     TIM4_PSC=  000004 
    TIM4_PSC=  000001     |     TIM4_PSC=  000005     |     TIM4_PSC=  000002 
    TIM4_PSC=  000006     |     TIM4_PSC=  000003     |     TIM4_PSC=  000000 
    TIM4_PSC=  000001     |     TIM4_PSC=  000002     |     TIM4_SR =  005342 
    TIM4_SR_=  000000     |   6 TIMEOUTQ   00030E R   |   6 TIMER      0002F8 R
    TIM_CR1_=  000007     |     TIM_CR1_=  000000     |     TIM_CR1_=  000006 
    TIM_CR1_=  000005     |     TIM_CR1_=  000004     |     TIM_CR1_=  000003 
    TIM_CR1_=  000001     |     TIM_CR1_=  000002     |   6 TNAM2      0018EB R
  6 TNAM3      001909 R   |   6 TNAM4      00190F R   |   6 TNAME      0018E8 R
  6 TOFLASH    000333 R   |   6 TOKEN      0010BD R   |   6 TOR        0004AC R
  6 TORAM      000373 R   |     TRUEE   =  00FFFF     |   6 TWOSL      000A2A R
  6 TYPE1      000E92 R   |   6 TYPE2      000E9E R   |   6 TYPES      000E8D R
  6 Timer4Ha   000005 R   |     UART1   =  000000     |     UART1_BA=  005230 
    UART1_BR=  005232     |     UART1_BR=  005233     |     UART1_CR=  005234 
    UART1_CR=  005235     |     UART1_CR=  005236     |     UART1_CR=  005237 
    UART1_CR=  005238     |     UART1_DR=  005231     |     UART1_GT=  005239 
    UART1_PO=  000000     |     UART1_PS=  00523A     |     UART1_RX=  000004 
    UART1_SR=  005230     |     UART1_TX=  000005     |     UART3   =  000001 
    UART3_BA=  005240     |     UART3_BR=  005242     |     UART3_BR=  005243 
    UART3_CR=  005244     |     UART3_CR=  005245     |     UART3_CR=  005246 
    UART3_CR=  005247     |     UART3_CR=  004249     |     UART3_DR=  005241 
    UART3_PO=  00000F     |     UART3_RX=  000006     |     UART3_SR=  005240 
    UART3_TX=  000005     |     UART_BRR=  000002     |     UART_BRR=  000003 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 115.
Hexadecimal [24-Bits]

Symbol Table

    UART_CR1=  000004     |     UART_CR1=  000004     |     UART_CR1=  000002 
    UART_CR1=  000000     |     UART_CR1=  000001     |     UART_CR1=  000007 
    UART_CR1=  000006     |     UART_CR1=  000005     |     UART_CR1=  000003 
    UART_CR2=  000005     |     UART_CR2=  000004     |     UART_CR2=  000002 
    UART_CR2=  000005     |     UART_CR2=  000001     |     UART_CR2=  000000 
    UART_CR2=  000006     |     UART_CR2=  000003     |     UART_CR2=  000007 
    UART_CR3=  000006     |     UART_CR3=  000003     |     UART_CR3=  000001 
    UART_CR3=  000002     |     UART_CR3=  000000     |     UART_CR3=  000006 
    UART_CR3=  000004     |     UART_CR3=  000005     |     UART_CR4=  000007 
    UART_CR4=  000000     |     UART_CR4=  000001     |     UART_CR4=  000002 
    UART_CR4=  000003     |     UART_CR4=  000004     |     UART_CR4=  000006 
    UART_CR4=  000005     |     UART_CR5=  000008     |     UART_CR5=  000003 
    UART_CR5=  000001     |     UART_CR5=  000002     |     UART_CR5=  000004 
    UART_CR5=  000005     |     UART_CR6=  000009     |     UART_CR6=  000004 
    UART_CR6=  000007     |     UART_CR6=  000001     |     UART_CR6=  000002 
    UART_CR6=  000000     |     UART_CR6=  000005     |     UART_DR =  000001 
    UART_GTR=  000009     |     UART_PSC=  00000A     |     UART_SR =  000000 
    UART_SR_=  000001     |     UART_SR_=  000004     |     UART_SR_=  000002 
    UART_SR_=  000003     |     UART_SR_=  000000     |     UART_SR_=  000005 
    UART_SR_=  000006     |     UART_SR_=  000007     |     UBASE   =  000006 
    UBC     =  004801     |     UCNTXT  =  000014     |     UCP     =  000018 
    UCTIB   =  00000C     |     UD1     =  000001     |     UD2     =  000002 
    UD3     =  000003     |     UD4     =  000004     |   6 UDOT       000F33 R
  6 UDOTR      000F13 R   |   6 UEND       000045 R   |     UHLD    =  000012 
    UINN    =  00000A     |     UINTER  =  000010     |     ULAST   =  00001A 
  6 ULES1      0007B4 R   |   6 ULESS      00079E R   |   6 UMMOD      000834 R
  6 UMSTA      00090D R   |   6 UNIQ1      0015ED R   |   6 UNIQU      0015CE R
  6 UNTIL      0014D0 R   |     UOFFSET =  00001C     |   6 UPDATCP    001BC1 R
  6 UPDATLAS   001B98 R   |   6 UPDATPTR   002138 R   |   6 UPDATRUN   001BB0 R
  6 UPDATVP    001BD8 R   |   6 UPL1       000584 R   |   6 UPLUS      00056D R
    UPP     =  000006     |     URLAST  =  000020     |     USR_BTN_=  000004 
    USR_BTN_=  000010     |     USR_BTN_=  005015     |     UTFLASH =  00001E 
    UTIB    =  00000E     |     UTMP    =  000008     |   6 UTYP1      001825 R
  6 UTYP2      001834 R   |   6 UTYPE      001820 R   |     UVP     =  000016 
  6 UZERO      00002B R   |   6 VARIA      00179B R   |     VAR_BASE=  000080 
    VAR_TOP =  0017BF     |     VER     =  000003     |   6 VPP        000631 R
    VSIZE   =  000006     |     WANT_DEB=  000000     |     WANT_MAT=  000001 
    WANT_SEE=  000001     |     WDGOPT  =  004805     |     WDGOPT_I=  000002 
    WDGOPT_L=  000003     |     WDGOPT_W=  000000     |     WDGOPT_W=  000001 
  6 WHILE      001556 R   |   6 WITHI      000819 R   |   6 WORDD      0010A9 R
  6 WORDS      00198F R   |   6 WORS1      001995 R   |   6 WORS2      0019B1 R
    WWDG_CR =  0050D1     |     WWDG_WR =  0050D2     |   6 XORR       000558 R
    XTEMP   =  000022     |     YTEMP   =  000024     |   6 ZERO       000A44 R
  6 ZL1        000525 R   |   6 ZLESS      00051C R   |   6 app_spac   002200 R
  6 block_er   001D5B R   |   6 clear_ra   000019 R   |   6 clock_in   000062 R
  6 copy_buf   001DB2 R   |   6 copy_buf   001DD1 R   |   6 copy_pro   001DD1 R
    da      =  000002     |     db      =  000003     |     dc      =  000000 
    dd      =  000001     |   6 ee_ccomm   001FCC R   |   6 ee_comma   001FAB R
  6 ee_cstor   001CC8 R   |   6 ee_store   001D14 R   |   6 erase_fl   001D77 R
  6 farat      001BE9 R   |   6 farcat     001C05 R   |   6 fmove_do   002121 R
  6 fptr_sto   001B04 R   |   6 inc_fptr   001C96 R   |   6 lock       001C82 R
  6 main       000016 R   |   6 next_row   0020DE R   |   6 no_move    002128 R
  6 pristine   001E4C R   |   6 proceed_   001D7A R   |   6 reboot     000325 R
  6 reset_ve   001EB3 R   |   6 row_eras   001D3E R   |   6 row_eras   001D8B R
  6 row_eras   001DB2 R   |   6 set_opti   001E20 R   |   6 set_vect   001F54 R
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 116.
Hexadecimal [24-Bits]

Symbol Table

  6 uart1_in   000074 R   |   6 unlock     001C5A R   |   6 unlock_e   001C1C R
  6 unlock_f   001C3B R   |   6 write_by   001CAD R   |   6 write_ro   001DF6 R

ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 117.
Hexadecimal [24-Bits]

Area Table

   0 _CODE      size      0   flags    0
   1 DATA       size      0   flags    8
   2 DATA0      size      0   flags    8
   3 SSEG       size      0   flags    8
   4 SSEG1      size    100   flags    8
   5 HOME       size     80   flags    0
   6 CODE       size   2200   flags    0

